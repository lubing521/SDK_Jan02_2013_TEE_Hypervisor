<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>otz_tee_crypto_api.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<!-- end header part -->
<!-- Generated by Doxygen 1.8.2 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_6aeebb853ebd8c514e6186653c592c82.html">otzone</a></li><li class="navelem"><a class="el" href="dir_fb44076c8b62c63869cf8a830933e50d.html">src</a></li><li class="navelem"><a class="el" href="dir_2d945ebfca6299adda500e2943a81344.html">lib</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">otz_tee_crypto_api.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &lt;openssl/md5.h&gt;</code><br/>
<code>#include &lt;openssl/sha.h&gt;</code><br/>
<code>#include &lt;openssl/hmac.h&gt;</code><br/>
<code>#include &lt;openssl/evp.h&gt;</code><br/>
<code>#include &lt;openssl/aes.h&gt;</code><br/>
<code>#include &lt;openssl/modes.h&gt;</code><br/>
<code>#include &lt;modes_lcl.h&gt;</code><br/>
<code>#include &lt;openssl/rsa.h&gt;</code><br/>
<code>#include &lt;openssl/dsa.h&gt;</code><br/>
<code>#include &lt;<a class="el" href="otz__tee__crypto__api_8h_source.html">otz_tee_crypto_api.h</a>&gt;</code><br/>
</div>
<p><a href="otz__tee__crypto__api_8c_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a25a6ed042b2e933aeae3c26727987811"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="otz__tee__crypto__api_8c.html#a25a6ed042b2e933aeae3c26727987811">TEE_Panic</a> (<a class="el" href="otz__tee__api_8h.html#aa1b64b7b46cd8040d03cb32c6504796a">TEE_Result</a> panicCode)</td></tr>
<tr class="separator:a25a6ed042b2e933aeae3c26727987811"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2a10478a299ccc8ca2d3418ed12f9dca"><td class="memItemLeft" align="right" valign="top"><a class="el" href="otz__tee__api_8h.html#a586a43c1886aa09dc9541fb66e6d8d7f">TEEC_Result</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="otz__tee__crypto__api_8c.html#a2a10478a299ccc8ca2d3418ed12f9dca">TEE_AllocateOperation</a> (<a class="el" href="otz__tee__crypto__api_8h.html#a003ccda0ce6a2d7889b2933a201e2bd1">TEE_OperationHandle</a> *operation, <a class="el" href="otz__api_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> algorithm, <a class="el" href="otz__api_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> mode, <a class="el" href="otz__api_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> maxKeySize)</td></tr>
<tr class="separator:a2a10478a299ccc8ca2d3418ed12f9dca"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af5f3a12e4fbaa2ae82d4dadf122ad4cd"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="otz__tee__crypto__api_8c.html#af5f3a12e4fbaa2ae82d4dadf122ad4cd">TEE_FreeOperation</a> (<a class="el" href="otz__tee__crypto__api_8h.html#a003ccda0ce6a2d7889b2933a201e2bd1">TEE_OperationHandle</a> operation)</td></tr>
<tr class="separator:af5f3a12e4fbaa2ae82d4dadf122ad4cd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab0c4a76983dc97122bf9c540458225d0"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="otz__tee__crypto__api_8c.html#ab0c4a76983dc97122bf9c540458225d0">TEE_GetOperationInfo</a> (<a class="el" href="otz__tee__crypto__api_8h.html#a003ccda0ce6a2d7889b2933a201e2bd1">TEE_OperationHandle</a> operation, <a class="el" href="otz__tee__crypto__api_8h.html#a383943b4a1fe4288e8247a834e7faf52">TEE_OperationInfo</a> *operationInfo)</td></tr>
<tr class="separator:ab0c4a76983dc97122bf9c540458225d0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2d36adb59a76af1f73090475e98aa4c9"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="otz__tee__crypto__api_8c.html#a2d36adb59a76af1f73090475e98aa4c9">TEE_ResetOperation</a> (<a class="el" href="otz__tee__crypto__api_8h.html#a003ccda0ce6a2d7889b2933a201e2bd1">TEE_OperationHandle</a> operation)</td></tr>
<tr class="separator:a2d36adb59a76af1f73090475e98aa4c9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6a7ec2dacb75dee7a6610bc9d4483bae"><td class="memItemLeft" align="right" valign="top"><a class="el" href="otz__tee__api_8h.html#a586a43c1886aa09dc9541fb66e6d8d7f">TEEC_Result</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="otz__tee__crypto__api_8c.html#a6a7ec2dacb75dee7a6610bc9d4483bae">TEE_SetOperationKey</a> (<a class="el" href="otz__tee__crypto__api_8h.html#a003ccda0ce6a2d7889b2933a201e2bd1">TEE_OperationHandle</a> operation, <a class="el" href="otz__api_8h.html#a6a2cfeba38a0f61d5937bcc8cf04b9a2">TEE_ObjectHandle</a> *key)</td></tr>
<tr class="separator:a6a7ec2dacb75dee7a6610bc9d4483bae"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aed1be97cdf1711948daa246802d11dec"><td class="memItemLeft" align="right" valign="top"><a class="el" href="otz__tee__api_8h.html#a586a43c1886aa09dc9541fb66e6d8d7f">TEEC_Result</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="otz__tee__crypto__api_8c.html#aed1be97cdf1711948daa246802d11dec">TEE_SetOperationKey2</a> (<a class="el" href="otz__tee__crypto__api_8h.html#a003ccda0ce6a2d7889b2933a201e2bd1">TEE_OperationHandle</a> operation, <a class="el" href="otz__api_8h.html#a6a2cfeba38a0f61d5937bcc8cf04b9a2">TEE_ObjectHandle</a> *key1, <a class="el" href="otz__api_8h.html#a6a2cfeba38a0f61d5937bcc8cf04b9a2">TEE_ObjectHandle</a> *key2)</td></tr>
<tr class="separator:aed1be97cdf1711948daa246802d11dec"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4eca2209820659cc95756fc85e1a4837"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="otz__tee__crypto__api_8c.html#a4eca2209820659cc95756fc85e1a4837">TEE_CopyOperation</a> (<a class="el" href="otz__tee__crypto__api_8h.html#a003ccda0ce6a2d7889b2933a201e2bd1">TEE_OperationHandle</a> dstOperation, <a class="el" href="otz__tee__crypto__api_8h.html#a003ccda0ce6a2d7889b2933a201e2bd1">TEE_OperationHandle</a> srcOperation)</td></tr>
<tr class="separator:a4eca2209820659cc95756fc85e1a4837"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad6b3d0ae75709a3f4de26a7f6a1f9d33"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="otz__tee__crypto__api_8c.html#ad6b3d0ae75709a3f4de26a7f6a1f9d33">TEE_DigestUpdate</a> (<a class="el" href="otz__tee__crypto__api_8h.html#a003ccda0ce6a2d7889b2933a201e2bd1">TEE_OperationHandle</a> operation, void *chunk, <a class="el" href="sw__common__types_8h.html#a7c94ea6f8948649f8d181ae55911eeaf">size_t</a> chunkSize)</td></tr>
<tr class="separator:ad6b3d0ae75709a3f4de26a7f6a1f9d33"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2606085c2cc975381297ca2dd3c2ec16"><td class="memItemLeft" align="right" valign="top"><a class="el" href="otz__tee__api_8h.html#a586a43c1886aa09dc9541fb66e6d8d7f">TEEC_Result</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="otz__tee__crypto__api_8c.html#a2606085c2cc975381297ca2dd3c2ec16">TEE_DigestDoFinal</a> (<a class="el" href="otz__tee__crypto__api_8h.html#a003ccda0ce6a2d7889b2933a201e2bd1">TEE_OperationHandle</a> operation, void *chunk, <a class="el" href="sw__common__types_8h.html#a7c94ea6f8948649f8d181ae55911eeaf">size_t</a> chunkLen, void *hash, <a class="el" href="sw__common__types_8h.html#a7c94ea6f8948649f8d181ae55911eeaf">size_t</a> *hashLen)</td></tr>
<tr class="separator:a2606085c2cc975381297ca2dd3c2ec16"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8dc0c802367d20abadb7ba57b5e19c48"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="otz__tee__crypto__api_8c.html#a8dc0c802367d20abadb7ba57b5e19c48">TEE_CipherInit</a> (<a class="el" href="otz__tee__crypto__api_8h.html#a003ccda0ce6a2d7889b2933a201e2bd1">TEE_OperationHandle</a> operation, void *IV, <a class="el" href="sw__common__types_8h.html#a7c94ea6f8948649f8d181ae55911eeaf">size_t</a> IVLen)</td></tr>
<tr class="separator:a8dc0c802367d20abadb7ba57b5e19c48"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3dc1c2b0b51fbdb77245da5c1c7427bf"><td class="memItemLeft" align="right" valign="top"><a class="el" href="otz__tee__api_8h.html#a586a43c1886aa09dc9541fb66e6d8d7f">TEEC_Result</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="otz__tee__crypto__api_8c.html#a3dc1c2b0b51fbdb77245da5c1c7427bf">TEE_CipherUpdate</a> (<a class="el" href="otz__tee__crypto__api_8h.html#a003ccda0ce6a2d7889b2933a201e2bd1">TEE_OperationHandle</a> operation, void *srcData, <a class="el" href="sw__common__types_8h.html#a7c94ea6f8948649f8d181ae55911eeaf">size_t</a> srcLen, void *destData, <a class="el" href="sw__common__types_8h.html#a7c94ea6f8948649f8d181ae55911eeaf">size_t</a> *destLen)</td></tr>
<tr class="separator:a3dc1c2b0b51fbdb77245da5c1c7427bf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa224e15a3bd16ce2653128814ffe9a8a"><td class="memItemLeft" align="right" valign="top"><a class="el" href="otz__tee__api_8h.html#a586a43c1886aa09dc9541fb66e6d8d7f">TEEC_Result</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="otz__tee__crypto__api_8c.html#aa224e15a3bd16ce2653128814ffe9a8a">TEE_CipherDoFinal</a> (<a class="el" href="otz__tee__crypto__api_8h.html#a003ccda0ce6a2d7889b2933a201e2bd1">TEE_OperationHandle</a> operation, void *srcData, <a class="el" href="sw__common__types_8h.html#a7c94ea6f8948649f8d181ae55911eeaf">size_t</a> srcLen, void *destData, <a class="el" href="sw__common__types_8h.html#a7c94ea6f8948649f8d181ae55911eeaf">size_t</a> *destLen)</td></tr>
<tr class="separator:aa224e15a3bd16ce2653128814ffe9a8a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acb4efa28654d099dd29e3934637d166b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="otz__tee__crypto__api_8c.html#acb4efa28654d099dd29e3934637d166b">TEE_MACInit</a> (<a class="el" href="otz__tee__crypto__api_8h.html#a003ccda0ce6a2d7889b2933a201e2bd1">TEE_OperationHandle</a> operation, void *IV, <a class="el" href="sw__common__types_8h.html#a7c94ea6f8948649f8d181ae55911eeaf">size_t</a> IVLen)</td></tr>
<tr class="separator:acb4efa28654d099dd29e3934637d166b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a28c22840ca8936cb69f8ce5cc7f32c6c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="otz__tee__crypto__api_8c.html#a28c22840ca8936cb69f8ce5cc7f32c6c">TEE_MACUpdate</a> (<a class="el" href="otz__tee__crypto__api_8h.html#a003ccda0ce6a2d7889b2933a201e2bd1">TEE_OperationHandle</a> operation, void *chunk, <a class="el" href="sw__common__types_8h.html#a7c94ea6f8948649f8d181ae55911eeaf">size_t</a> chunkSize)</td></tr>
<tr class="separator:a28c22840ca8936cb69f8ce5cc7f32c6c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3b92d51c8e81018ea174ed15cc15de71"><td class="memItemLeft" align="right" valign="top"><a class="el" href="otz__tee__api_8h.html#a586a43c1886aa09dc9541fb66e6d8d7f">TEEC_Result</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="otz__tee__crypto__api_8c.html#a3b92d51c8e81018ea174ed15cc15de71">TEE_MACComputeFinal</a> (<a class="el" href="otz__tee__crypto__api_8h.html#a003ccda0ce6a2d7889b2933a201e2bd1">TEE_OperationHandle</a> operation, void *message, <a class="el" href="sw__common__types_8h.html#a7c94ea6f8948649f8d181ae55911eeaf">size_t</a> messageLen, void *mac, <a class="el" href="sw__common__types_8h.html#a7c94ea6f8948649f8d181ae55911eeaf">size_t</a> *macLen)</td></tr>
<tr class="separator:a3b92d51c8e81018ea174ed15cc15de71"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2f2ee76ede085e7b603ae552400de6d6"><td class="memItemLeft" align="right" valign="top"><a class="el" href="otz__tee__api_8h.html#a586a43c1886aa09dc9541fb66e6d8d7f">TEEC_Result</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="otz__tee__crypto__api_8c.html#a2f2ee76ede085e7b603ae552400de6d6">TEE_MACCompareFinal</a> (<a class="el" href="otz__tee__crypto__api_8h.html#a003ccda0ce6a2d7889b2933a201e2bd1">TEE_OperationHandle</a> operation, void *message, <a class="el" href="sw__common__types_8h.html#a7c94ea6f8948649f8d181ae55911eeaf">size_t</a> messageLen, void *mac, <a class="el" href="sw__common__types_8h.html#a7c94ea6f8948649f8d181ae55911eeaf">size_t</a> *macLen)</td></tr>
<tr class="separator:a2f2ee76ede085e7b603ae552400de6d6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6dc129bae831bd2ac6dd67d6499437a6"><td class="memItemLeft" align="right" valign="top"><a class="el" href="otz__tee__api_8h.html#a586a43c1886aa09dc9541fb66e6d8d7f">TEEC_Result</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="otz__tee__crypto__api_8c.html#a6dc129bae831bd2ac6dd67d6499437a6">TEE_AEInit</a> (<a class="el" href="otz__tee__crypto__api_8h.html#a003ccda0ce6a2d7889b2933a201e2bd1">TEE_OperationHandle</a> operation, void *nonce, <a class="el" href="sw__common__types_8h.html#a7c94ea6f8948649f8d181ae55911eeaf">size_t</a> nonceLen, <a class="el" href="otz__api_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> tagLen, <a class="el" href="otz__api_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> AADLen, <a class="el" href="otz__api_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> payloadLen)</td></tr>
<tr class="separator:a6dc129bae831bd2ac6dd67d6499437a6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a85a4aafb003fc72cebac46f530423fa9"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="otz__tee__crypto__api_8c.html#a85a4aafb003fc72cebac46f530423fa9">TEE_AEUpdateAAD</a> (<a class="el" href="otz__tee__crypto__api_8h.html#a003ccda0ce6a2d7889b2933a201e2bd1">TEE_OperationHandle</a> operation, void *AADdata, <a class="el" href="sw__common__types_8h.html#a7c94ea6f8948649f8d181ae55911eeaf">size_t</a> AADdataLen)</td></tr>
<tr class="separator:a85a4aafb003fc72cebac46f530423fa9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1020acbb2529c8fbb62b9263fb9acaea"><td class="memItemLeft" align="right" valign="top"><a class="el" href="otz__tee__api_8h.html#a586a43c1886aa09dc9541fb66e6d8d7f">TEEC_Result</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="otz__tee__crypto__api_8c.html#a1020acbb2529c8fbb62b9263fb9acaea">TEE_AEUpdate</a> (<a class="el" href="otz__tee__crypto__api_8h.html#a003ccda0ce6a2d7889b2933a201e2bd1">TEE_OperationHandle</a> operation, void *srcData, <a class="el" href="sw__common__types_8h.html#a7c94ea6f8948649f8d181ae55911eeaf">size_t</a> srcLen, void *destData, <a class="el" href="sw__common__types_8h.html#a7c94ea6f8948649f8d181ae55911eeaf">size_t</a> *destLen)</td></tr>
<tr class="separator:a1020acbb2529c8fbb62b9263fb9acaea"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acca2fa3e75782e62896e34343566dbe7"><td class="memItemLeft" align="right" valign="top"><a class="el" href="otz__tee__api_8h.html#a586a43c1886aa09dc9541fb66e6d8d7f">TEEC_Result</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="otz__tee__crypto__api_8c.html#acca2fa3e75782e62896e34343566dbe7">TEE_AEEncryptFinal</a> (<a class="el" href="otz__tee__crypto__api_8h.html#a003ccda0ce6a2d7889b2933a201e2bd1">TEE_OperationHandle</a> operation, void *srcData, <a class="el" href="sw__common__types_8h.html#a7c94ea6f8948649f8d181ae55911eeaf">size_t</a> srcLen, void *destData, <a class="el" href="sw__common__types_8h.html#a7c94ea6f8948649f8d181ae55911eeaf">size_t</a> *destLen, void *<a class="el" href="structtag.html">tag</a>, <a class="el" href="sw__common__types_8h.html#a7c94ea6f8948649f8d181ae55911eeaf">size_t</a> *tagLen)</td></tr>
<tr class="separator:acca2fa3e75782e62896e34343566dbe7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af84eb81a444966bd10f0833ad910bcec"><td class="memItemLeft" align="right" valign="top"><a class="el" href="otz__tee__api_8h.html#a586a43c1886aa09dc9541fb66e6d8d7f">TEEC_Result</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="otz__tee__crypto__api_8c.html#af84eb81a444966bd10f0833ad910bcec">TEE_AEDecryptFinal</a> (<a class="el" href="otz__tee__crypto__api_8h.html#a003ccda0ce6a2d7889b2933a201e2bd1">TEE_OperationHandle</a> operation, void *srcData, <a class="el" href="sw__common__types_8h.html#a7c94ea6f8948649f8d181ae55911eeaf">size_t</a> srcLen, void *destData, <a class="el" href="sw__common__types_8h.html#a7c94ea6f8948649f8d181ae55911eeaf">size_t</a> *destLen, void *<a class="el" href="structtag.html">tag</a>, <a class="el" href="sw__common__types_8h.html#a7c94ea6f8948649f8d181ae55911eeaf">size_t</a> tagLen)</td></tr>
<tr class="separator:af84eb81a444966bd10f0833ad910bcec"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a583d9d6c3f2294d4053cc5e1fca91c6e"><td class="memItemLeft" align="right" valign="top"><a class="el" href="otz__tee__api_8h.html#a586a43c1886aa09dc9541fb66e6d8d7f">TEEC_Result</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="otz__tee__crypto__api_8c.html#a583d9d6c3f2294d4053cc5e1fca91c6e">TEE_AsymmetricEncrypt</a> (<a class="el" href="otz__tee__crypto__api_8h.html#a003ccda0ce6a2d7889b2933a201e2bd1">TEE_OperationHandle</a> operation, <a class="el" href="structTEE__Attribute.html">TEE_Attribute</a> *params, <a class="el" href="otz__api_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> paramCount, void *srcData, <a class="el" href="sw__common__types_8h.html#a7c94ea6f8948649f8d181ae55911eeaf">size_t</a> srcLen, void *destData, <a class="el" href="sw__common__types_8h.html#a7c94ea6f8948649f8d181ae55911eeaf">size_t</a> *destLen)</td></tr>
<tr class="separator:a583d9d6c3f2294d4053cc5e1fca91c6e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af3bd04b33488877d133a354f23250680"><td class="memItemLeft" align="right" valign="top"><a class="el" href="otz__tee__api_8h.html#a586a43c1886aa09dc9541fb66e6d8d7f">TEEC_Result</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="otz__tee__crypto__api_8c.html#af3bd04b33488877d133a354f23250680">TEE_AsymmetricDecrypt</a> (<a class="el" href="otz__tee__crypto__api_8h.html#a003ccda0ce6a2d7889b2933a201e2bd1">TEE_OperationHandle</a> operation, <a class="el" href="structTEE__Attribute.html">TEE_Attribute</a> *params, <a class="el" href="otz__api_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> paramCount, void *srcData, <a class="el" href="sw__common__types_8h.html#a7c94ea6f8948649f8d181ae55911eeaf">size_t</a> srcLen, void *destData, <a class="el" href="sw__common__types_8h.html#a7c94ea6f8948649f8d181ae55911eeaf">size_t</a> *destLen)</td></tr>
<tr class="separator:af3bd04b33488877d133a354f23250680"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4a7987af6dd94294fc6791240d10f4e3"><td class="memItemLeft" align="right" valign="top"><a class="el" href="otz__tee__api_8h.html#a586a43c1886aa09dc9541fb66e6d8d7f">TEEC_Result</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="otz__tee__crypto__api_8c.html#a4a7987af6dd94294fc6791240d10f4e3">TEE_AsymmetricSignDigest</a> (<a class="el" href="otz__tee__crypto__api_8h.html#a003ccda0ce6a2d7889b2933a201e2bd1">TEE_OperationHandle</a> operation, <a class="el" href="structTEE__Attribute.html">TEE_Attribute</a> *params, <a class="el" href="otz__api_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> paramCount, void *digest, <a class="el" href="sw__common__types_8h.html#a7c94ea6f8948649f8d181ae55911eeaf">size_t</a> digestLen, void *signature, <a class="el" href="sw__common__types_8h.html#a7c94ea6f8948649f8d181ae55911eeaf">size_t</a> *signatureLen)</td></tr>
<tr class="separator:a4a7987af6dd94294fc6791240d10f4e3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a09743a6c13479d2ada860fd35027e7c2"><td class="memItemLeft" align="right" valign="top"><a class="el" href="otz__tee__api_8h.html#a586a43c1886aa09dc9541fb66e6d8d7f">TEEC_Result</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="otz__tee__crypto__api_8c.html#a09743a6c13479d2ada860fd35027e7c2">TEE_AsymmetricVerifyDigest</a> (<a class="el" href="otz__tee__crypto__api_8h.html#a003ccda0ce6a2d7889b2933a201e2bd1">TEE_OperationHandle</a> operation, <a class="el" href="structTEE__Attribute.html">TEE_Attribute</a> *params, <a class="el" href="otz__api_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> paramCount, void *digest, <a class="el" href="sw__common__types_8h.html#a7c94ea6f8948649f8d181ae55911eeaf">size_t</a> digestLen, void *signature, <a class="el" href="sw__common__types_8h.html#a7c94ea6f8948649f8d181ae55911eeaf">size_t</a> signatureLen)</td></tr>
<tr class="separator:a09743a6c13479d2ada860fd35027e7c2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ace442eb7a1bc39ea5ae191ee64277e7a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="otz__tee__crypto__api_8c.html#ace442eb7a1bc39ea5ae191ee64277e7a">TEE_DeriveKey</a> (<a class="el" href="otz__tee__crypto__api_8h.html#a003ccda0ce6a2d7889b2933a201e2bd1">TEE_OperationHandle</a> operation, <a class="el" href="structTEE__Attribute.html">TEE_Attribute</a> *params, <a class="el" href="otz__api_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> paramCount, <a class="el" href="otz__api_8h.html#a6a2cfeba38a0f61d5937bcc8cf04b9a2">TEE_ObjectHandle</a> *derivedKey)</td></tr>
<tr class="separator:ace442eb7a1bc39ea5ae191ee64277e7a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3c5a8cb6c0a8d91e1bcbec91abffffa5"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="otz__tee__crypto__api_8c.html#a3c5a8cb6c0a8d91e1bcbec91abffffa5">TEE_GenerateRandom</a> (void *randomBuffer, <a class="el" href="sw__common__types_8h.html#a7c94ea6f8948649f8d181ae55911eeaf">size_t</a> randomBufferLen)</td></tr>
<tr class="separator:a3c5a8cb6c0a8d91e1bcbec91abffffa5"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="af84eb81a444966bd10f0833ad910bcec"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="otz__tee__api_8h.html#a586a43c1886aa09dc9541fb66e6d8d7f">TEEC_Result</a> TEE_AEDecryptFinal </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="otz__tee__crypto__api_8h.html#a003ccda0ce6a2d7889b2933a201e2bd1">TEE_OperationHandle</a>&#160;</td>
          <td class="paramname"><em>operation</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>srcData</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="sw__common__types_8h.html#a7c94ea6f8948649f8d181ae55911eeaf">size_t</a>&#160;</td>
          <td class="paramname"><em>srcLen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>destData</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="sw__common__types_8h.html#a7c94ea6f8948649f8d181ae55911eeaf">size_t</a> *&#160;</td>
          <td class="paramname"><em>destLen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>tag</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="sw__common__types_8h.html#a7c94ea6f8948649f8d181ae55911eeaf">size_t</a>&#160;</td>
          <td class="paramname"><em>tagLen</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">operation</td><td></td></tr>
    <tr><td class="paramname">srcData</td><td></td></tr>
    <tr><td class="paramname">srcLen</td><td></td></tr>
    <tr><td class="paramname">destData</td><td></td></tr>
    <tr><td class="paramname">destLen</td><td></td></tr>
    <tr><td class="paramname">tag</td><td></td></tr>
    <tr><td class="paramname">tagLen</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd></dd></dl>

<p>Definition at line <a class="el" href="otz__tee__crypto__api_8c_source.html#l01646">1646</a> of file <a class="el" href="otz__tee__crypto__api_8c_source.html">otz_tee_crypto_api.c</a>.</p>
<div class="fragment"><div class="line">{</div>
<div class="line">        <span class="keywordflow">if</span>(operation == <a class="code" href="sw__types_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) {</div>
<div class="line">                <span class="keywordflow">return</span>(<a class="code" href="otz__tee__api_8h.html#a586a43c1886aa09dc9541fb66e6d8d7fa4b7583ef234ccb0ef6f7492ee6e8200d">TEEC_ERROR_BAD_PARAMETERS</a>);</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">if</span>(operation-&gt;<a class="code" href="struct____TEE__OperationHandle.html#aabd85e41a59abec4e8ba16147636a982">operationClass</a> != <a class="code" href="otz__tee__crypto__api_8h.html#ad0c73c650876132dcd7cc6309bf8c2b9a37f7b80ca7f4cc2e049fb205bf46a950">TEE_OPERATION_AE</a>) {</div>
<div class="line">                <a class="code" href="otz__tee__crypto__api_8h.html#a25a6ed042b2e933aeae3c26727987811">TEE_Panic</a>(<a class="code" href="otz__tee__api_8h.html#a586a43c1886aa09dc9541fb66e6d8d7fa4b7583ef234ccb0ef6f7492ee6e8200d">TEEC_ERROR_BAD_PARAMETERS</a>);</div>
<div class="line">                <span class="keywordflow">return</span>(<a class="code" href="otz__tee__api_8h.html#a586a43c1886aa09dc9541fb66e6d8d7fa4b7583ef234ccb0ef6f7492ee6e8200d">TEEC_ERROR_BAD_PARAMETERS</a>);</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">if</span>((srcLen &gt; 0) &amp;&amp; (*destLen &lt; srcLen)) {</div>
<div class="line">                <span class="keywordflow">return</span>(<a class="code" href="otz__tee__api_8h.html#a586a43c1886aa09dc9541fb66e6d8d7fac72ab519c77b51a03a6ceb17d656fcc1">TEEC_ERROR_SHORT_BUFFER</a>);</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">if</span>((operation-&gt;<a class="code" href="struct____TEE__OperationHandle.html#a4750f19edd1529680f9899db1da0f445">algorithm</a> == <a class="code" href="otz__tee__crypto__api_8h.html#a3fb37fc937a1cbad38ddb0279a4cca2da75c0ba38a15b359decf7c15a22fe740d">TEE_ALG_AES_CCM</a>) &amp;&amp; (srcLen != 0)) {</div>
<div class="line">                CRYPTO_ccm128_decrypt(operation-&gt;<a class="code" href="struct____TEE__OperationHandle.html#a49c6130723c77a4571daa08289f220e1">crypto_ctxt</a>,srcData,destData,*destLen);</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">if</span>(operation-&gt;<a class="code" href="struct____TEE__OperationHandle.html#a4750f19edd1529680f9899db1da0f445">algorithm</a> == <a class="code" href="otz__tee__crypto__api_8h.html#a3fb37fc937a1cbad38ddb0279a4cca2dae4b59bc36e09e4908f66be510aec851f">TEE_ALG_AES_GCM</a>) {</div>
<div class="line">                <span class="keywordflow">if</span>(srcLen != 0) {</div>
<div class="line">                        CRYPTO_gcm128_decrypt(operation-&gt;<a class="code" href="struct____TEE__OperationHandle.html#a49c6130723c77a4571daa08289f220e1">crypto_ctxt</a>,srcData,destData,*destLen);</div>
<div class="line">                }</div>
<div class="line">                CRYPTO_gcm128_finish((GCM128_CONTEXT*)operation-&gt;<a class="code" href="struct____TEE__OperationHandle.html#a49c6130723c77a4571daa08289f220e1">crypto_ctxt</a>,<a class="code" href="structtag.html">tag</a>,tagLen);</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">return</span>(<a class="code" href="otz__tee__api_8h.html#a586a43c1886aa09dc9541fb66e6d8d7fa4d19c2c024e37edc5f04892bb6739dbe">TEEC_SUCCESS</a>);</div>
<div class="line">}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="acca2fa3e75782e62896e34343566dbe7"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="otz__tee__api_8h.html#a586a43c1886aa09dc9541fb66e6d8d7f">TEEC_Result</a> TEE_AEEncryptFinal </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="otz__tee__crypto__api_8h.html#a003ccda0ce6a2d7889b2933a201e2bd1">TEE_OperationHandle</a>&#160;</td>
          <td class="paramname"><em>operation</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>srcData</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="sw__common__types_8h.html#a7c94ea6f8948649f8d181ae55911eeaf">size_t</a>&#160;</td>
          <td class="paramname"><em>srcLen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>destData</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="sw__common__types_8h.html#a7c94ea6f8948649f8d181ae55911eeaf">size_t</a> *&#160;</td>
          <td class="paramname"><em>destLen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>tag</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="sw__common__types_8h.html#a7c94ea6f8948649f8d181ae55911eeaf">size_t</a> *&#160;</td>
          <td class="paramname"><em>tagLen</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">operation</td><td></td></tr>
    <tr><td class="paramname">srcData</td><td></td></tr>
    <tr><td class="paramname">srcLen</td><td></td></tr>
    <tr><td class="paramname">destData</td><td></td></tr>
    <tr><td class="paramname">destLen</td><td></td></tr>
    <tr><td class="paramname">tag</td><td></td></tr>
    <tr><td class="paramname">tagLen</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd></dd></dl>

<p>Definition at line <a class="el" href="otz__tee__crypto__api_8c_source.html#l01606">1606</a> of file <a class="el" href="otz__tee__crypto__api_8c_source.html">otz_tee_crypto_api.c</a>.</p>
<div class="fragment"><div class="line">{</div>
<div class="line">        <span class="keywordflow">if</span>(operation == <a class="code" href="sw__types_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) {</div>
<div class="line">                <span class="keywordflow">return</span>(<a class="code" href="otz__tee__api_8h.html#a586a43c1886aa09dc9541fb66e6d8d7fa4b7583ef234ccb0ef6f7492ee6e8200d">TEEC_ERROR_BAD_PARAMETERS</a>);</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">if</span>(operation-&gt;<a class="code" href="struct____TEE__OperationHandle.html#aabd85e41a59abec4e8ba16147636a982">operationClass</a> != <a class="code" href="otz__tee__crypto__api_8h.html#ad0c73c650876132dcd7cc6309bf8c2b9a37f7b80ca7f4cc2e049fb205bf46a950">TEE_OPERATION_AE</a>) {</div>
<div class="line">                <a class="code" href="otz__tee__crypto__api_8h.html#a25a6ed042b2e933aeae3c26727987811">TEE_Panic</a>(<a class="code" href="otz__tee__api_8h.html#a586a43c1886aa09dc9541fb66e6d8d7fa4b7583ef234ccb0ef6f7492ee6e8200d">TEEC_ERROR_BAD_PARAMETERS</a>);</div>
<div class="line">                <span class="keywordflow">return</span>(<a class="code" href="otz__tee__api_8h.html#a586a43c1886aa09dc9541fb66e6d8d7fa4b7583ef234ccb0ef6f7492ee6e8200d">TEEC_ERROR_BAD_PARAMETERS</a>);</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">if</span>((srcLen &gt; 0) &amp;&amp; (*destLen &lt; srcLen)) {</div>
<div class="line">                <span class="keywordflow">return</span>(<a class="code" href="otz__tee__api_8h.html#a586a43c1886aa09dc9541fb66e6d8d7fac72ab519c77b51a03a6ceb17d656fcc1">TEEC_ERROR_SHORT_BUFFER</a>);</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">if</span>((operation-&gt;<a class="code" href="struct____TEE__OperationHandle.html#a4750f19edd1529680f9899db1da0f445">algorithm</a> == <a class="code" href="otz__tee__crypto__api_8h.html#a3fb37fc937a1cbad38ddb0279a4cca2da75c0ba38a15b359decf7c15a22fe740d">TEE_ALG_AES_CCM</a>) &amp;&amp; (srcLen != 0)) {</div>
<div class="line">                CRYPTO_ccm128_encrypt(operation-&gt;<a class="code" href="struct____TEE__OperationHandle.html#a49c6130723c77a4571daa08289f220e1">crypto_ctxt</a>,srcData,destData,*destLen);</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">if</span>(operation-&gt;<a class="code" href="struct____TEE__OperationHandle.html#a4750f19edd1529680f9899db1da0f445">algorithm</a> == <a class="code" href="otz__tee__crypto__api_8h.html#a3fb37fc937a1cbad38ddb0279a4cca2dae4b59bc36e09e4908f66be510aec851f">TEE_ALG_AES_GCM</a>) {</div>
<div class="line">                <span class="keywordflow">if</span>(srcLen != 0) {</div>
<div class="line">                        CRYPTO_gcm128_encrypt(operation-&gt;<a class="code" href="struct____TEE__OperationHandle.html#a49c6130723c77a4571daa08289f220e1">crypto_ctxt</a>,srcData,destData,*destLen);</div>
<div class="line">                }</div>
<div class="line">                CRYPTO_gcm128_finish(operation-&gt;<a class="code" href="struct____TEE__OperationHandle.html#a49c6130723c77a4571daa08289f220e1">crypto_ctxt</a>,<a class="code" href="structtag.html">tag</a>,*tagLen);</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">return</span>(<a class="code" href="otz__tee__api_8h.html#a586a43c1886aa09dc9541fb66e6d8d7fa4d19c2c024e37edc5f04892bb6739dbe">TEEC_SUCCESS</a>);</div>
<div class="line">}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a6dc129bae831bd2ac6dd67d6499437a6"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="otz__tee__api_8h.html#a586a43c1886aa09dc9541fb66e6d8d7f">TEEC_Result</a> TEE_AEInit </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="otz__tee__crypto__api_8h.html#a003ccda0ce6a2d7889b2933a201e2bd1">TEE_OperationHandle</a>&#160;</td>
          <td class="paramname"><em>operation</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>nonce</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="sw__common__types_8h.html#a7c94ea6f8948649f8d181ae55911eeaf">size_t</a>&#160;</td>
          <td class="paramname"><em>nonceLen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="otz__api_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a>&#160;</td>
          <td class="paramname"><em>tagLen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="otz__api_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a>&#160;</td>
          <td class="paramname"><em>AADLen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="otz__api_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a>&#160;</td>
          <td class="paramname"><em>payloadLen</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">operation</td><td></td></tr>
    <tr><td class="paramname">nonce</td><td></td></tr>
    <tr><td class="paramname">nonceLen</td><td></td></tr>
    <tr><td class="paramname">tagLen</td><td></td></tr>
    <tr><td class="paramname">AADLen</td><td></td></tr>
    <tr><td class="paramname">payloadLen</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd></dd></dl>

<p>Definition at line <a class="el" href="otz__tee__crypto__api_8c_source.html#l01469">1469</a> of file <a class="el" href="otz__tee__crypto__api_8c_source.html">otz_tee_crypto_api.c</a>.</p>
<div class="fragment"><div class="line">{</div>
<div class="line">        <span class="keywordflow">if</span>(operation == <a class="code" href="sw__types_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) {</div>
<div class="line">                <span class="keywordflow">return</span>(<a class="code" href="otz__tee__api_8h.html#a586a43c1886aa09dc9541fb66e6d8d7fa4b7583ef234ccb0ef6f7492ee6e8200d">TEEC_ERROR_BAD_PARAMETERS</a>);</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">if</span>(operation-&gt;<a class="code" href="struct____TEE__OperationHandle.html#aabd85e41a59abec4e8ba16147636a982">operationClass</a> != <a class="code" href="otz__tee__crypto__api_8h.html#ad0c73c650876132dcd7cc6309bf8c2b9a37f7b80ca7f4cc2e049fb205bf46a950">TEE_OPERATION_AE</a>) {</div>
<div class="line">                <a class="code" href="otz__tee__crypto__api_8h.html#a25a6ed042b2e933aeae3c26727987811">TEE_Panic</a>(<a class="code" href="otz__tee__api_8h.html#a586a43c1886aa09dc9541fb66e6d8d7fa4b7583ef234ccb0ef6f7492ee6e8200d">TEEC_ERROR_BAD_PARAMETERS</a>);</div>
<div class="line">                <span class="keywordflow">return</span>(<a class="code" href="otz__tee__api_8h.html#a586a43c1886aa09dc9541fb66e6d8d7fa4b7583ef234ccb0ef6f7492ee6e8200d">TEEC_ERROR_BAD_PARAMETERS</a>);</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">if</span>(operation-&gt;<a class="code" href="struct____TEE__OperationHandle.html#a1143afc5ba92c02e9e3ee751c585cace">keyValue</a> == <a class="code" href="sw__types_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) {</div>
<div class="line">                <a class="code" href="otz__tee__crypto__api_8h.html#a25a6ed042b2e933aeae3c26727987811">TEE_Panic</a>(<a class="code" href="otz__tee__api_8h.html#a586a43c1886aa09dc9541fb66e6d8d7fa4b7583ef234ccb0ef6f7492ee6e8200d">TEEC_ERROR_BAD_PARAMETERS</a>);</div>
<div class="line">                <span class="keywordflow">return</span>(<a class="code" href="otz__tee__api_8h.html#a586a43c1886aa09dc9541fb66e6d8d7fa4b7583ef234ccb0ef6f7492ee6e8200d">TEEC_ERROR_BAD_PARAMETERS</a>);</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">if</span>(operation-&gt;<a class="code" href="struct____TEE__OperationHandle.html#a4750f19edd1529680f9899db1da0f445">algorithm</a> == <a class="code" href="otz__tee__crypto__api_8h.html#a3fb37fc937a1cbad38ddb0279a4cca2dae4b59bc36e09e4908f66be510aec851f">TEE_ALG_AES_GCM</a>) {</div>
<div class="line">                <span class="keywordflow">switch</span>(tagLen) {</div>
<div class="line">                        <span class="keywordflow">case</span> <a class="code" href="otz__tee__crypto__api_8h.html#a3ed56e4c5806e2dd4606ef93eafcfe62a234c823bf61745336c54b65a6cd3208e">TEE_TAG_LEN_96</a>:</div>
<div class="line">                        <span class="keywordflow">case</span> <a class="code" href="otz__tee__crypto__api_8h.html#a3ed56e4c5806e2dd4606ef93eafcfe62a2ce54dad43a1a67e6977f13414f9ad9b">TEE_TAG_LEN_104</a>:</div>
<div class="line">                        <span class="keywordflow">case</span> <a class="code" href="otz__tee__crypto__api_8h.html#a3ed56e4c5806e2dd4606ef93eafcfe62af67bce6334822428e26b714668e9554b">TEE_TAG_LEN_112</a>:</div>
<div class="line">                        <span class="keywordflow">case</span> <a class="code" href="otz__tee__crypto__api_8h.html#a3ed56e4c5806e2dd4606ef93eafcfe62ad5a90cdede09464283a3b73f00ee461f">TEE_TAG_LEN_120</a>:</div>
<div class="line">                        <span class="keywordflow">case</span> <a class="code" href="otz__tee__crypto__api_8h.html#a3ed56e4c5806e2dd4606ef93eafcfe62a3822643251553314a2555cfdd205b26f">TEE_TAG_LEN_128</a>:</div>
<div class="line">                                <span class="keywordflow">break</span>;</div>
<div class="line">                        <span class="keywordflow">default</span>:</div>
<div class="line">                                <span class="keywordflow">return</span>(<a class="code" href="otz__tee__api_8h.html#a586a43c1886aa09dc9541fb66e6d8d7fa6aa19b235cb7a7db1456079bdc05d5c9">TEEC_ERROR_NOT_SUPPORTED</a>);</div>
<div class="line">                }</div>
<div class="line">                CRYPTO_gcm128_init(operation-&gt;<a class="code" href="struct____TEE__OperationHandle.html#a49c6130723c77a4571daa08289f220e1">crypto_ctxt</a>,operation-&gt;<a class="code" href="struct____TEE__OperationHandle.html#a1143afc5ba92c02e9e3ee751c585cace">keyValue</a>,</div>
<div class="line">                                (block128_f)AES_encrypt);</div>
<div class="line">                CRYPTO_gcm128_setiv(operation-&gt;<a class="code" href="struct____TEE__OperationHandle.html#a49c6130723c77a4571daa08289f220e1">crypto_ctxt</a>,nonce,nonceLen);</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">if</span>(operation-&gt;<a class="code" href="struct____TEE__OperationHandle.html#a4750f19edd1529680f9899db1da0f445">algorithm</a> == <a class="code" href="otz__tee__crypto__api_8h.html#a3fb37fc937a1cbad38ddb0279a4cca2da75c0ba38a15b359decf7c15a22fe740d">TEE_ALG_AES_CCM</a>) {</div>
<div class="line">                <span class="keywordflow">switch</span>(tagLen) {</div>
<div class="line">                        <span class="keywordflow">case</span> <a class="code" href="otz__tee__crypto__api_8h.html#a3ed56e4c5806e2dd4606ef93eafcfe62ae5e103490a248c0ee706157503801e07">TEE_TAG_LEN_32</a>:</div>
<div class="line">                        <span class="keywordflow">case</span> <a class="code" href="otz__tee__crypto__api_8h.html#a3ed56e4c5806e2dd4606ef93eafcfe62a82fd567f69f9e3ca918c3804afec8a0e">TEE_TAG_LEN_48</a>:</div>
<div class="line">                        <span class="keywordflow">case</span> <a class="code" href="otz__tee__crypto__api_8h.html#a3ed56e4c5806e2dd4606ef93eafcfe62a9e786fcb3a6df133173c9bbc9e81c330">TEE_TAG_LEN_64</a>:</div>
<div class="line">                        <span class="keywordflow">case</span> <a class="code" href="otz__tee__crypto__api_8h.html#a3ed56e4c5806e2dd4606ef93eafcfe62a234c823bf61745336c54b65a6cd3208e">TEE_TAG_LEN_96</a>:</div>
<div class="line">                        <span class="keywordflow">case</span> <a class="code" href="otz__tee__crypto__api_8h.html#a3ed56e4c5806e2dd4606ef93eafcfe62af67bce6334822428e26b714668e9554b">TEE_TAG_LEN_112</a>:</div>
<div class="line">                        <span class="keywordflow">case</span> <a class="code" href="otz__tee__crypto__api_8h.html#a3ed56e4c5806e2dd4606ef93eafcfe62a3822643251553314a2555cfdd205b26f">TEE_TAG_LEN_128</a>:</div>
<div class="line">                                <span class="keywordflow">break</span>;</div>
<div class="line">                        <span class="keywordflow">default</span>:</div>
<div class="line">                                <span class="keywordflow">return</span>(<a class="code" href="otz__tee__api_8h.html#a586a43c1886aa09dc9541fb66e6d8d7fa6aa19b235cb7a7db1456079bdc05d5c9">TEEC_ERROR_NOT_SUPPORTED</a>);</div>
<div class="line">                }</div>
<div class="line">                CRYPTO_ccm128_init(operation-&gt;<a class="code" href="struct____TEE__OperationHandle.html#a49c6130723c77a4571daa08289f220e1">crypto_ctxt</a>,nonceLen,</div>
<div class="line">                                        payloadLen,operation-&gt;<a class="code" href="struct____TEE__OperationHandle.html#a1143afc5ba92c02e9e3ee751c585cace">keyValue</a>,</div>
<div class="line">                                        (block128_f)AES_encrypt);</div>
<div class="line">                CRYPTO_ccm128_setiv(operation-&gt;<a class="code" href="struct____TEE__OperationHandle.html#a49c6130723c77a4571daa08289f220e1">crypto_ctxt</a>,nonce,nonceLen,payloadLen);</div>
<div class="line">        }</div>
<div class="line">        operation-&gt;<a class="code" href="struct____TEE__OperationHandle.html#abebcbaf39795d039ed2361f23382ade8">aadLen</a> = AADLen;</div>
<div class="line">        <span class="keywordflow">return</span>(<a class="code" href="otz__tee__api_8h.html#a586a43c1886aa09dc9541fb66e6d8d7fa4d19c2c024e37edc5f04892bb6739dbe">TEEC_SUCCESS</a>);</div>
<div class="line">}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a1020acbb2529c8fbb62b9263fb9acaea"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="otz__tee__api_8h.html#a586a43c1886aa09dc9541fb66e6d8d7f">TEEC_Result</a> TEE_AEUpdate </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="otz__tee__crypto__api_8h.html#a003ccda0ce6a2d7889b2933a201e2bd1">TEE_OperationHandle</a>&#160;</td>
          <td class="paramname"><em>operation</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>srcData</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="sw__common__types_8h.html#a7c94ea6f8948649f8d181ae55911eeaf">size_t</a>&#160;</td>
          <td class="paramname"><em>srcLen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>destData</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="sw__common__types_8h.html#a7c94ea6f8948649f8d181ae55911eeaf">size_t</a> *&#160;</td>
          <td class="paramname"><em>destLen</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">operation</td><td></td></tr>
    <tr><td class="paramname">srcData</td><td></td></tr>
    <tr><td class="paramname">srcLen</td><td></td></tr>
    <tr><td class="paramname">destData</td><td></td></tr>
    <tr><td class="paramname">destLen</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd></dd></dl>

<p>Definition at line <a class="el" href="otz__tee__crypto__api_8c_source.html#l01561">1561</a> of file <a class="el" href="otz__tee__crypto__api_8c_source.html">otz_tee_crypto_api.c</a>.</p>
<div class="fragment"><div class="line">{</div>
<div class="line">        <span class="keywordflow">if</span>(operation == <a class="code" href="sw__types_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) {</div>
<div class="line">                <span class="keywordflow">return</span>(<a class="code" href="otz__tee__api_8h.html#a586a43c1886aa09dc9541fb66e6d8d7fa4b7583ef234ccb0ef6f7492ee6e8200d">TEEC_ERROR_BAD_PARAMETERS</a>);</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">if</span>(operation-&gt;<a class="code" href="struct____TEE__OperationHandle.html#aabd85e41a59abec4e8ba16147636a982">operationClass</a> != <a class="code" href="otz__tee__crypto__api_8h.html#ad0c73c650876132dcd7cc6309bf8c2b9a37f7b80ca7f4cc2e049fb205bf46a950">TEE_OPERATION_AE</a>) {</div>
<div class="line">                <a class="code" href="otz__tee__crypto__api_8h.html#a25a6ed042b2e933aeae3c26727987811">TEE_Panic</a>(<a class="code" href="otz__tee__api_8h.html#a586a43c1886aa09dc9541fb66e6d8d7fa4b7583ef234ccb0ef6f7492ee6e8200d">TEEC_ERROR_BAD_PARAMETERS</a>);</div>
<div class="line">                <span class="keywordflow">return</span>(<a class="code" href="otz__tee__api_8h.html#a586a43c1886aa09dc9541fb66e6d8d7fa4b7583ef234ccb0ef6f7492ee6e8200d">TEEC_ERROR_BAD_PARAMETERS</a>);</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">if</span>(*destLen &lt; srcLen) {</div>
<div class="line">                <span class="keywordflow">return</span>(<a class="code" href="otz__tee__api_8h.html#a586a43c1886aa09dc9541fb66e6d8d7fac72ab519c77b51a03a6ceb17d656fcc1">TEEC_ERROR_SHORT_BUFFER</a>);</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">if</span>(operation-&gt;<a class="code" href="struct____TEE__OperationHandle.html#a4750f19edd1529680f9899db1da0f445">algorithm</a> == <a class="code" href="otz__tee__crypto__api_8h.html#a3fb37fc937a1cbad38ddb0279a4cca2da75c0ba38a15b359decf7c15a22fe740d">TEE_ALG_AES_CCM</a>) {</div>
<div class="line">                <span class="keywordflow">if</span>(operation-&gt;<a class="code" href="struct____TEE__OperationHandle.html#ad399557c4571d3b2e41d81632803ed70">mode</a> == <a class="code" href="otz__tee__crypto__api_8h.html#a883ffc5fb861ac33d91c7a8058d59744aa20104f46a28d0fe8596fec000b93fb0">TEE_MODE_DECRYPT</a>) {</div>
<div class="line">                        CRYPTO_ccm128_decrypt(operation-&gt;<a class="code" href="struct____TEE__OperationHandle.html#a49c6130723c77a4571daa08289f220e1">crypto_ctxt</a>,srcData,destData,*destLen);</div>
<div class="line">                }</div>
<div class="line">                <span class="keywordflow">if</span>(operation-&gt;<a class="code" href="struct____TEE__OperationHandle.html#ad399557c4571d3b2e41d81632803ed70">mode</a> == <a class="code" href="otz__tee__crypto__api_8h.html#a883ffc5fb861ac33d91c7a8058d59744ae986e0ac521db4f424b1c1fae66778c9">TEE_MODE_ENCRYPT</a>) {</div>
<div class="line">                        CRYPTO_ccm128_encrypt(operation-&gt;<a class="code" href="struct____TEE__OperationHandle.html#a49c6130723c77a4571daa08289f220e1">crypto_ctxt</a>,srcData,destData,*destLen);</div>
<div class="line">                }</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">if</span>(operation-&gt;<a class="code" href="struct____TEE__OperationHandle.html#a4750f19edd1529680f9899db1da0f445">algorithm</a> == <a class="code" href="otz__tee__crypto__api_8h.html#a3fb37fc937a1cbad38ddb0279a4cca2dae4b59bc36e09e4908f66be510aec851f">TEE_ALG_AES_GCM</a>) {</div>
<div class="line">                <span class="keywordflow">if</span>(operation-&gt;<a class="code" href="struct____TEE__OperationHandle.html#ad399557c4571d3b2e41d81632803ed70">mode</a> == <a class="code" href="otz__tee__crypto__api_8h.html#a883ffc5fb861ac33d91c7a8058d59744aa20104f46a28d0fe8596fec000b93fb0">TEE_MODE_DECRYPT</a>) {</div>
<div class="line">                        CRYPTO_gcm128_decrypt(operation-&gt;<a class="code" href="struct____TEE__OperationHandle.html#a49c6130723c77a4571daa08289f220e1">crypto_ctxt</a>,srcData,destData,*destLen);</div>
<div class="line">                }</div>
<div class="line">                <span class="keywordflow">if</span>(operation-&gt;<a class="code" href="struct____TEE__OperationHandle.html#ad399557c4571d3b2e41d81632803ed70">mode</a> == <a class="code" href="otz__tee__crypto__api_8h.html#a883ffc5fb861ac33d91c7a8058d59744ae986e0ac521db4f424b1c1fae66778c9">TEE_MODE_ENCRYPT</a>) {</div>
<div class="line">                        CRYPTO_gcm128_encrypt(operation-&gt;<a class="code" href="struct____TEE__OperationHandle.html#a49c6130723c77a4571daa08289f220e1">crypto_ctxt</a>,srcData,destData,*destLen);</div>
<div class="line">                }</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">return</span>(<a class="code" href="otz__tee__api_8h.html#a586a43c1886aa09dc9541fb66e6d8d7fa4d19c2c024e37edc5f04892bb6739dbe">TEEC_SUCCESS</a>);</div>
<div class="line">}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a85a4aafb003fc72cebac46f530423fa9"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void TEE_AEUpdateAAD </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="otz__tee__crypto__api_8h.html#a003ccda0ce6a2d7889b2933a201e2bd1">TEE_OperationHandle</a>&#160;</td>
          <td class="paramname"><em>operation</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>AADdata</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="sw__common__types_8h.html#a7c94ea6f8948649f8d181ae55911eeaf">size_t</a>&#160;</td>
          <td class="paramname"><em>AADdataLen</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">operation</td><td></td></tr>
    <tr><td class="paramname">AADdata</td><td></td></tr>
    <tr><td class="paramname">AADdataLen</td><td></td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="otz__tee__crypto__api_8c_source.html#l01527">1527</a> of file <a class="el" href="otz__tee__crypto__api_8c_source.html">otz_tee_crypto_api.c</a>.</p>
<div class="fragment"><div class="line">{</div>
<div class="line">        <span class="keywordflow">if</span>(operation == <a class="code" href="sw__types_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) {</div>
<div class="line">                <span class="keywordflow">return</span>;</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">if</span>(operation-&gt;<a class="code" href="struct____TEE__OperationHandle.html#aabd85e41a59abec4e8ba16147636a982">operationClass</a> != <a class="code" href="otz__tee__crypto__api_8h.html#ad0c73c650876132dcd7cc6309bf8c2b9a37f7b80ca7f4cc2e049fb205bf46a950">TEE_OPERATION_AE</a>) {</div>
<div class="line">                <a class="code" href="otz__tee__crypto__api_8h.html#a25a6ed042b2e933aeae3c26727987811">TEE_Panic</a>(<a class="code" href="otz__tee__api_8h.html#a586a43c1886aa09dc9541fb66e6d8d7fa4b7583ef234ccb0ef6f7492ee6e8200d">TEEC_ERROR_BAD_PARAMETERS</a>);</div>
<div class="line">                <span class="keywordflow">return</span>;</div>
<div class="line">        }</div>
<div class="line">        <span class="comment">/*if((operation-&gt;keySize + AADdataLen) &gt; operation-&gt;maxKeySize) {</span></div>
<div class="line"><span class="comment">                TEE_Panic(TEEC_ERROR_BAD_PARAMETERS);</span></div>
<div class="line"><span class="comment">                return;</span></div>
<div class="line"><span class="comment">        }*/</span></div>
<div class="line">        <span class="keywordflow">if</span>(operation-&gt;<a class="code" href="struct____TEE__OperationHandle.html#a4750f19edd1529680f9899db1da0f445">algorithm</a> == <a class="code" href="otz__tee__crypto__api_8h.html#a3fb37fc937a1cbad38ddb0279a4cca2dae4b59bc36e09e4908f66be510aec851f">TEE_ALG_AES_GCM</a>) {</div>
<div class="line">                CRYPTO_gcm128_aad(operation-&gt;<a class="code" href="struct____TEE__OperationHandle.html#a49c6130723c77a4571daa08289f220e1">crypto_ctxt</a>,AADdata,AADdataLen);</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">if</span>(operation-&gt;<a class="code" href="struct____TEE__OperationHandle.html#a4750f19edd1529680f9899db1da0f445">algorithm</a> == <a class="code" href="otz__tee__crypto__api_8h.html#a3fb37fc937a1cbad38ddb0279a4cca2da75c0ba38a15b359decf7c15a22fe740d">TEE_ALG_AES_CCM</a>) {</div>
<div class="line">                CRYPTO_ccm128_aad(operation-&gt;<a class="code" href="struct____TEE__OperationHandle.html#a49c6130723c77a4571daa08289f220e1">crypto_ctxt</a>,AADdata,AADdataLen);</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a2a10478a299ccc8ca2d3418ed12f9dca"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="otz__tee__api_8h.html#a586a43c1886aa09dc9541fb66e6d8d7f">TEEC_Result</a> TEE_AllocateOperation </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="otz__tee__crypto__api_8h.html#a003ccda0ce6a2d7889b2933a201e2bd1">TEE_OperationHandle</a> *&#160;</td>
          <td class="paramname"><em>operation</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="otz__api_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a>&#160;</td>
          <td class="paramname"><em>algorithm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="otz__api_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a>&#160;</td>
          <td class="paramname"><em>mode</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="otz__api_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a>&#160;</td>
          <td class="paramname"><em>maxKeySize</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">operation</td><td></td></tr>
    <tr><td class="paramname">algorithm</td><td></td></tr>
    <tr><td class="paramname">mode</td><td></td></tr>
    <tr><td class="paramname">maxKeySize</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd></dd></dl>

<p>Definition at line <a class="el" href="otz__tee__crypto__api_8c_source.html#l00430">430</a> of file <a class="el" href="otz__tee__crypto__api_8c_source.html">otz_tee_crypto_api.c</a>.</p>
<div class="fragment"><div class="line">{</div>
<div class="line">        <a class="code" href="struct____TEE__OperationHandle.html" title="opaque structure definition for an operation handle. It contains almost all the elements of operation...">TEE_OperationHandle</a> localOperationHandle;</div>
<div class="line">        <a class="code" href="otz__tee__api_8h.html#a586a43c1886aa09dc9541fb66e6d8d7f" title="Error codes.">TEEC_Result</a> retVal;</div>
<div class="line"></div>
<div class="line">        <span class="comment">/*if(init_done == 0){</span></div>
<div class="line"><span class="comment">                init_done = 1;</span></div>
<div class="line"><span class="comment">                OpenSSL_add_all_ciphers();</span></div>
<div class="line"><span class="comment">                OpenSSL_add_all_digests();</span></div>
<div class="line"><span class="comment">                ENGINE_load_builtin_engines();</span></div>
<div class="line"><span class="comment">        }*/</span></div>
<div class="line">        <span class="keywordflow">if</span>(check_valid_algorithm(algorithm) == -1) {</div>
<div class="line">                <span class="keywordflow">return</span>(<a class="code" href="otz__tee__api_8h.html#a586a43c1886aa09dc9541fb66e6d8d7fa6aa19b235cb7a7db1456079bdc05d5c9">TEEC_ERROR_NOT_SUPPORTED</a>);</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">if</span>(check_valid_mode(mode) == -1) {</div>
<div class="line">                <span class="keywordflow">return</span>(<a class="code" href="otz__tee__api_8h.html#a586a43c1886aa09dc9541fb66e6d8d7fa6aa19b235cb7a7db1456079bdc05d5c9">TEEC_ERROR_NOT_SUPPORTED</a>);</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">if</span>(check_valid_algorithm_for_mode(mode,algorithm) == -1) {</div>
<div class="line">                <span class="keywordflow">return</span>(<a class="code" href="otz__tee__api_8h.html#a586a43c1886aa09dc9541fb66e6d8d7fa6aa19b235cb7a7db1456079bdc05d5c9">TEEC_ERROR_NOT_SUPPORTED</a>);</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">if</span>((localOperationHandle =</div>
<div class="line">                (<a class="code" href="struct____TEE__OperationHandle.html" title="opaque structure definition for an operation handle. It contains almost all the elements of operation...">TEE_OperationHandle</a>)<a class="code" href="sw__buddy_8h.html#a66652368e6d05f18bdc4be02b0c62694">sw_malloc</a>(<span class="keyword">sizeof</span>(<a class="code" href="struct____TEE__OperationHandle.html" title="opaque structure definition for an operation handle. It contains almost all the elements of operation...">TEE_OperationHandleVar</a>))) == <a class="code" href="sw__types_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) {</div>
<div class="line">                <span class="keywordflow">return</span>(<a class="code" href="otz__tee__api_8h.html#a586a43c1886aa09dc9541fb66e6d8d7fac4927fa5eae4d0446bb2aa422f0d244f">TEEC_ERROR_OUT_OF_MEMORY</a>);</div>
<div class="line">        }</div>
<div class="line">        localOperationHandle-&gt;<a class="code" href="struct____TEE__OperationHandle.html#a4750f19edd1529680f9899db1da0f445">algorithm</a> = algorithm;</div>
<div class="line">        <span class="keywordflow">switch</span>(mode) {</div>
<div class="line">                <span class="keywordflow">case</span> <a class="code" href="otz__tee__crypto__api_8h.html#a883ffc5fb861ac33d91c7a8058d59744a14fd1dd01b612be722995b8753a9ced3">TEE_MODE_DIGEST</a>:</div>
<div class="line">                        <span class="keywordflow">if</span>((retVal = handleDigestAlloc(localOperationHandle)) != <a class="code" href="otz__tee__api_8h.html#a586a43c1886aa09dc9541fb66e6d8d7fa4d19c2c024e37edc5f04892bb6739dbe">TEEC_SUCCESS</a>) {</div>
<div class="line">                                <span class="keywordflow">return</span>(retVal);</div>
<div class="line">                        }</div>
<div class="line">                        localOperationHandle-&gt;<a class="code" href="struct____TEE__OperationHandle.html#aabd85e41a59abec4e8ba16147636a982">operationClass</a> = <a class="code" href="otz__tee__crypto__api_8h.html#ad0c73c650876132dcd7cc6309bf8c2b9a8291e2f74dfb25cda0c443241efb5b83">TEE_OPERATION_DIGEST</a>;</div>
<div class="line">                        <span class="keywordflow">break</span>;</div>
<div class="line">                <span class="keywordflow">case</span> <a class="code" href="otz__tee__crypto__api_8h.html#a883ffc5fb861ac33d91c7a8058d59744a2f3dbf0c7c0373015cf75946564c26f4">TEE_MODE_MAC</a>:</div>
<div class="line">                        <span class="keywordflow">if</span>((retVal = handleMacAlloc(localOperationHandle))</div>
<div class="line">                                                                                                                        != <a class="code" href="otz__tee__api_8h.html#a586a43c1886aa09dc9541fb66e6d8d7fa4d19c2c024e37edc5f04892bb6739dbe">TEEC_SUCCESS</a>) {</div>
<div class="line">                                <span class="keywordflow">return</span>(retVal);</div>
<div class="line">                        }</div>
<div class="line">                        localOperationHandle-&gt;<a class="code" href="struct____TEE__OperationHandle.html#aabd85e41a59abec4e8ba16147636a982">operationClass</a> = <a class="code" href="otz__tee__crypto__api_8h.html#ad0c73c650876132dcd7cc6309bf8c2b9acf36a2cc1dbc642035f06c853675fb32">TEE_OPERATION_MAC</a>;</div>
<div class="line">                        <span class="keywordflow">break</span>;</div>
<div class="line">                <span class="keywordflow">case</span> <a class="code" href="otz__tee__crypto__api_8h.html#a883ffc5fb861ac33d91c7a8058d59744aa20104f46a28d0fe8596fec000b93fb0">TEE_MODE_DECRYPT</a>:</div>
<div class="line">                <span class="keywordflow">case</span> <a class="code" href="otz__tee__crypto__api_8h.html#a883ffc5fb861ac33d91c7a8058d59744ae986e0ac521db4f424b1c1fae66778c9">TEE_MODE_ENCRYPT</a>:</div>
<div class="line">                        <span class="keywordflow">if</span>((retVal = handleCipherAlloc(localOperationHandle))</div>
<div class="line">                                                                                                                        != <a class="code" href="otz__tee__api_8h.html#a586a43c1886aa09dc9541fb66e6d8d7fa4d19c2c024e37edc5f04892bb6739dbe">TEEC_SUCCESS</a>) {</div>
<div class="line">                                <span class="keywordflow">return</span>(retVal);</div>
<div class="line">                        }</div>
<div class="line">                        <span class="keywordflow">if</span>((algorithm == <a class="code" href="otz__tee__crypto__api_8h.html#a3fb37fc937a1cbad38ddb0279a4cca2da75c0ba38a15b359decf7c15a22fe740d">TEE_ALG_AES_CCM</a>) || (algorithm == <a class="code" href="otz__tee__crypto__api_8h.html#a3fb37fc937a1cbad38ddb0279a4cca2dae4b59bc36e09e4908f66be510aec851f">TEE_ALG_AES_GCM</a>)) {</div>
<div class="line">                                localOperationHandle-&gt;<a class="code" href="struct____TEE__OperationHandle.html#aabd85e41a59abec4e8ba16147636a982">operationClass</a> = <a class="code" href="otz__tee__crypto__api_8h.html#ad0c73c650876132dcd7cc6309bf8c2b9a37f7b80ca7f4cc2e049fb205bf46a950">TEE_OPERATION_AE</a>;</div>
<div class="line">                        } <span class="keywordflow">else</span> <span class="keywordflow">if</span>((algorithm == <a class="code" href="otz__tee__crypto__api_8h.html#a3fb37fc937a1cbad38ddb0279a4cca2dae9f210efdb8a6d22d22982a0ef9efbd1">TEE_ALG_RSAES_PKCS1_V1_5</a>) ||</div>
<div class="line">                                        (algorithm == <a class="code" href="otz__tee__crypto__api_8h.html#a3fb37fc937a1cbad38ddb0279a4cca2da650d1d6a0a4e71b2cb2a3582afc0f44f">TEE_ALG_RSA_NOPAD</a>)) {</div>
<div class="line">                                localOperationHandle-&gt;<a class="code" href="struct____TEE__OperationHandle.html#aabd85e41a59abec4e8ba16147636a982">operationClass</a> =</div>
<div class="line">                                        <a class="code" href="otz__tee__crypto__api_8h.html#ad0c73c650876132dcd7cc6309bf8c2b9aea1e65b9a3f86e8aa0c3537c510aaf65">TEE_OPERATION_ASYMMETRIC_CIPHER</a>;</div>
<div class="line">                                localOperationHandle-&gt;<a class="code" href="struct____TEE__OperationHandle.html#a49c6130723c77a4571daa08289f220e1">crypto_ctxt</a> = <a class="code" href="sw__types_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div>
<div class="line">                        } <span class="keywordflow">else</span> {</div>
<div class="line">                                localOperationHandle-&gt;<a class="code" href="struct____TEE__OperationHandle.html#aabd85e41a59abec4e8ba16147636a982">operationClass</a> = <a class="code" href="otz__tee__crypto__api_8h.html#ad0c73c650876132dcd7cc6309bf8c2b9ae19349aa696718354ffa15b9401f553f">TEE_OPERATION_CIPHER</a>;</div>
<div class="line">                        }</div>
<div class="line">                        <span class="keywordflow">break</span>;</div>
<div class="line">                <span class="keywordflow">case</span> <a class="code" href="otz__tee__crypto__api_8h.html#a883ffc5fb861ac33d91c7a8058d59744a96f810c660ff068a087065c6769c0655">TEE_MODE_SIGN</a>:</div>
<div class="line">                <span class="keywordflow">case</span> <a class="code" href="otz__tee__crypto__api_8h.html#a883ffc5fb861ac33d91c7a8058d59744af254d3515d5c4075989a785a568612e3">TEE_MODE_VERIFY</a>:</div>
<div class="line">                        localOperationHandle-&gt;<a class="code" href="struct____TEE__OperationHandle.html#a49c6130723c77a4571daa08289f220e1">crypto_ctxt</a> = <a class="code" href="sw__types_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div>
<div class="line">                        localOperationHandle-&gt;<a class="code" href="struct____TEE__OperationHandle.html#aabd85e41a59abec4e8ba16147636a982">operationClass</a> =</div>
<div class="line">                                <a class="code" href="otz__tee__crypto__api_8h.html#ad0c73c650876132dcd7cc6309bf8c2b9a9a4d80739a0c9476b584e7207f7485a4">TEE_OPERATION_ASYMMETRIC_SIGNATURE</a>;</div>
<div class="line">                        <span class="keywordflow">break</span>;</div>
<div class="line">                <span class="keywordflow">default</span>:</div>
<div class="line">                        <span class="keywordflow">break</span>;</div>
<div class="line">        }</div>
<div class="line">        localOperationHandle-&gt;<a class="code" href="struct____TEE__OperationHandle.html#ad399557c4571d3b2e41d81632803ed70">mode</a> = mode;</div>
<div class="line">        localOperationHandle-&gt;<a class="code" href="struct____TEE__OperationHandle.html#a6fbb10608e0f1145a70e1a4368081706">maxKeySize</a> = maxKeySize;</div>
<div class="line">        *operation = localOperationHandle;</div>
<div class="line">        <span class="keywordflow">return</span>(<a class="code" href="otz__tee__api_8h.html#a586a43c1886aa09dc9541fb66e6d8d7fa4d19c2c024e37edc5f04892bb6739dbe">TEEC_SUCCESS</a>);</div>
<div class="line">}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="af3bd04b33488877d133a354f23250680"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="otz__tee__api_8h.html#a586a43c1886aa09dc9541fb66e6d8d7f">TEEC_Result</a> TEE_AsymmetricDecrypt </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="otz__tee__crypto__api_8h.html#a003ccda0ce6a2d7889b2933a201e2bd1">TEE_OperationHandle</a>&#160;</td>
          <td class="paramname"><em>operation</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structTEE__Attribute.html">TEE_Attribute</a> *&#160;</td>
          <td class="paramname"><em>params</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="otz__api_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a>&#160;</td>
          <td class="paramname"><em>paramCount</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>srcData</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="sw__common__types_8h.html#a7c94ea6f8948649f8d181ae55911eeaf">size_t</a>&#160;</td>
          <td class="paramname"><em>srcLen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>destData</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="sw__common__types_8h.html#a7c94ea6f8948649f8d181ae55911eeaf">size_t</a> *&#160;</td>
          <td class="paramname"><em>destLen</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">operation</td><td></td></tr>
    <tr><td class="paramname">params</td><td></td></tr>
    <tr><td class="paramname">paramCount</td><td></td></tr>
    <tr><td class="paramname">srcData</td><td></td></tr>
    <tr><td class="paramname">srcLen</td><td></td></tr>
    <tr><td class="paramname">destData</td><td></td></tr>
    <tr><td class="paramname">destLen</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd></dd></dl>

<p>Definition at line <a class="el" href="otz__tee__crypto__api_8c_source.html#l01750">1750</a> of file <a class="el" href="otz__tee__crypto__api_8c_source.html">otz_tee_crypto_api.c</a>.</p>
<div class="fragment"><div class="line">{</div>
<div class="line">        <span class="keywordflow">if</span>(operation == <a class="code" href="sw__types_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) {</div>
<div class="line">                <span class="keywordflow">return</span>(<a class="code" href="otz__tee__api_8h.html#a586a43c1886aa09dc9541fb66e6d8d7fa4b7583ef234ccb0ef6f7492ee6e8200d">TEEC_ERROR_BAD_PARAMETERS</a>);</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">if</span>(operation-&gt;<a class="code" href="struct____TEE__OperationHandle.html#aabd85e41a59abec4e8ba16147636a982">operationClass</a> != <a class="code" href="otz__tee__crypto__api_8h.html#ad0c73c650876132dcd7cc6309bf8c2b9aea1e65b9a3f86e8aa0c3537c510aaf65">TEE_OPERATION_ASYMMETRIC_CIPHER</a>) {</div>
<div class="line">                <a class="code" href="otz__tee__crypto__api_8h.html#a25a6ed042b2e933aeae3c26727987811">TEE_Panic</a>(<a class="code" href="otz__tee__api_8h.html#a586a43c1886aa09dc9541fb66e6d8d7fa4b7583ef234ccb0ef6f7492ee6e8200d">TEEC_ERROR_BAD_PARAMETERS</a>);</div>
<div class="line">                <span class="keywordflow">return</span>(<a class="code" href="otz__tee__api_8h.html#a586a43c1886aa09dc9541fb66e6d8d7fa4b7583ef234ccb0ef6f7492ee6e8200d">TEEC_ERROR_BAD_PARAMETERS</a>);</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">switch</span>(operation-&gt;<a class="code" href="struct____TEE__OperationHandle.html#a4750f19edd1529680f9899db1da0f445">algorithm</a>) {</div>
<div class="line">                <span class="keywordflow">case</span> <a class="code" href="otz__tee__crypto__api_8h.html#a3fb37fc937a1cbad38ddb0279a4cca2dae9f210efdb8a6d22d22982a0ef9efbd1">TEE_ALG_RSAES_PKCS1_V1_5</a>:</div>
<div class="line">                        <span class="keywordflow">if</span>(params-&gt;<a class="code" href="structTEE__Attribute.html#a4a6cd490e3ac839612e6d7915230e83c">attributeID</a> == <a class="code" href="otz__tee__crypto__api_8h.html#a3c9f86a7caf4223539989cd785cfc5ef">SW_RSA_USE_PUBLIC</a>) {</div>
<div class="line">                                *destLen = RSA_public_decrypt(srcLen,srcData,destData,</div>
<div class="line">                                operation-&gt;<a class="code" href="struct____TEE__OperationHandle.html#a1143afc5ba92c02e9e3ee751c585cace">keyValue</a>,RSA_PKCS1_PADDING);</div>
<div class="line">                                <span class="keywordflow">if</span>(*destLen == 0) {</div>
<div class="line">                                        <span class="keywordflow">return</span>(<a class="code" href="otz__tee__api_8h.html#a586a43c1886aa09dc9541fb66e6d8d7fa8f1a521bf548e65263e0a9984414682f">TEEC_ERROR_NO_DATA</a>);</div>
<div class="line">                                }</div>
<div class="line">                        } <span class="keywordflow">else</span> {</div>
<div class="line">                                *destLen = RSA_private_decrypt(srcLen,srcData,destData,</div>
<div class="line">                                operation-&gt;<a class="code" href="struct____TEE__OperationHandle.html#a1143afc5ba92c02e9e3ee751c585cace">keyValue</a>,RSA_PKCS1_PADDING);</div>
<div class="line">                                <span class="keywordflow">if</span>(*destLen == 0) {</div>
<div class="line">                                        <span class="keywordflow">return</span>(<a class="code" href="otz__tee__api_8h.html#a586a43c1886aa09dc9541fb66e6d8d7fa8f1a521bf548e65263e0a9984414682f">TEEC_ERROR_NO_DATA</a>);</div>
<div class="line">                                }</div>
<div class="line">                        }</div>
<div class="line">                        <span class="keywordflow">break</span>;</div>
<div class="line">                <span class="keywordflow">case</span> <a class="code" href="otz__tee__crypto__api_8h.html#a3fb37fc937a1cbad38ddb0279a4cca2daa2871a4ed4ee8c83dc535c4e009ef582">TEE_ALG_RSAES_PKCS1_OAEP_MGF1_SHA1</a>:</div>
<div class="line">                        <span class="keywordflow">break</span>;</div>
<div class="line">                <span class="keywordflow">case</span> <a class="code" href="otz__tee__crypto__api_8h.html#a3fb37fc937a1cbad38ddb0279a4cca2da650d1d6a0a4e71b2cb2a3582afc0f44f">TEE_ALG_RSA_NOPAD</a>:</div>
<div class="line">                        <span class="keywordflow">if</span>(params-&gt;<a class="code" href="structTEE__Attribute.html#a4a6cd490e3ac839612e6d7915230e83c">attributeID</a> == <a class="code" href="otz__tee__crypto__api_8h.html#a3c9f86a7caf4223539989cd785cfc5ef">SW_RSA_USE_PUBLIC</a>) {</div>
<div class="line">                                *destLen = RSA_public_decrypt(srcLen,srcData,destData,</div>
<div class="line">                                operation-&gt;<a class="code" href="struct____TEE__OperationHandle.html#a1143afc5ba92c02e9e3ee751c585cace">keyValue</a>,RSA_NO_PADDING);</div>
<div class="line">                                <span class="keywordflow">if</span>(*destLen == 0) {</div>
<div class="line">                                        <span class="keywordflow">return</span>(<a class="code" href="otz__tee__api_8h.html#a586a43c1886aa09dc9541fb66e6d8d7fa8f1a521bf548e65263e0a9984414682f">TEEC_ERROR_NO_DATA</a>);</div>
<div class="line">                                }</div>
<div class="line">                        } <span class="keywordflow">else</span> {</div>
<div class="line">                                *destLen = RSA_private_decrypt(srcLen,srcData,destData,</div>
<div class="line">                                operation-&gt;<a class="code" href="struct____TEE__OperationHandle.html#a1143afc5ba92c02e9e3ee751c585cace">keyValue</a>,RSA_NO_PADDING);</div>
<div class="line">                                <span class="keywordflow">if</span>(*destLen == 0) {</div>
<div class="line">                                        <span class="keywordflow">return</span>(<a class="code" href="otz__tee__api_8h.html#a586a43c1886aa09dc9541fb66e6d8d7fa8f1a521bf548e65263e0a9984414682f">TEEC_ERROR_NO_DATA</a>);</div>
<div class="line">                                }</div>
<div class="line">                        }</div>
<div class="line">                        <span class="keywordflow">break</span>;</div>
<div class="line">                <span class="keywordflow">default</span>:</div>
<div class="line">                        <span class="keywordflow">return</span>(<a class="code" href="otz__tee__api_8h.html#a586a43c1886aa09dc9541fb66e6d8d7fa4b7583ef234ccb0ef6f7492ee6e8200d">TEEC_ERROR_BAD_PARAMETERS</a>);</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">return</span>(<a class="code" href="otz__tee__api_8h.html#a586a43c1886aa09dc9541fb66e6d8d7fa4d19c2c024e37edc5f04892bb6739dbe">TEEC_SUCCESS</a>);</div>
<div class="line">}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a583d9d6c3f2294d4053cc5e1fca91c6e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="otz__tee__api_8h.html#a586a43c1886aa09dc9541fb66e6d8d7f">TEEC_Result</a> TEE_AsymmetricEncrypt </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="otz__tee__crypto__api_8h.html#a003ccda0ce6a2d7889b2933a201e2bd1">TEE_OperationHandle</a>&#160;</td>
          <td class="paramname"><em>operation</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structTEE__Attribute.html">TEE_Attribute</a> *&#160;</td>
          <td class="paramname"><em>params</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="otz__api_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a>&#160;</td>
          <td class="paramname"><em>paramCount</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>srcData</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="sw__common__types_8h.html#a7c94ea6f8948649f8d181ae55911eeaf">size_t</a>&#160;</td>
          <td class="paramname"><em>srcLen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>destData</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="sw__common__types_8h.html#a7c94ea6f8948649f8d181ae55911eeaf">size_t</a> *&#160;</td>
          <td class="paramname"><em>destLen</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">operation</td><td></td></tr>
    <tr><td class="paramname">params</td><td></td></tr>
    <tr><td class="paramname">paramCount</td><td></td></tr>
    <tr><td class="paramname">srcData</td><td></td></tr>
    <tr><td class="paramname">srcLen</td><td></td></tr>
    <tr><td class="paramname">destData</td><td></td></tr>
    <tr><td class="paramname">destLen</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd></dd></dl>

<p>Definition at line <a class="el" href="otz__tee__crypto__api_8c_source.html#l01686">1686</a> of file <a class="el" href="otz__tee__crypto__api_8c_source.html">otz_tee_crypto_api.c</a>.</p>
<div class="fragment"><div class="line">{</div>
<div class="line">        <span class="keywordflow">if</span>(operation == <a class="code" href="sw__types_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) {</div>
<div class="line">                <span class="keywordflow">return</span>(<a class="code" href="otz__tee__api_8h.html#a586a43c1886aa09dc9541fb66e6d8d7fa4b7583ef234ccb0ef6f7492ee6e8200d">TEEC_ERROR_BAD_PARAMETERS</a>);</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">if</span>(operation-&gt;<a class="code" href="struct____TEE__OperationHandle.html#aabd85e41a59abec4e8ba16147636a982">operationClass</a> != <a class="code" href="otz__tee__crypto__api_8h.html#ad0c73c650876132dcd7cc6309bf8c2b9aea1e65b9a3f86e8aa0c3537c510aaf65">TEE_OPERATION_ASYMMETRIC_CIPHER</a>) {</div>
<div class="line">                <a class="code" href="otz__tee__crypto__api_8h.html#a25a6ed042b2e933aeae3c26727987811">TEE_Panic</a>(<a class="code" href="otz__tee__api_8h.html#a586a43c1886aa09dc9541fb66e6d8d7fa4b7583ef234ccb0ef6f7492ee6e8200d">TEEC_ERROR_BAD_PARAMETERS</a>);</div>
<div class="line">                <span class="keywordflow">return</span>(<a class="code" href="otz__tee__api_8h.html#a586a43c1886aa09dc9541fb66e6d8d7fa4b7583ef234ccb0ef6f7492ee6e8200d">TEEC_ERROR_BAD_PARAMETERS</a>);</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">switch</span>(operation-&gt;<a class="code" href="struct____TEE__OperationHandle.html#a4750f19edd1529680f9899db1da0f445">algorithm</a>) {</div>
<div class="line">                <span class="keywordflow">case</span> <a class="code" href="otz__tee__crypto__api_8h.html#a3fb37fc937a1cbad38ddb0279a4cca2dae9f210efdb8a6d22d22982a0ef9efbd1">TEE_ALG_RSAES_PKCS1_V1_5</a>:</div>
<div class="line">                        <span class="keywordflow">if</span>(params-&gt;<a class="code" href="structTEE__Attribute.html#a4a6cd490e3ac839612e6d7915230e83c">attributeID</a> ==  <a class="code" href="otz__tee__crypto__api_8h.html#af14cd9b767dcb86baacd520aa33f9da9">SW_RSA_USE_PRIVATE</a>) {</div>
<div class="line">                                *destLen = RSA_private_encrypt(srcLen,srcData,destData,</div>
<div class="line">                                operation-&gt;<a class="code" href="struct____TEE__OperationHandle.html#a1143afc5ba92c02e9e3ee751c585cace">keyValue</a>,RSA_PKCS1_PADDING);</div>
<div class="line">                                <span class="keywordflow">if</span>(*destLen == 0) {</div>
<div class="line">                                        <span class="keywordflow">return</span>(<a class="code" href="otz__tee__api_8h.html#a586a43c1886aa09dc9541fb66e6d8d7fa8f1a521bf548e65263e0a9984414682f">TEEC_ERROR_NO_DATA</a>);</div>
<div class="line">                                }</div>
<div class="line">                        } <span class="keywordflow">else</span> {</div>
<div class="line">                                *destLen = RSA_public_encrypt(srcLen,srcData,destData,</div>
<div class="line">                                operation-&gt;<a class="code" href="struct____TEE__OperationHandle.html#a1143afc5ba92c02e9e3ee751c585cace">keyValue</a>,RSA_PKCS1_PADDING);</div>
<div class="line">                                <span class="keywordflow">if</span>(*destLen == 0) {</div>
<div class="line">                                        <span class="keywordflow">return</span>(<a class="code" href="otz__tee__api_8h.html#a586a43c1886aa09dc9541fb66e6d8d7fa8f1a521bf548e65263e0a9984414682f">TEEC_ERROR_NO_DATA</a>);</div>
<div class="line">                                }</div>
<div class="line">                        }</div>
<div class="line">                        <span class="keywordflow">break</span>;</div>
<div class="line">                <span class="keywordflow">case</span> <a class="code" href="otz__tee__crypto__api_8h.html#a3fb37fc937a1cbad38ddb0279a4cca2daa2871a4ed4ee8c83dc535c4e009ef582">TEE_ALG_RSAES_PKCS1_OAEP_MGF1_SHA1</a>:</div>
<div class="line">                        <span class="keywordflow">break</span>;</div>
<div class="line">                <span class="keywordflow">case</span> <a class="code" href="otz__tee__crypto__api_8h.html#a3fb37fc937a1cbad38ddb0279a4cca2da650d1d6a0a4e71b2cb2a3582afc0f44f">TEE_ALG_RSA_NOPAD</a>:</div>
<div class="line">                        <span class="keywordflow">if</span>(params-&gt;<a class="code" href="structTEE__Attribute.html#a4a6cd490e3ac839612e6d7915230e83c">attributeID</a> == <a class="code" href="otz__tee__crypto__api_8h.html#af14cd9b767dcb86baacd520aa33f9da9">SW_RSA_USE_PRIVATE</a>) {</div>
<div class="line">                                *destLen = RSA_private_encrypt(srcLen,srcData,destData,</div>
<div class="line">                                operation-&gt;<a class="code" href="struct____TEE__OperationHandle.html#a1143afc5ba92c02e9e3ee751c585cace">keyValue</a>,RSA_NO_PADDING);</div>
<div class="line">                                <span class="keywordflow">if</span>(*destLen == 0) {</div>
<div class="line">                                        <span class="keywordflow">return</span>(<a class="code" href="otz__tee__api_8h.html#a586a43c1886aa09dc9541fb66e6d8d7fa8f1a521bf548e65263e0a9984414682f">TEEC_ERROR_NO_DATA</a>);</div>
<div class="line">                                }</div>
<div class="line">                        } <span class="keywordflow">else</span> {</div>
<div class="line">                                *destLen = RSA_public_encrypt(srcLen,srcData,destData,</div>
<div class="line">                                operation-&gt;<a class="code" href="struct____TEE__OperationHandle.html#a1143afc5ba92c02e9e3ee751c585cace">keyValue</a>,RSA_NO_PADDING);</div>
<div class="line">                                <span class="keywordflow">if</span>(*destLen == 0) {</div>
<div class="line">                                        <span class="keywordflow">return</span>(<a class="code" href="otz__tee__api_8h.html#a586a43c1886aa09dc9541fb66e6d8d7fa8f1a521bf548e65263e0a9984414682f">TEEC_ERROR_NO_DATA</a>);</div>
<div class="line">                                }</div>
<div class="line">                        }</div>
<div class="line">                        <span class="keywordflow">break</span>;</div>
<div class="line">                <span class="keywordflow">default</span>:</div>
<div class="line">                        <span class="keywordflow">return</span>(<a class="code" href="otz__tee__api_8h.html#a586a43c1886aa09dc9541fb66e6d8d7fa4b7583ef234ccb0ef6f7492ee6e8200d">TEEC_ERROR_BAD_PARAMETERS</a>);</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">return</span>(<a class="code" href="otz__tee__api_8h.html#a586a43c1886aa09dc9541fb66e6d8d7fa4d19c2c024e37edc5f04892bb6739dbe">TEEC_SUCCESS</a>);</div>
<div class="line">}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a4a7987af6dd94294fc6791240d10f4e3"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="otz__tee__api_8h.html#a586a43c1886aa09dc9541fb66e6d8d7f">TEEC_Result</a> TEE_AsymmetricSignDigest </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="otz__tee__crypto__api_8h.html#a003ccda0ce6a2d7889b2933a201e2bd1">TEE_OperationHandle</a>&#160;</td>
          <td class="paramname"><em>operation</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structTEE__Attribute.html">TEE_Attribute</a> *&#160;</td>
          <td class="paramname"><em>params</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="otz__api_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a>&#160;</td>
          <td class="paramname"><em>paramCount</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>digest</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="sw__common__types_8h.html#a7c94ea6f8948649f8d181ae55911eeaf">size_t</a>&#160;</td>
          <td class="paramname"><em>digestLen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>signature</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="sw__common__types_8h.html#a7c94ea6f8948649f8d181ae55911eeaf">size_t</a> *&#160;</td>
          <td class="paramname"><em>signatureLen</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">operation</td><td></td></tr>
    <tr><td class="paramname">params</td><td></td></tr>
    <tr><td class="paramname">paramCount</td><td></td></tr>
    <tr><td class="paramname">digest</td><td></td></tr>
    <tr><td class="paramname">digestLen</td><td></td></tr>
    <tr><td class="paramname">signature</td><td></td></tr>
    <tr><td class="paramname">signatureLen</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd></dd></dl>

<p>Definition at line <a class="el" href="otz__tee__crypto__api_8c_source.html#l01814">1814</a> of file <a class="el" href="otz__tee__crypto__api_8c_source.html">otz_tee_crypto_api.c</a>.</p>
<div class="fragment"><div class="line">{</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span>(operation == <a class="code" href="sw__types_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) {</div>
<div class="line">                <span class="keywordflow">return</span>(<a class="code" href="otz__tee__api_8h.html#a586a43c1886aa09dc9541fb66e6d8d7fa4b7583ef234ccb0ef6f7492ee6e8200d">TEEC_ERROR_BAD_PARAMETERS</a>);</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">if</span>(operation-&gt;<a class="code" href="struct____TEE__OperationHandle.html#aabd85e41a59abec4e8ba16147636a982">operationClass</a> != <a class="code" href="otz__tee__crypto__api_8h.html#ad0c73c650876132dcd7cc6309bf8c2b9a9a4d80739a0c9476b584e7207f7485a4">TEE_OPERATION_ASYMMETRIC_SIGNATURE</a>) {</div>
<div class="line">                <a class="code" href="otz__tee__crypto__api_8h.html#a25a6ed042b2e933aeae3c26727987811">TEE_Panic</a>(<a class="code" href="otz__tee__api_8h.html#a586a43c1886aa09dc9541fb66e6d8d7fa4b7583ef234ccb0ef6f7492ee6e8200d">TEEC_ERROR_BAD_PARAMETERS</a>);</div>
<div class="line">                <span class="keywordflow">return</span>(<a class="code" href="otz__tee__api_8h.html#a586a43c1886aa09dc9541fb66e6d8d7fa4b7583ef234ccb0ef6f7492ee6e8200d">TEEC_ERROR_BAD_PARAMETERS</a>);</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">switch</span>(operation-&gt;<a class="code" href="struct____TEE__OperationHandle.html#a4750f19edd1529680f9899db1da0f445">algorithm</a>) {</div>
<div class="line">                <span class="keywordflow">case</span> <a class="code" href="otz__tee__crypto__api_8h.html#a3fb37fc937a1cbad38ddb0279a4cca2daa7fe10548e4a524810f226b0b0e9b2ef">TEE_ALG_RSASSA_PKCS1_V1_5_MD5</a>:</div>
<div class="line">                        <span class="keywordflow">if</span>(RSA_sign(NID_md5,digest,digestLen,signature,</div>
<div class="line">                                signatureLen,operation-&gt;<a class="code" href="struct____TEE__OperationHandle.html#a1143afc5ba92c02e9e3ee751c585cace">keyValue</a>) == 0) {</div>
<div class="line">                                <span class="keywordflow">return</span>(<a class="code" href="otz__tee__api_8h.html#a586a43c1886aa09dc9541fb66e6d8d7fa02f725c8d52b5efbf5bb58ca2f234c4d">TEEC_ERROR_BAD_STATE</a>);</div>
<div class="line">                        }</div>
<div class="line">                        <span class="keywordflow">break</span>;</div>
<div class="line">                <span class="keywordflow">case</span> <a class="code" href="otz__tee__crypto__api_8h.html#a3fb37fc937a1cbad38ddb0279a4cca2da63f0d0ffe7c4a747ff3de3fde48a7a68">TEE_ALG_RSASSA_PKCS1_V1_5_SHA1</a>:</div>
<div class="line">                        <span class="keywordflow">if</span>(RSA_sign(NID_sha1,digest,digestLen,signature,</div>
<div class="line">                                signatureLen,operation-&gt;<a class="code" href="struct____TEE__OperationHandle.html#a1143afc5ba92c02e9e3ee751c585cace">keyValue</a>) == 0) {</div>
<div class="line">                                <span class="keywordflow">return</span>(<a class="code" href="otz__tee__api_8h.html#a586a43c1886aa09dc9541fb66e6d8d7fa02f725c8d52b5efbf5bb58ca2f234c4d">TEEC_ERROR_BAD_STATE</a>);</div>
<div class="line">                        }</div>
<div class="line">                        <span class="keywordflow">break</span>;</div>
<div class="line">                <span class="keywordflow">case</span> <a class="code" href="otz__tee__crypto__api_8h.html#a3fb37fc937a1cbad38ddb0279a4cca2da28a842b7b175a0bff3e31289a0a9558d">TEE_ALG_RSASSA_PKCS1_V1_5_SHA224</a>:</div>
<div class="line">                <span class="keywordflow">case</span> <a class="code" href="otz__tee__crypto__api_8h.html#a3fb37fc937a1cbad38ddb0279a4cca2dacdcf9c72465514116561ffe85ad0c534">TEE_ALG_RSASSA_PKCS1_V1_5_SHA256</a>:</div>
<div class="line">                <span class="keywordflow">case</span> <a class="code" href="otz__tee__crypto__api_8h.html#a3fb37fc937a1cbad38ddb0279a4cca2da7645a82340d0bbab3722272d57f75a9e">TEE_ALG_RSASSA_PKCS1_V1_5_SHA384</a>:</div>
<div class="line">                <span class="keywordflow">case</span> <a class="code" href="otz__tee__crypto__api_8h.html#a3fb37fc937a1cbad38ddb0279a4cca2da13562e79a6d5ce0d29fbb651805a4bbb">TEE_ALG_RSASSA_PKCS1_V1_5_SHA512</a>:</div>
<div class="line">                <span class="keywordflow">case</span> <a class="code" href="otz__tee__crypto__api_8h.html#a3fb37fc937a1cbad38ddb0279a4cca2da43186439e46933a2fcda5364fb5c5b46">TEE_ALG_RSASSA_PKCS1_PSS_MGF1_SHA1</a>:</div>
<div class="line">                <span class="keywordflow">case</span> <a class="code" href="otz__tee__crypto__api_8h.html#a3fb37fc937a1cbad38ddb0279a4cca2daf85f793ebbf70d948f73ae4364946283">TEE_ALG_RSASSA_PKCS1_PSS_MGF1_SHA224</a>:</div>
<div class="line">                <span class="keywordflow">case</span> <a class="code" href="otz__tee__crypto__api_8h.html#a3fb37fc937a1cbad38ddb0279a4cca2da422f0d46b36c281d9d65c87c8302c8f7">TEE_ALG_RSASSA_PKCS1_PSS_MGF1_SHA256</a>:</div>
<div class="line">                <span class="keywordflow">case</span> <a class="code" href="otz__tee__crypto__api_8h.html#a3fb37fc937a1cbad38ddb0279a4cca2da32257de5b26061f13e8d488ac69d133a">TEE_ALG_RSASSA_PKCS1_PSS_MGF1_SHA384</a>:</div>
<div class="line">                <span class="keywordflow">case</span> <a class="code" href="otz__tee__crypto__api_8h.html#a3fb37fc937a1cbad38ddb0279a4cca2da24e230b8420bfdc925d688cafb8412da">TEE_ALG_RSASSA_PKCS1_PSS_MGF1_SHA512</a>:</div>
<div class="line">                        <span class="keywordflow">break</span>;</div>
<div class="line">                <span class="keywordflow">case</span> <a class="code" href="otz__tee__crypto__api_8h.html#a3fb37fc937a1cbad38ddb0279a4cca2daa1817df024be65f38f7d43af0d9a341b">TEE_ALG_DSA_SHA1</a>:</div>
<div class="line">                        <span class="keywordflow">if</span>(DSA_sign(NID_sha1,digest,digestLen,signature,</div>
<div class="line">                                signatureLen,operation-&gt;<a class="code" href="struct____TEE__OperationHandle.html#a1143afc5ba92c02e9e3ee751c585cace">keyValue</a>) == 0) {</div>
<div class="line">                                <span class="keywordflow">return</span>(<a class="code" href="otz__tee__api_8h.html#a586a43c1886aa09dc9541fb66e6d8d7fa02f725c8d52b5efbf5bb58ca2f234c4d">TEEC_ERROR_BAD_STATE</a>);</div>
<div class="line">                        }</div>
<div class="line">                        <span class="keywordflow">break</span>;</div>
<div class="line">                        <span class="keywordflow">break</span>;</div>
<div class="line">                <span class="keywordflow">default</span>:</div>
<div class="line">                        <span class="keywordflow">return</span>(<a class="code" href="otz__tee__api_8h.html#a586a43c1886aa09dc9541fb66e6d8d7fa4b7583ef234ccb0ef6f7492ee6e8200d">TEEC_ERROR_BAD_PARAMETERS</a>);</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">return</span>(<a class="code" href="otz__tee__api_8h.html#a586a43c1886aa09dc9541fb66e6d8d7fa4d19c2c024e37edc5f04892bb6739dbe">TEEC_SUCCESS</a>);</div>
<div class="line">}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a09743a6c13479d2ada860fd35027e7c2"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="otz__tee__api_8h.html#a586a43c1886aa09dc9541fb66e6d8d7f">TEEC_Result</a> TEE_AsymmetricVerifyDigest </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="otz__tee__crypto__api_8h.html#a003ccda0ce6a2d7889b2933a201e2bd1">TEE_OperationHandle</a>&#160;</td>
          <td class="paramname"><em>operation</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structTEE__Attribute.html">TEE_Attribute</a> *&#160;</td>
          <td class="paramname"><em>params</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="otz__api_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a>&#160;</td>
          <td class="paramname"><em>paramCount</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>digest</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="sw__common__types_8h.html#a7c94ea6f8948649f8d181ae55911eeaf">size_t</a>&#160;</td>
          <td class="paramname"><em>digestLen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>signature</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="sw__common__types_8h.html#a7c94ea6f8948649f8d181ae55911eeaf">size_t</a>&#160;</td>
          <td class="paramname"><em>signatureLen</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">operation</td><td></td></tr>
    <tr><td class="paramname">params</td><td></td></tr>
    <tr><td class="paramname">paramCount</td><td></td></tr>
    <tr><td class="paramname">digest</td><td></td></tr>
    <tr><td class="paramname">digestLen</td><td></td></tr>
    <tr><td class="paramname">signature</td><td></td></tr>
    <tr><td class="paramname">signatureLen</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd></dd></dl>

<p>Definition at line <a class="el" href="otz__tee__crypto__api_8c_source.html#l01875">1875</a> of file <a class="el" href="otz__tee__crypto__api_8c_source.html">otz_tee_crypto_api.c</a>.</p>
<div class="fragment"><div class="line">{</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span>(operation == <a class="code" href="sw__types_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) {</div>
<div class="line">                <span class="keywordflow">return</span>(<a class="code" href="otz__tee__api_8h.html#a586a43c1886aa09dc9541fb66e6d8d7fa4b7583ef234ccb0ef6f7492ee6e8200d">TEEC_ERROR_BAD_PARAMETERS</a>);</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">if</span>(operation-&gt;<a class="code" href="struct____TEE__OperationHandle.html#aabd85e41a59abec4e8ba16147636a982">operationClass</a> != <a class="code" href="otz__tee__crypto__api_8h.html#ad0c73c650876132dcd7cc6309bf8c2b9a9a4d80739a0c9476b584e7207f7485a4">TEE_OPERATION_ASYMMETRIC_SIGNATURE</a>) {</div>
<div class="line">                <a class="code" href="otz__tee__crypto__api_8h.html#a25a6ed042b2e933aeae3c26727987811">TEE_Panic</a>(<a class="code" href="otz__tee__api_8h.html#a586a43c1886aa09dc9541fb66e6d8d7fa4b7583ef234ccb0ef6f7492ee6e8200d">TEEC_ERROR_BAD_PARAMETERS</a>);</div>
<div class="line">                <span class="keywordflow">return</span>(<a class="code" href="otz__tee__api_8h.html#a586a43c1886aa09dc9541fb66e6d8d7fa4b7583ef234ccb0ef6f7492ee6e8200d">TEEC_ERROR_BAD_PARAMETERS</a>);</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">switch</span>(operation-&gt;<a class="code" href="struct____TEE__OperationHandle.html#a4750f19edd1529680f9899db1da0f445">algorithm</a>) {</div>
<div class="line">                <span class="keywordflow">case</span> <a class="code" href="otz__tee__crypto__api_8h.html#a3fb37fc937a1cbad38ddb0279a4cca2daa7fe10548e4a524810f226b0b0e9b2ef">TEE_ALG_RSASSA_PKCS1_V1_5_MD5</a>:</div>
<div class="line">                        <span class="keywordflow">if</span>(RSA_verify(NID_md5,digest,digestLen,signature,</div>
<div class="line">                        signatureLen,operation-&gt;<a class="code" href="struct____TEE__OperationHandle.html#a1143afc5ba92c02e9e3ee751c585cace">keyValue</a>) == 0) {</div>
<div class="line">                                <span class="keywordflow">return</span>(<a class="code" href="otz__tee__api_8h.html#a586a43c1886aa09dc9541fb66e6d8d7fa02f725c8d52b5efbf5bb58ca2f234c4d">TEEC_ERROR_BAD_STATE</a>);</div>
<div class="line">                        }</div>
<div class="line">                        <span class="keywordflow">break</span>;</div>
<div class="line">                <span class="keywordflow">case</span> <a class="code" href="otz__tee__crypto__api_8h.html#a3fb37fc937a1cbad38ddb0279a4cca2da63f0d0ffe7c4a747ff3de3fde48a7a68">TEE_ALG_RSASSA_PKCS1_V1_5_SHA1</a>:</div>
<div class="line">                        <span class="keywordflow">if</span>(RSA_verify(NID_sha1,digest,digestLen,signature,</div>
<div class="line">                        signatureLen,operation-&gt;<a class="code" href="struct____TEE__OperationHandle.html#a1143afc5ba92c02e9e3ee751c585cace">keyValue</a>) == 0) {</div>
<div class="line">                                <span class="keywordflow">return</span>(<a class="code" href="otz__tee__api_8h.html#a586a43c1886aa09dc9541fb66e6d8d7fa02f725c8d52b5efbf5bb58ca2f234c4d">TEEC_ERROR_BAD_STATE</a>);</div>
<div class="line">                        }</div>
<div class="line">                        <span class="keywordflow">break</span>;</div>
<div class="line">                <span class="keywordflow">case</span> <a class="code" href="otz__tee__crypto__api_8h.html#a3fb37fc937a1cbad38ddb0279a4cca2da28a842b7b175a0bff3e31289a0a9558d">TEE_ALG_RSASSA_PKCS1_V1_5_SHA224</a>:</div>
<div class="line">                <span class="keywordflow">case</span> <a class="code" href="otz__tee__crypto__api_8h.html#a3fb37fc937a1cbad38ddb0279a4cca2dacdcf9c72465514116561ffe85ad0c534">TEE_ALG_RSASSA_PKCS1_V1_5_SHA256</a>:</div>
<div class="line">                <span class="keywordflow">case</span> <a class="code" href="otz__tee__crypto__api_8h.html#a3fb37fc937a1cbad38ddb0279a4cca2da7645a82340d0bbab3722272d57f75a9e">TEE_ALG_RSASSA_PKCS1_V1_5_SHA384</a>:</div>
<div class="line">                <span class="keywordflow">case</span> <a class="code" href="otz__tee__crypto__api_8h.html#a3fb37fc937a1cbad38ddb0279a4cca2da13562e79a6d5ce0d29fbb651805a4bbb">TEE_ALG_RSASSA_PKCS1_V1_5_SHA512</a>:</div>
<div class="line">                <span class="keywordflow">case</span> <a class="code" href="otz__tee__crypto__api_8h.html#a3fb37fc937a1cbad38ddb0279a4cca2da43186439e46933a2fcda5364fb5c5b46">TEE_ALG_RSASSA_PKCS1_PSS_MGF1_SHA1</a>:</div>
<div class="line">                <span class="keywordflow">case</span> <a class="code" href="otz__tee__crypto__api_8h.html#a3fb37fc937a1cbad38ddb0279a4cca2daf85f793ebbf70d948f73ae4364946283">TEE_ALG_RSASSA_PKCS1_PSS_MGF1_SHA224</a>:</div>
<div class="line">                <span class="keywordflow">case</span> <a class="code" href="otz__tee__crypto__api_8h.html#a3fb37fc937a1cbad38ddb0279a4cca2da422f0d46b36c281d9d65c87c8302c8f7">TEE_ALG_RSASSA_PKCS1_PSS_MGF1_SHA256</a>:</div>
<div class="line">                <span class="keywordflow">case</span> <a class="code" href="otz__tee__crypto__api_8h.html#a3fb37fc937a1cbad38ddb0279a4cca2da32257de5b26061f13e8d488ac69d133a">TEE_ALG_RSASSA_PKCS1_PSS_MGF1_SHA384</a>:</div>
<div class="line">                <span class="keywordflow">case</span> <a class="code" href="otz__tee__crypto__api_8h.html#a3fb37fc937a1cbad38ddb0279a4cca2da24e230b8420bfdc925d688cafb8412da">TEE_ALG_RSASSA_PKCS1_PSS_MGF1_SHA512</a>:</div>
<div class="line">                        <span class="keywordflow">break</span>;</div>
<div class="line">                <span class="keywordflow">case</span> <a class="code" href="otz__tee__crypto__api_8h.html#a3fb37fc937a1cbad38ddb0279a4cca2daa1817df024be65f38f7d43af0d9a341b">TEE_ALG_DSA_SHA1</a>:</div>
<div class="line">                        <span class="keywordflow">if</span>(DSA_verify(NID_sha1,digest,digestLen,signature,</div>
<div class="line">                        signatureLen,operation-&gt;<a class="code" href="struct____TEE__OperationHandle.html#a1143afc5ba92c02e9e3ee751c585cace">keyValue</a>) == 0) {</div>
<div class="line">                                <span class="keywordflow">return</span>(<a class="code" href="otz__tee__api_8h.html#a586a43c1886aa09dc9541fb66e6d8d7fa02f725c8d52b5efbf5bb58ca2f234c4d">TEEC_ERROR_BAD_STATE</a>);</div>
<div class="line">                        }</div>
<div class="line">                        <span class="keywordflow">break</span>;</div>
<div class="line">                <span class="keywordflow">default</span>:</div>
<div class="line">                        <span class="keywordflow">return</span>(<a class="code" href="otz__tee__api_8h.html#a586a43c1886aa09dc9541fb66e6d8d7fa4b7583ef234ccb0ef6f7492ee6e8200d">TEEC_ERROR_BAD_PARAMETERS</a>);</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">return</span>(<a class="code" href="otz__tee__api_8h.html#a586a43c1886aa09dc9541fb66e6d8d7fa4d19c2c024e37edc5f04892bb6739dbe">TEEC_SUCCESS</a>);</div>
<div class="line">}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="aa224e15a3bd16ce2653128814ffe9a8a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="otz__tee__api_8h.html#a586a43c1886aa09dc9541fb66e6d8d7f">TEEC_Result</a> TEE_CipherDoFinal </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="otz__tee__crypto__api_8h.html#a003ccda0ce6a2d7889b2933a201e2bd1">TEE_OperationHandle</a>&#160;</td>
          <td class="paramname"><em>operation</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>srcData</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="sw__common__types_8h.html#a7c94ea6f8948649f8d181ae55911eeaf">size_t</a>&#160;</td>
          <td class="paramname"><em>srcLen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>destData</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="sw__common__types_8h.html#a7c94ea6f8948649f8d181ae55911eeaf">size_t</a> *&#160;</td>
          <td class="paramname"><em>destLen</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">operation</td><td></td></tr>
    <tr><td class="paramname">srcData</td><td></td></tr>
    <tr><td class="paramname">srcLen</td><td></td></tr>
    <tr><td class="paramname">destData</td><td></td></tr>
    <tr><td class="paramname">destLen</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd></dd></dl>

<p>Definition at line <a class="el" href="otz__tee__crypto__api_8c_source.html#l01198">1198</a> of file <a class="el" href="otz__tee__crypto__api_8c_source.html">otz_tee_crypto_api.c</a>.</p>
<div class="fragment"><div class="line">{</div>
<div class="line">        <a class="code" href="sw__types_8h.html#aed742c436da53c1080638ce6ef7d13de">u8</a> retVal = 0;</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span>(operation == <a class="code" href="sw__types_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) {</div>
<div class="line">                <span class="keywordflow">return</span>(<a class="code" href="otz__tee__api_8h.html#a586a43c1886aa09dc9541fb66e6d8d7fa4b7583ef234ccb0ef6f7492ee6e8200d">TEEC_ERROR_BAD_PARAMETERS</a>);</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">if</span>(operation-&gt;<a class="code" href="struct____TEE__OperationHandle.html#aabd85e41a59abec4e8ba16147636a982">operationClass</a> != <a class="code" href="otz__tee__crypto__api_8h.html#ad0c73c650876132dcd7cc6309bf8c2b9ae19349aa696718354ffa15b9401f553f">TEE_OPERATION_CIPHER</a>) {</div>
<div class="line">                <a class="code" href="otz__tee__crypto__api_8h.html#a25a6ed042b2e933aeae3c26727987811">TEE_Panic</a>(<a class="code" href="otz__tee__api_8h.html#a586a43c1886aa09dc9541fb66e6d8d7fa4b7583ef234ccb0ef6f7492ee6e8200d">TEEC_ERROR_BAD_PARAMETERS</a>);</div>
<div class="line">                <span class="keywordflow">return</span>(<a class="code" href="otz__tee__api_8h.html#a586a43c1886aa09dc9541fb66e6d8d7fa4b7583ef234ccb0ef6f7492ee6e8200d">TEEC_ERROR_BAD_PARAMETERS</a>);</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">switch</span>(operation-&gt;<a class="code" href="struct____TEE__OperationHandle.html#a4750f19edd1529680f9899db1da0f445">algorithm</a>) {</div>
<div class="line">                <span class="keywordflow">case</span> <a class="code" href="otz__tee__crypto__api_8h.html#a3fb37fc937a1cbad38ddb0279a4cca2da5dab225b8f2cdd40df99dae5ea626bb6">TEE_ALG_AES_ECB_NOPAD</a>:</div>
<div class="line">                <span class="keywordflow">case</span> <a class="code" href="otz__tee__crypto__api_8h.html#a3fb37fc937a1cbad38ddb0279a4cca2dad867ef5cb95c1356c9d44776bb28223f">TEE_ALG_AES_CBC_NOPAD</a>:</div>
<div class="line">                <span class="keywordflow">case</span> <a class="code" href="otz__tee__crypto__api_8h.html#a3fb37fc937a1cbad38ddb0279a4cca2da5afe02f05c193704efd570cbe5b9ced4">TEE_ALG_AES_CTR</a>:</div>
<div class="line">                <span class="keywordflow">case</span> <a class="code" href="otz__tee__crypto__api_8h.html#a3fb37fc937a1cbad38ddb0279a4cca2da4e1c7084aac77abb91dd78c925075536">TEE_ALG_AES_XTS</a>:</div>
<div class="line">                <span class="keywordflow">case</span> <a class="code" href="otz__tee__crypto__api_8h.html#a3fb37fc937a1cbad38ddb0279a4cca2da3156c4c26d5e54d49584fc0ebfe62ab3">TEE_ALG_DES_ECB_NOPAD</a>:</div>
<div class="line">                <span class="keywordflow">case</span> <a class="code" href="otz__tee__crypto__api_8h.html#a3fb37fc937a1cbad38ddb0279a4cca2dadb3a1e256a421a7130497e532255d6e6">TEE_ALG_DES_CBC_NOPAD</a>:</div>
<div class="line">                <span class="keywordflow">case</span> <a class="code" href="otz__tee__crypto__api_8h.html#a3fb37fc937a1cbad38ddb0279a4cca2da60227b7220adee973f12313e48194364">TEE_ALG_DES3_ECB_NOPAD</a>:</div>
<div class="line">                <span class="keywordflow">case</span> <a class="code" href="otz__tee__crypto__api_8h.html#a3fb37fc937a1cbad38ddb0279a4cca2dade7021c7bc0a766adf8a04f58d3c92fc">TEE_ALG_DES3_CBC_NOPAD</a>:</div>
<div class="line">                        <span class="keywordflow">if</span>(operation-&gt;<a class="code" href="struct____TEE__OperationHandle.html#ad399557c4571d3b2e41d81632803ed70">mode</a> == <a class="code" href="otz__tee__crypto__api_8h.html#a883ffc5fb861ac33d91c7a8058d59744ae986e0ac521db4f424b1c1fae66778c9">TEE_MODE_ENCRYPT</a>) {</div>
<div class="line">                                <span class="keywordflow">if</span>(srcLen != 0) {</div>
<div class="line">                                        <span class="keywordflow">if</span>(!EVP_EncryptUpdate((EVP_CIPHER_CTX*)(operation-&gt;<a class="code" href="struct____TEE__OperationHandle.html#a49c6130723c77a4571daa08289f220e1">crypto_ctxt</a>),</div>
<div class="line">                                                destData,(<span class="keywordtype">int</span>*)destLen,srcData,srcLen)) {</div>
<div class="line">                                                <span class="keywordflow">return</span>(<a class="code" href="otz__tee__api_8h.html#a586a43c1886aa09dc9541fb66e6d8d7fae90c214f5f14bdcd9cfa2fffd5baa877">TEEC_ERROR_GENERIC</a>);</div>
<div class="line">                                        }</div>
<div class="line">                                }</div>
<div class="line">                                <span class="keywordflow">if</span>(!EVP_EncryptFinal_ex((EVP_CIPHER_CTX*)(operation-&gt;<a class="code" href="struct____TEE__OperationHandle.html#a49c6130723c77a4571daa08289f220e1">crypto_ctxt</a>),</div>
<div class="line">                                                destData,(<span class="keywordtype">int</span>*)destLen)) {</div>
<div class="line">                                        <span class="keywordflow">return</span>(<a class="code" href="otz__tee__api_8h.html#a586a43c1886aa09dc9541fb66e6d8d7fae90c214f5f14bdcd9cfa2fffd5baa877">TEEC_ERROR_GENERIC</a>);</div>
<div class="line">                                }</div>
<div class="line">                        } <span class="keywordflow">else</span> <span class="keywordflow">if</span>(operation-&gt;<a class="code" href="struct____TEE__OperationHandle.html#ad399557c4571d3b2e41d81632803ed70">mode</a> == <a class="code" href="otz__tee__crypto__api_8h.html#a883ffc5fb861ac33d91c7a8058d59744aa20104f46a28d0fe8596fec000b93fb0">TEE_MODE_DECRYPT</a>) {</div>
<div class="line">                                <span class="keywordflow">if</span>(srcLen != 0) {</div>
<div class="line">                                        <span class="keywordflow">if</span>(!EVP_DecryptUpdate((EVP_CIPHER_CTX*)(operation-&gt;<a class="code" href="struct____TEE__OperationHandle.html#a49c6130723c77a4571daa08289f220e1">crypto_ctxt</a>),</div>
<div class="line">                                        destData,(<span class="keywordtype">int</span>*)destLen,srcData,srcLen)) {</div>
<div class="line">                                                <span class="keywordflow">return</span>(<a class="code" href="otz__tee__api_8h.html#a586a43c1886aa09dc9541fb66e6d8d7fae90c214f5f14bdcd9cfa2fffd5baa877">TEEC_ERROR_GENERIC</a>);</div>
<div class="line">                                        }</div>
<div class="line">                                }</div>
<div class="line">                                <span class="keywordflow">if</span>(!EVP_DecryptFinal_ex((EVP_CIPHER_CTX*)(operation-&gt;<a class="code" href="struct____TEE__OperationHandle.html#a49c6130723c77a4571daa08289f220e1">crypto_ctxt</a>),                                                      destData,(<span class="keywordtype">int</span>*)destLen)) {</div>
<div class="line">                                        <span class="keywordflow">return</span>(<a class="code" href="otz__tee__api_8h.html#a586a43c1886aa09dc9541fb66e6d8d7fae90c214f5f14bdcd9cfa2fffd5baa877">TEEC_ERROR_GENERIC</a>);</div>
<div class="line">                                }</div>
<div class="line">                        }</div>
<div class="line">                        <span class="keywordflow">break</span>;</div>
<div class="line">                <span class="keywordflow">case</span> <a class="code" href="otz__tee__crypto__api_8h.html#a3fb37fc937a1cbad38ddb0279a4cca2da11b384ccb3cc9ed5a421332660096b17">TEE_ALG_AES_CTS</a>:</div>
<div class="line">                        <span class="keywordflow">if</span>(srcLen != 0) {</div>
<div class="line">                                <span class="keywordflow">if</span>(operation-&gt;<a class="code" href="struct____TEE__OperationHandle.html#ad399557c4571d3b2e41d81632803ed70">mode</a> == <a class="code" href="otz__tee__crypto__api_8h.html#a883ffc5fb861ac33d91c7a8058d59744ae986e0ac521db4f424b1c1fae66778c9">TEE_MODE_ENCRYPT</a>) {</div>
<div class="line">                                        CRYPTO_cts128_encrypt_block(srcData,destData,srcLen,</div>
<div class="line">                                        operation-&gt;<a class="code" href="struct____TEE__OperationHandle.html#a1143afc5ba92c02e9e3ee751c585cace">keyValue</a>,operation-&gt;<a class="code" href="struct____TEE__OperationHandle.html#a0e27f3ebfdc84833079bed928b5c4d1f">IV</a>,</div>
<div class="line">                                        (block128_f)AES_encrypt);</div>
<div class="line">                                } <span class="keywordflow">else</span> <span class="keywordflow">if</span>(operation-&gt;<a class="code" href="struct____TEE__OperationHandle.html#ad399557c4571d3b2e41d81632803ed70">mode</a> == <a class="code" href="otz__tee__crypto__api_8h.html#a883ffc5fb861ac33d91c7a8058d59744aa20104f46a28d0fe8596fec000b93fb0">TEE_MODE_DECRYPT</a>) {</div>
<div class="line">                                        CRYPTO_cts128_decrypt_block(srcData,destData,srcLen,</div>
<div class="line">                                        operation-&gt;<a class="code" href="struct____TEE__OperationHandle.html#a1143afc5ba92c02e9e3ee751c585cace">keyValue</a>,operation-&gt;<a class="code" href="struct____TEE__OperationHandle.html#a0e27f3ebfdc84833079bed928b5c4d1f">IV</a>,</div>
<div class="line">                                        (block128_f)AES_encrypt);</div>
<div class="line">                                }</div>
<div class="line">                                *destLen = srcLen;</div>
<div class="line">                        }</div>
<div class="line">                        <span class="keywordflow">break</span>;</div>
<div class="line">                <span class="keywordflow">default</span>:</div>
<div class="line">                        <span class="keywordflow">break</span>;</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">return</span>(<a class="code" href="otz__tee__api_8h.html#a586a43c1886aa09dc9541fb66e6d8d7fa4d19c2c024e37edc5f04892bb6739dbe">TEEC_SUCCESS</a>);</div>
<div class="line">}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a8dc0c802367d20abadb7ba57b5e19c48"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void TEE_CipherInit </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="otz__tee__crypto__api_8h.html#a003ccda0ce6a2d7889b2933a201e2bd1">TEE_OperationHandle</a>&#160;</td>
          <td class="paramname"><em>operation</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>IV</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="sw__common__types_8h.html#a7c94ea6f8948649f8d181ae55911eeaf">size_t</a>&#160;</td>
          <td class="paramname"><em>IVLen</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">operation</td><td></td></tr>
    <tr><td class="paramname">IV</td><td></td></tr>
    <tr><td class="paramname">IVLen</td><td></td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="otz__tee__crypto__api_8c_source.html#l01080">1080</a> of file <a class="el" href="otz__tee__crypto__api_8c_source.html">otz_tee_crypto_api.c</a>.</p>
<div class="fragment"><div class="line">{</div>
<div class="line">        <span class="keywordflow">if</span>(operation == <a class="code" href="sw__types_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) {</div>
<div class="line">                <span class="keywordflow">return</span>;</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">if</span>(operation-&gt;<a class="code" href="struct____TEE__OperationHandle.html#aabd85e41a59abec4e8ba16147636a982">operationClass</a> != <a class="code" href="otz__tee__crypto__api_8h.html#ad0c73c650876132dcd7cc6309bf8c2b9ae19349aa696718354ffa15b9401f553f">TEE_OPERATION_CIPHER</a>)  {</div>
<div class="line">                <a class="code" href="otz__tee__crypto__api_8h.html#a25a6ed042b2e933aeae3c26727987811">TEE_Panic</a>(<a class="code" href="otz__tee__api_8h.html#a586a43c1886aa09dc9541fb66e6d8d7fa4b7583ef234ccb0ef6f7492ee6e8200d">TEEC_ERROR_BAD_PARAMETERS</a>);</div>
<div class="line">                <span class="keywordflow">return</span>;</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">if</span>(operation-&gt;<a class="code" href="struct____TEE__OperationHandle.html#a1143afc5ba92c02e9e3ee751c585cace">keyValue</a> == <a class="code" href="sw__types_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) {</div>
<div class="line">                <a class="code" href="otz__tee__crypto__api_8h.html#a25a6ed042b2e933aeae3c26727987811">TEE_Panic</a>(<a class="code" href="otz__tee__api_8h.html#a586a43c1886aa09dc9541fb66e6d8d7fa4b7583ef234ccb0ef6f7492ee6e8200d">TEEC_ERROR_BAD_PARAMETERS</a>);</div>
<div class="line">                <span class="keywordflow">return</span>;</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">if</span>(operation-&gt;<a class="code" href="struct____TEE__OperationHandle.html#a4750f19edd1529680f9899db1da0f445">algorithm</a> == <a class="code" href="otz__tee__crypto__api_8h.html#a3fb37fc937a1cbad38ddb0279a4cca2da11b384ccb3cc9ed5a421332660096b17">TEE_ALG_AES_CTS</a>) {</div>
<div class="line">                <span class="keywordflow">if</span>((operation-&gt;<a class="code" href="struct____TEE__OperationHandle.html#a0e27f3ebfdc84833079bed928b5c4d1f">IV</a> = <a class="code" href="sw__buddy_8h.html#a66652368e6d05f18bdc4be02b0c62694">sw_malloc</a>(IVLen)) == <a class="code" href="sw__types_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) {</div>
<div class="line">                        <span class="keywordflow">return</span>;</div>
<div class="line">                }</div>
<div class="line">                <a class="code" href="libc__sos_8h.html#a6b3ecd2ddb1fd4d219b4839d0561d11b">memcpy</a>(operation-&gt;<a class="code" href="struct____TEE__OperationHandle.html#a0e27f3ebfdc84833079bed928b5c4d1f">IV</a>,IV,IVLen);</div>
<div class="line">                operation-&gt;<a class="code" href="struct____TEE__OperationHandle.html#ad397f2e6e26d547a5270b281bf2c0bdd">IVLen</a> = IVLen;</div>
<div class="line">                <span class="keywordflow">return</span>;</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">switch</span>(operation-&gt;<a class="code" href="struct____TEE__OperationHandle.html#a4750f19edd1529680f9899db1da0f445">algorithm</a>) {</div>
<div class="line">                <span class="keywordflow">case</span> <a class="code" href="otz__tee__crypto__api_8h.html#a3fb37fc937a1cbad38ddb0279a4cca2da5dab225b8f2cdd40df99dae5ea626bb6">TEE_ALG_AES_ECB_NOPAD</a>:</div>
<div class="line">                <span class="keywordflow">case</span> <a class="code" href="otz__tee__crypto__api_8h.html#a3fb37fc937a1cbad38ddb0279a4cca2dad867ef5cb95c1356c9d44776bb28223f">TEE_ALG_AES_CBC_NOPAD</a>:</div>
<div class="line">                <span class="keywordflow">case</span> <a class="code" href="otz__tee__crypto__api_8h.html#a3fb37fc937a1cbad38ddb0279a4cca2da5afe02f05c193704efd570cbe5b9ced4">TEE_ALG_AES_CTR</a>:</div>
<div class="line">                <span class="keywordflow">case</span> <a class="code" href="otz__tee__crypto__api_8h.html#a3fb37fc937a1cbad38ddb0279a4cca2da4e1c7084aac77abb91dd78c925075536">TEE_ALG_AES_XTS</a>:</div>
<div class="line">                <span class="keywordflow">case</span> <a class="code" href="otz__tee__crypto__api_8h.html#a3fb37fc937a1cbad38ddb0279a4cca2da3156c4c26d5e54d49584fc0ebfe62ab3">TEE_ALG_DES_ECB_NOPAD</a>:</div>
<div class="line">                <span class="keywordflow">case</span> <a class="code" href="otz__tee__crypto__api_8h.html#a3fb37fc937a1cbad38ddb0279a4cca2dadb3a1e256a421a7130497e532255d6e6">TEE_ALG_DES_CBC_NOPAD</a>:</div>
<div class="line">                <span class="keywordflow">case</span> <a class="code" href="otz__tee__crypto__api_8h.html#a3fb37fc937a1cbad38ddb0279a4cca2da60227b7220adee973f12313e48194364">TEE_ALG_DES3_ECB_NOPAD</a>:</div>
<div class="line">                <span class="keywordflow">case</span> <a class="code" href="otz__tee__crypto__api_8h.html#a3fb37fc937a1cbad38ddb0279a4cca2dade7021c7bc0a766adf8a04f58d3c92fc">TEE_ALG_DES3_CBC_NOPAD</a>:</div>
<div class="line">                        <span class="keywordflow">if</span>(operation-&gt;<a class="code" href="struct____TEE__OperationHandle.html#a4a8cf4911ff381adc90e66a0ea2d1066">crypto_cipher</a> == <a class="code" href="sw__types_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) {</div>
<div class="line">                                <span class="keywordflow">return</span>;</div>
<div class="line">                        }</div>
<div class="line">                        (operation-&gt;<a class="code" href="struct____TEE__OperationHandle.html#ad399557c4571d3b2e41d81632803ed70">mode</a> == <a class="code" href="otz__tee__crypto__api_8h.html#a883ffc5fb861ac33d91c7a8058d59744ae986e0ac521db4f424b1c1fae66778c9">TEE_MODE_ENCRYPT</a>) ?</div>
<div class="line">                                EVP_EncryptInit_ex((EVP_CIPHER_CTX*)(operation-&gt;<a class="code" href="struct____TEE__OperationHandle.html#a49c6130723c77a4571daa08289f220e1">crypto_ctxt</a>),</div>
<div class="line">                                (EVP_CIPHER*)(operation-&gt;<a class="code" href="struct____TEE__OperationHandle.html#a4a8cf4911ff381adc90e66a0ea2d1066">crypto_cipher</a>),</div>
<div class="line">                                <a class="code" href="sw__types_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>,operation-&gt;<a class="code" href="struct____TEE__OperationHandle.html#a1143afc5ba92c02e9e3ee751c585cace">keyValue</a>,IV) :</div>
<div class="line">                                EVP_DecryptInit_ex((EVP_CIPHER_CTX*)(operation-&gt;<a class="code" href="struct____TEE__OperationHandle.html#a49c6130723c77a4571daa08289f220e1">crypto_ctxt</a>),</div>
<div class="line">                                (EVP_CIPHER*)(operation-&gt;<a class="code" href="struct____TEE__OperationHandle.html#a4a8cf4911ff381adc90e66a0ea2d1066">crypto_cipher</a>),</div>
<div class="line">                                <a class="code" href="sw__types_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>,operation-&gt;<a class="code" href="struct____TEE__OperationHandle.html#a1143afc5ba92c02e9e3ee751c585cace">keyValue</a>,IV);</div>
<div class="line">                        EVP_CIPHER_CTX_set_padding((EVP_CIPHER_CTX*)(operation-&gt;<a class="code" href="struct____TEE__OperationHandle.html#a49c6130723c77a4571daa08289f220e1">crypto_ctxt</a>),0);</div>
<div class="line">                        <span class="keywordflow">break</span>;</div>
<div class="line">                <span class="keywordflow">default</span>:</div>
<div class="line">                        <span class="keywordflow">break</span>;</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a3dc1c2b0b51fbdb77245da5c1c7427bf"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="otz__tee__api_8h.html#a586a43c1886aa09dc9541fb66e6d8d7f">TEEC_Result</a> TEE_CipherUpdate </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="otz__tee__crypto__api_8h.html#a003ccda0ce6a2d7889b2933a201e2bd1">TEE_OperationHandle</a>&#160;</td>
          <td class="paramname"><em>operation</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>srcData</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="sw__common__types_8h.html#a7c94ea6f8948649f8d181ae55911eeaf">size_t</a>&#160;</td>
          <td class="paramname"><em>srcLen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>destData</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="sw__common__types_8h.html#a7c94ea6f8948649f8d181ae55911eeaf">size_t</a> *&#160;</td>
          <td class="paramname"><em>destLen</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">operation</td><td></td></tr>
    <tr><td class="paramname">srcData</td><td></td></tr>
    <tr><td class="paramname">srcLen</td><td></td></tr>
    <tr><td class="paramname">destData</td><td></td></tr>
    <tr><td class="paramname">destLen</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd></dd></dl>

<p>Definition at line <a class="el" href="otz__tee__crypto__api_8c_source.html#l01140">1140</a> of file <a class="el" href="otz__tee__crypto__api_8c_source.html">otz_tee_crypto_api.c</a>.</p>
<div class="fragment"><div class="line">{</div>
<div class="line">        <a class="code" href="sw__types_8h.html#aed742c436da53c1080638ce6ef7d13de">u8</a> retVal = 0;</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span>(operation == <a class="code" href="sw__types_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) {</div>
<div class="line">                <span class="keywordflow">return</span>(<a class="code" href="otz__tee__api_8h.html#a586a43c1886aa09dc9541fb66e6d8d7fa4b7583ef234ccb0ef6f7492ee6e8200d">TEEC_ERROR_BAD_PARAMETERS</a>);</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">if</span>(operation-&gt;<a class="code" href="struct____TEE__OperationHandle.html#aabd85e41a59abec4e8ba16147636a982">operationClass</a> != <a class="code" href="otz__tee__crypto__api_8h.html#ad0c73c650876132dcd7cc6309bf8c2b9ae19349aa696718354ffa15b9401f553f">TEE_OPERATION_CIPHER</a>) {</div>
<div class="line">                <a class="code" href="otz__tee__crypto__api_8h.html#a25a6ed042b2e933aeae3c26727987811">TEE_Panic</a>(<a class="code" href="otz__tee__api_8h.html#a586a43c1886aa09dc9541fb66e6d8d7fa4b7583ef234ccb0ef6f7492ee6e8200d">TEEC_ERROR_BAD_PARAMETERS</a>);</div>
<div class="line">                <span class="keywordflow">return</span>(<a class="code" href="otz__tee__api_8h.html#a586a43c1886aa09dc9541fb66e6d8d7fa4b7583ef234ccb0ef6f7492ee6e8200d">TEEC_ERROR_BAD_PARAMETERS</a>);</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">switch</span>(operation-&gt;<a class="code" href="struct____TEE__OperationHandle.html#a4750f19edd1529680f9899db1da0f445">algorithm</a>) {</div>
<div class="line">                <span class="keywordflow">case</span> <a class="code" href="otz__tee__crypto__api_8h.html#a3fb37fc937a1cbad38ddb0279a4cca2da5dab225b8f2cdd40df99dae5ea626bb6">TEE_ALG_AES_ECB_NOPAD</a>:</div>
<div class="line">                <span class="keywordflow">case</span> <a class="code" href="otz__tee__crypto__api_8h.html#a3fb37fc937a1cbad38ddb0279a4cca2dad867ef5cb95c1356c9d44776bb28223f">TEE_ALG_AES_CBC_NOPAD</a>:</div>
<div class="line">                <span class="keywordflow">case</span> <a class="code" href="otz__tee__crypto__api_8h.html#a3fb37fc937a1cbad38ddb0279a4cca2da5afe02f05c193704efd570cbe5b9ced4">TEE_ALG_AES_CTR</a>:</div>
<div class="line">                <span class="keywordflow">case</span> <a class="code" href="otz__tee__crypto__api_8h.html#a3fb37fc937a1cbad38ddb0279a4cca2da4e1c7084aac77abb91dd78c925075536">TEE_ALG_AES_XTS</a>:</div>
<div class="line">                <span class="keywordflow">case</span> <a class="code" href="otz__tee__crypto__api_8h.html#a3fb37fc937a1cbad38ddb0279a4cca2da3156c4c26d5e54d49584fc0ebfe62ab3">TEE_ALG_DES_ECB_NOPAD</a>:</div>
<div class="line">                <span class="keywordflow">case</span> <a class="code" href="otz__tee__crypto__api_8h.html#a3fb37fc937a1cbad38ddb0279a4cca2dadb3a1e256a421a7130497e532255d6e6">TEE_ALG_DES_CBC_NOPAD</a>:</div>
<div class="line">                <span class="keywordflow">case</span> <a class="code" href="otz__tee__crypto__api_8h.html#a3fb37fc937a1cbad38ddb0279a4cca2da60227b7220adee973f12313e48194364">TEE_ALG_DES3_ECB_NOPAD</a>:</div>
<div class="line">                <span class="keywordflow">case</span> <a class="code" href="otz__tee__crypto__api_8h.html#a3fb37fc937a1cbad38ddb0279a4cca2dade7021c7bc0a766adf8a04f58d3c92fc">TEE_ALG_DES3_CBC_NOPAD</a>:</div>
<div class="line">                        retVal = ((operation-&gt;<a class="code" href="struct____TEE__OperationHandle.html#ad399557c4571d3b2e41d81632803ed70">mode</a> == <a class="code" href="otz__tee__crypto__api_8h.html#a883ffc5fb861ac33d91c7a8058d59744ae986e0ac521db4f424b1c1fae66778c9">TEE_MODE_ENCRYPT</a>) ?</div>
<div class="line">                        EVP_EncryptUpdate((EVP_CIPHER_CTX*)(operation-&gt;<a class="code" href="struct____TEE__OperationHandle.html#a49c6130723c77a4571daa08289f220e1">crypto_ctxt</a>),</div>
<div class="line">                        destData,(<span class="keywordtype">int</span>*)destLen,srcData,srcLen):</div>
<div class="line">                        EVP_DecryptUpdate((EVP_CIPHER_CTX*)(operation-&gt;<a class="code" href="struct____TEE__OperationHandle.html#a49c6130723c77a4571daa08289f220e1">crypto_ctxt</a>),</div>
<div class="line">                        destData,(<span class="keywordtype">int</span>*)destLen,srcData,srcLen));</div>
<div class="line">                        <span class="keywordflow">if</span>(!retVal) {</div>
<div class="line">                                <span class="keywordflow">return</span>(<a class="code" href="otz__tee__api_8h.html#a586a43c1886aa09dc9541fb66e6d8d7fae90c214f5f14bdcd9cfa2fffd5baa877">TEEC_ERROR_GENERIC</a>);</div>
<div class="line">                        }</div>
<div class="line">                        <span class="keywordflow">break</span>;</div>
<div class="line">                <span class="keywordflow">case</span> <a class="code" href="otz__tee__crypto__api_8h.html#a3fb37fc937a1cbad38ddb0279a4cca2da11b384ccb3cc9ed5a421332660096b17">TEE_ALG_AES_CTS</a>:</div>
<div class="line">                        (operation-&gt;<a class="code" href="struct____TEE__OperationHandle.html#ad399557c4571d3b2e41d81632803ed70">mode</a> == <a class="code" href="otz__tee__crypto__api_8h.html#a883ffc5fb861ac33d91c7a8058d59744ae986e0ac521db4f424b1c1fae66778c9">TEE_MODE_ENCRYPT</a>) ?</div>
<div class="line">                        CRYPTO_cts128_encrypt_block(srcData,destData,srcLen,</div>
<div class="line">                        operation-&gt;<a class="code" href="struct____TEE__OperationHandle.html#a1143afc5ba92c02e9e3ee751c585cace">keyValue</a>,operation-&gt;<a class="code" href="struct____TEE__OperationHandle.html#a0e27f3ebfdc84833079bed928b5c4d1f">IV</a>,</div>
<div class="line">                        (block128_f)AES_encrypt):</div>
<div class="line">                        CRYPTO_cts128_decrypt_block(srcData,destData,srcLen,</div>
<div class="line">                        operation-&gt;<a class="code" href="struct____TEE__OperationHandle.html#a1143afc5ba92c02e9e3ee751c585cace">keyValue</a>,operation-&gt;<a class="code" href="struct____TEE__OperationHandle.html#a0e27f3ebfdc84833079bed928b5c4d1f">IV</a>,</div>
<div class="line">                        (block128_f)AES_encrypt);</div>
<div class="line">                        *destLen = srcLen;</div>
<div class="line">                <span class="keywordflow">break</span>;</div>
<div class="line">                <span class="keywordflow">default</span>:</div>
<div class="line">                        <span class="keywordflow">break</span>;</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">return</span>(<a class="code" href="otz__tee__api_8h.html#a586a43c1886aa09dc9541fb66e6d8d7fa4d19c2c024e37edc5f04892bb6739dbe">TEEC_SUCCESS</a>);</div>
<div class="line">}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a4eca2209820659cc95756fc85e1a4837"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void TEE_CopyOperation </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="otz__tee__crypto__api_8h.html#a003ccda0ce6a2d7889b2933a201e2bd1">TEE_OperationHandle</a>&#160;</td>
          <td class="paramname"><em>dstOperation</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="otz__tee__crypto__api_8h.html#a003ccda0ce6a2d7889b2933a201e2bd1">TEE_OperationHandle</a>&#160;</td>
          <td class="paramname"><em>srcOperation</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">dstOperation</td><td></td></tr>
    <tr><td class="paramname">srcOperation</td><td></td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="otz__tee__crypto__api_8c_source.html#l00881">881</a> of file <a class="el" href="otz__tee__crypto__api_8c_source.html">otz_tee_crypto_api.c</a>.</p>
<div class="fragment"><div class="line">{</div>
<div class="line">        <span class="keywordflow">if</span>((dstOperation == <a class="code" href="sw__types_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) || (srcOperation == <a class="code" href="sw__types_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)) {</div>
<div class="line">                <a class="code" href="otz__tee__crypto__api_8h.html#a25a6ed042b2e933aeae3c26727987811">TEE_Panic</a>(<a class="code" href="otz__tee__api_8h.html#a586a43c1886aa09dc9541fb66e6d8d7fa4b7583ef234ccb0ef6f7492ee6e8200d">TEEC_ERROR_BAD_PARAMETERS</a>);</div>
<div class="line">                <span class="keywordflow">return</span>;</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">if</span>((dstOperation-&gt;<a class="code" href="struct____TEE__OperationHandle.html#ad399557c4571d3b2e41d81632803ed70">mode</a> != srcOperation-&gt;<a class="code" href="struct____TEE__OperationHandle.html#ad399557c4571d3b2e41d81632803ed70">mode</a>) ||</div>
<div class="line">                (dstOperation-&gt;<a class="code" href="struct____TEE__OperationHandle.html#a4750f19edd1529680f9899db1da0f445">algorithm</a> != srcOperation-&gt;<a class="code" href="struct____TEE__OperationHandle.html#a4750f19edd1529680f9899db1da0f445">algorithm</a>)) {</div>
<div class="line">                <a class="code" href="otz__tee__crypto__api_8h.html#a25a6ed042b2e933aeae3c26727987811">TEE_Panic</a>(<a class="code" href="otz__tee__api_8h.html#a586a43c1886aa09dc9541fb66e6d8d7fa4b7583ef234ccb0ef6f7492ee6e8200d">TEEC_ERROR_BAD_PARAMETERS</a>);</div>
<div class="line">                <span class="keywordflow">return</span>;</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">if</span>((srcOperation-&gt;<a class="code" href="struct____TEE__OperationHandle.html#a1143afc5ba92c02e9e3ee751c585cace">keyValue</a> != <a class="code" href="sw__types_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) &amp;&amp;</div>
<div class="line">                (srcOperation-&gt;<a class="code" href="struct____TEE__OperationHandle.html#ae445a64709be52b51708acbf247f2210">keySize</a> &gt; dstOperation-&gt;<a class="code" href="struct____TEE__OperationHandle.html#ae445a64709be52b51708acbf247f2210">keySize</a>)) {</div>
<div class="line">                <a class="code" href="otz__tee__crypto__api_8h.html#a25a6ed042b2e933aeae3c26727987811">TEE_Panic</a>(<a class="code" href="otz__tee__api_8h.html#a586a43c1886aa09dc9541fb66e6d8d7fa4b7583ef234ccb0ef6f7492ee6e8200d">TEEC_ERROR_BAD_PARAMETERS</a>);</div>
<div class="line">                <span class="keywordflow">return</span>;</div>
<div class="line">        }</div>
<div class="line">        <a class="code" href="sw__mem__functions_8h.html#a51ad02aba462d7be9a03231afa56de27" title="This version of memcpy assumes disjoint ptrs src, dst.">sw_memcpy</a>(dstOperation,srcOperation,<span class="keyword">sizeof</span>(srcOperation));</div>
<div class="line">        <a class="code" href="sw__mem__functions_8h.html#a51ad02aba462d7be9a03231afa56de27" title="This version of memcpy assumes disjoint ptrs src, dst.">sw_memcpy</a>(dstOperation-&gt;<a class="code" href="struct____TEE__OperationHandle.html#a49c6130723c77a4571daa08289f220e1">crypto_ctxt</a>,srcOperation-&gt;<a class="code" href="struct____TEE__OperationHandle.html#a49c6130723c77a4571daa08289f220e1">crypto_ctxt</a>,</div>
<div class="line">                <span class="keyword">sizeof</span>(srcOperation-&gt;<a class="code" href="struct____TEE__OperationHandle.html#a49c6130723c77a4571daa08289f220e1">crypto_ctxt</a>));</div>
<div class="line">        <span class="keywordflow">if</span>(srcOperation-&gt;<a class="code" href="struct____TEE__OperationHandle.html#a1143afc5ba92c02e9e3ee751c585cace">keyValue</a> != <a class="code" href="sw__types_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) {</div>
<div class="line">                <span class="keywordflow">if</span>(srcOperation-&gt;<a class="code" href="struct____TEE__OperationHandle.html#ae445a64709be52b51708acbf247f2210">keySize</a> &gt; dstOperation-&gt;<a class="code" href="struct____TEE__OperationHandle.html#ae445a64709be52b51708acbf247f2210">keySize</a>) {</div>
<div class="line">                        <a class="code" href="otz__tee__crypto__api_8h.html#a25a6ed042b2e933aeae3c26727987811">TEE_Panic</a>(<a class="code" href="otz__tee__api_8h.html#a586a43c1886aa09dc9541fb66e6d8d7fa4b7583ef234ccb0ef6f7492ee6e8200d">TEEC_ERROR_BAD_PARAMETERS</a>);</div>
<div class="line">                        <span class="keywordflow">return</span>;</div>
<div class="line">                }</div>
<div class="line">                <a class="code" href="sw__mem__functions_8h.html#a51ad02aba462d7be9a03231afa56de27" title="This version of memcpy assumes disjoint ptrs src, dst.">sw_memcpy</a>(dstOperation-&gt;<a class="code" href="struct____TEE__OperationHandle.html#a1143afc5ba92c02e9e3ee751c585cace">keyValue</a>,srcOperation-&gt;<a class="code" href="struct____TEE__OperationHandle.html#a1143afc5ba92c02e9e3ee751c585cace">keyValue</a>,</div>
<div class="line">                <span class="keyword">sizeof</span>(srcOperation-&gt;<a class="code" href="struct____TEE__OperationHandle.html#ae445a64709be52b51708acbf247f2210">keySize</a>));</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ace442eb7a1bc39ea5ae191ee64277e7a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void TEE_DeriveKey </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="otz__tee__crypto__api_8h.html#a003ccda0ce6a2d7889b2933a201e2bd1">TEE_OperationHandle</a>&#160;</td>
          <td class="paramname"><em>operation</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structTEE__Attribute.html">TEE_Attribute</a> *&#160;</td>
          <td class="paramname"><em>params</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="otz__api_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a>&#160;</td>
          <td class="paramname"><em>paramCount</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="otz__api_8h.html#a6a2cfeba38a0f61d5937bcc8cf04b9a2">TEE_ObjectHandle</a> *&#160;</td>
          <td class="paramname"><em>derivedKey</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">operation</td><td></td></tr>
    <tr><td class="paramname">params</td><td></td></tr>
    <tr><td class="paramname">paramCount</td><td></td></tr>
    <tr><td class="paramname">derivedKey</td><td></td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="otz__tee__crypto__api_8c_source.html#l01930">1930</a> of file <a class="el" href="otz__tee__crypto__api_8c_source.html">otz_tee_crypto_api.c</a>.</p>
<div class="fragment"><div class="line">{</div>
<div class="line">        <span class="keywordflow">if</span>(operation == <a class="code" href="sw__types_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) {</div>
<div class="line">                <span class="keywordflow">return</span>;</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">if</span>(operation-&gt;<a class="code" href="struct____TEE__OperationHandle.html#aabd85e41a59abec4e8ba16147636a982">operationClass</a> != <a class="code" href="otz__tee__crypto__api_8h.html#ad0c73c650876132dcd7cc6309bf8c2b9aec6ff5e5db5b23f11088b2371d7f1692">TEE_OPERATION_KEY_DERIVATION</a>) {</div>
<div class="line">                <a class="code" href="otz__tee__crypto__api_8h.html#a25a6ed042b2e933aeae3c26727987811">TEE_Panic</a>(<a class="code" href="otz__tee__api_8h.html#a586a43c1886aa09dc9541fb66e6d8d7fa4b7583ef234ccb0ef6f7492ee6e8200d">TEEC_ERROR_BAD_PARAMETERS</a>);</div>
<div class="line">                <span class="keywordflow">return</span>;</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">if</span>(operation-&gt;<a class="code" href="struct____TEE__OperationHandle.html#a4750f19edd1529680f9899db1da0f445">algorithm</a> != <a class="code" href="otz__tee__crypto__api_8h.html#a3fb37fc937a1cbad38ddb0279a4cca2da42e5d2bd6496f3a8b8b24fa4ff7634e6">TEE_ALG_DH_DERIVE_SHARED_SECRET</a>) {</div>
<div class="line">                <span class="keywordflow">return</span>;</div>
<div class="line">        }</div>
<div class="line">}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a2606085c2cc975381297ca2dd3c2ec16"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="otz__tee__api_8h.html#a586a43c1886aa09dc9541fb66e6d8d7f">TEEC_Result</a> TEE_DigestDoFinal </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="otz__tee__crypto__api_8h.html#a003ccda0ce6a2d7889b2933a201e2bd1">TEE_OperationHandle</a>&#160;</td>
          <td class="paramname"><em>operation</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>chunk</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="sw__common__types_8h.html#a7c94ea6f8948649f8d181ae55911eeaf">size_t</a>&#160;</td>
          <td class="paramname"><em>chunkLen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>hash</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="sw__common__types_8h.html#a7c94ea6f8948649f8d181ae55911eeaf">size_t</a> *&#160;</td>
          <td class="paramname"><em>hashLen</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">operation</td><td></td></tr>
    <tr><td class="paramname">chunk</td><td></td></tr>
    <tr><td class="paramname">chunkLen</td><td></td></tr>
    <tr><td class="paramname">hash</td><td></td></tr>
    <tr><td class="paramname">hashLen</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd></dd></dl>

<p>Definition at line <a class="el" href="otz__tee__crypto__api_8c_source.html#l00985">985</a> of file <a class="el" href="otz__tee__crypto__api_8c_source.html">otz_tee_crypto_api.c</a>.</p>
<div class="fragment"><div class="line">{</div>
<div class="line">        <span class="keywordflow">if</span>((operation == <a class="code" href="sw__types_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) || (hash == <a class="code" href="sw__types_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)) {</div>
<div class="line">                <span class="keywordflow">return</span>(<a class="code" href="otz__tee__api_8h.html#a586a43c1886aa09dc9541fb66e6d8d7fa4b7583ef234ccb0ef6f7492ee6e8200d">TEEC_ERROR_BAD_PARAMETERS</a>);</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">if</span>(operation-&gt;<a class="code" href="struct____TEE__OperationHandle.html#aabd85e41a59abec4e8ba16147636a982">operationClass</a> != <a class="code" href="otz__tee__crypto__api_8h.html#ad0c73c650876132dcd7cc6309bf8c2b9a8291e2f74dfb25cda0c443241efb5b83">TEE_OPERATION_DIGEST</a>) {</div>
<div class="line">                <a class="code" href="otz__tee__crypto__api_8h.html#a25a6ed042b2e933aeae3c26727987811">TEE_Panic</a>(<a class="code" href="otz__tee__api_8h.html#a586a43c1886aa09dc9541fb66e6d8d7fa4b7583ef234ccb0ef6f7492ee6e8200d">TEEC_ERROR_BAD_PARAMETERS</a>);</div>
<div class="line">                <span class="keywordflow">return</span>(<a class="code" href="otz__tee__api_8h.html#a586a43c1886aa09dc9541fb66e6d8d7fa4b7583ef234ccb0ef6f7492ee6e8200d">TEEC_ERROR_BAD_PARAMETERS</a>);</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">switch</span>(operation-&gt;<a class="code" href="struct____TEE__OperationHandle.html#a4750f19edd1529680f9899db1da0f445">algorithm</a>) {</div>
<div class="line">                <span class="keywordflow">case</span> <a class="code" href="otz__tee__crypto__api_8h.html#a3fb37fc937a1cbad38ddb0279a4cca2dad7f9d26f078dae9356daf736e469a651">TEE_ALG_MD5</a>:</div>
<div class="line">                        <span class="keywordflow">if</span>(*hashLen &lt; MD5_DIGEST_LENGTH) {</div>
<div class="line">                                <span class="keywordflow">return</span>(<a class="code" href="otz__tee__api_8h.html#a586a43c1886aa09dc9541fb66e6d8d7fac72ab519c77b51a03a6ceb17d656fcc1">TEEC_ERROR_SHORT_BUFFER</a>);</div>
<div class="line">                        }</div>
<div class="line">                        <span class="comment">/*if(!MD5_Init((MD5_CTX*)(operation-&gt;crypto_ctxt))) {</span></div>
<div class="line"><span class="comment">                                return(TEEC_ERROR_GENERIC);</span></div>
<div class="line"><span class="comment">                        }*/</span></div>
<div class="line">                        <span class="keywordflow">if</span>(chunkLen != 0) {</div>
<div class="line">                                MD5_Update((MD5_CTX*)(operation-&gt;<a class="code" href="struct____TEE__OperationHandle.html#a49c6130723c77a4571daa08289f220e1">crypto_ctxt</a>),chunk,chunkLen);</div>
<div class="line">                        }</div>
<div class="line">                        <span class="keyword">static</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> md5_output[MD5_DIGEST_LENGTH];</div>
<div class="line">                        MD5_Final(md5_output,(MD5_CTX*)(operation-&gt;<a class="code" href="struct____TEE__OperationHandle.html#a49c6130723c77a4571daa08289f220e1">crypto_ctxt</a>));</div>
<div class="line">                        <a class="code" href="sw__mem__functions_8h.html#a51ad02aba462d7be9a03231afa56de27" title="This version of memcpy assumes disjoint ptrs src, dst.">sw_memcpy</a>(hash,md5_output,MD5_DIGEST_LENGTH);</div>
<div class="line">                        *hashLen = MD5_DIGEST_LENGTH;</div>
<div class="line">                        <span class="keywordflow">break</span>;</div>
<div class="line">                <span class="keywordflow">case</span> <a class="code" href="otz__tee__crypto__api_8h.html#a3fb37fc937a1cbad38ddb0279a4cca2da5046f27a1e92f6b237f11f166f07b56d">TEE_ALG_SHA1</a>:</div>
<div class="line">                        <span class="keywordflow">if</span>(*hashLen &lt; SHA_DIGEST_LENGTH) {</div>
<div class="line">                                <span class="keywordflow">return</span>(<a class="code" href="otz__tee__api_8h.html#a586a43c1886aa09dc9541fb66e6d8d7fac72ab519c77b51a03a6ceb17d656fcc1">TEEC_ERROR_SHORT_BUFFER</a>);</div>
<div class="line">                        }</div>
<div class="line">                        <span class="comment">/*if(!SHA_Init((SHA_CTX*)(operation-&gt;crypto_ctxt))) {</span></div>
<div class="line"><span class="comment">                                return(TEEC_ERROR_GENERIC);</span></div>
<div class="line"><span class="comment">                        }*/</span></div>
<div class="line">                        <span class="keywordflow">if</span>(chunkLen != 0) {</div>
<div class="line">                                SHA_Update((SHA_CTX*)(operation-&gt;<a class="code" href="struct____TEE__OperationHandle.html#a49c6130723c77a4571daa08289f220e1">crypto_ctxt</a>),chunk,chunkLen);</div>
<div class="line">                        }</div>
<div class="line">                        <span class="keyword">static</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> sha1_output[SHA_DIGEST_LENGTH];</div>
<div class="line">                        SHA_Final(sha1_output,(SHA_CTX*)(operation-&gt;<a class="code" href="struct____TEE__OperationHandle.html#a49c6130723c77a4571daa08289f220e1">crypto_ctxt</a>));</div>
<div class="line">                        <a class="code" href="sw__mem__functions_8h.html#a51ad02aba462d7be9a03231afa56de27" title="This version of memcpy assumes disjoint ptrs src, dst.">sw_memcpy</a>(hash,sha1_output,SHA_DIGEST_LENGTH);</div>
<div class="line">                        *hashLen = SHA_DIGEST_LENGTH;</div>
<div class="line">                        <span class="keywordflow">break</span>;</div>
<div class="line">                <span class="keywordflow">case</span> <a class="code" href="otz__tee__crypto__api_8h.html#a3fb37fc937a1cbad38ddb0279a4cca2da8bf2921099c8ea45b4d6e6b4c739581b">TEE_ALG_SHA224</a>:</div>
<div class="line">                <span class="keywordflow">case</span> <a class="code" href="otz__tee__crypto__api_8h.html#a3fb37fc937a1cbad38ddb0279a4cca2da4d5569f60d52177f34c0437a9c0a944d">TEE_ALG_SHA256</a>:</div>
<div class="line">                        <span class="keywordflow">if</span>(*hashLen &lt; SHA_DIGEST_LENGTH) {</div>
<div class="line">                                <span class="keywordflow">return</span>(<a class="code" href="otz__tee__api_8h.html#a586a43c1886aa09dc9541fb66e6d8d7fac72ab519c77b51a03a6ceb17d656fcc1">TEEC_ERROR_SHORT_BUFFER</a>);</div>
<div class="line">                        }</div>
<div class="line">                        <span class="comment">/*if(!SHA_Init((SHA_CTX*)(operation-&gt;crypto_ctxt))) {</span></div>
<div class="line"><span class="comment">                                return(TEEC_ERROR_GENERIC);</span></div>
<div class="line"><span class="comment">                        }*/</span></div>
<div class="line">                        <span class="keywordflow">if</span>(chunkLen != 0) {</div>
<div class="line">                                SHA256_Update((SHA256_CTX*)(operation-&gt;<a class="code" href="struct____TEE__OperationHandle.html#a49c6130723c77a4571daa08289f220e1">crypto_ctxt</a>),chunk,chunkLen);</div>
<div class="line">                        }</div>
<div class="line">                        <span class="keyword">static</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> sha256_output[SHA256_DIGEST_LENGTH];</div>
<div class="line">                        SHA256_Final(sha256_output,(SHA256_CTX*)(operation-&gt;<a class="code" href="struct____TEE__OperationHandle.html#a49c6130723c77a4571daa08289f220e1">crypto_ctxt</a>));</div>
<div class="line">                        <span class="keywordflow">if</span>(operation-&gt;<a class="code" href="struct____TEE__OperationHandle.html#a4750f19edd1529680f9899db1da0f445">algorithm</a> == <a class="code" href="otz__tee__crypto__api_8h.html#a3fb37fc937a1cbad38ddb0279a4cca2da8bf2921099c8ea45b4d6e6b4c739581b">TEE_ALG_SHA224</a>) {</div>
<div class="line">                                *hashLen = SHA224_DIGEST_LENGTH;</div>
<div class="line">                        } <span class="keywordflow">else</span> {</div>
<div class="line">                                *hashLen = SHA256_DIGEST_LENGTH;</div>
<div class="line">                        }</div>
<div class="line">                        <a class="code" href="sw__mem__functions_8h.html#a51ad02aba462d7be9a03231afa56de27" title="This version of memcpy assumes disjoint ptrs src, dst.">sw_memcpy</a>(hash,sha256_output,*hashLen);</div>
<div class="line">                        <span class="keywordflow">break</span>;</div>
<div class="line">                <span class="keywordflow">case</span> <a class="code" href="otz__tee__crypto__api_8h.html#a3fb37fc937a1cbad38ddb0279a4cca2da4c3d97a637bdffc9416b233e8c5d96de">TEE_ALG_SHA384</a>:</div>
<div class="line">                <span class="keywordflow">case</span> <a class="code" href="otz__tee__crypto__api_8h.html#a3fb37fc937a1cbad38ddb0279a4cca2da8a49f2bbc5ea5ec3a1c56dacbffe7728">TEE_ALG_SHA512</a>:</div>
<div class="line">                        <span class="keywordflow">if</span>(*hashLen &lt; SHA_DIGEST_LENGTH) {</div>
<div class="line">                                <span class="keywordflow">return</span>(<a class="code" href="otz__tee__api_8h.html#a586a43c1886aa09dc9541fb66e6d8d7fac72ab519c77b51a03a6ceb17d656fcc1">TEEC_ERROR_SHORT_BUFFER</a>);</div>
<div class="line">                        }</div>
<div class="line">                        <span class="comment">/*if(!SHA_Init((SHA_CTX*)(operation-&gt;crypto_ctxt))) {</span></div>
<div class="line"><span class="comment">                                return(TEEC_ERROR_GENERIC);</span></div>
<div class="line"><span class="comment">                        }*/</span></div>
<div class="line">                        <span class="keywordflow">if</span>(chunkLen != 0) {</div>
<div class="line">                                SHA512_Update((SHA512_CTX*)(operation-&gt;<a class="code" href="struct____TEE__OperationHandle.html#a49c6130723c77a4571daa08289f220e1">crypto_ctxt</a>),chunk,chunkLen);</div>
<div class="line">                        }</div>
<div class="line">                        <span class="keyword">static</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> sha512_output[SHA512_DIGEST_LENGTH];</div>
<div class="line">                        SHA512_Final(sha512_output,(SHA512_CTX*)(operation-&gt;<a class="code" href="struct____TEE__OperationHandle.html#a49c6130723c77a4571daa08289f220e1">crypto_ctxt</a>));</div>
<div class="line">                        <span class="keywordflow">if</span>(operation-&gt;<a class="code" href="struct____TEE__OperationHandle.html#a4750f19edd1529680f9899db1da0f445">algorithm</a> == <a class="code" href="otz__tee__crypto__api_8h.html#a3fb37fc937a1cbad38ddb0279a4cca2da4c3d97a637bdffc9416b233e8c5d96de">TEE_ALG_SHA384</a>) {</div>
<div class="line">                                *hashLen = SHA384_DIGEST_LENGTH;</div>
<div class="line">                        } <span class="keywordflow">else</span> {</div>
<div class="line">                                *hashLen = SHA512_DIGEST_LENGTH;</div>
<div class="line">                        }</div>
<div class="line">                        <a class="code" href="sw__mem__functions_8h.html#a51ad02aba462d7be9a03231afa56de27" title="This version of memcpy assumes disjoint ptrs src, dst.">sw_memcpy</a>(hash,sha512_output,*hashLen);</div>
<div class="line">                        <span class="keywordflow">break</span>;</div>
<div class="line">                <span class="keywordflow">default</span>:</div>
<div class="line">                        <span class="keywordflow">break</span>;</div>
<div class="line">        }</div>
<div class="line">                <span class="keywordflow">return</span>(<a class="code" href="otz__tee__api_8h.html#a586a43c1886aa09dc9541fb66e6d8d7fa4d19c2c024e37edc5f04892bb6739dbe">TEEC_SUCCESS</a>);</div>
<div class="line">}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ad6b3d0ae75709a3f4de26a7f6a1f9d33"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void TEE_DigestUpdate </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="otz__tee__crypto__api_8h.html#a003ccda0ce6a2d7889b2933a201e2bd1">TEE_OperationHandle</a>&#160;</td>
          <td class="paramname"><em>operation</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>chunk</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="sw__common__types_8h.html#a7c94ea6f8948649f8d181ae55911eeaf">size_t</a>&#160;</td>
          <td class="paramname"><em>chunkSize</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">operation</td><td></td></tr>
    <tr><td class="paramname">chunk</td><td></td></tr>
    <tr><td class="paramname">chunkSize</td><td></td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="otz__tee__crypto__api_8c_source.html#l00920">920</a> of file <a class="el" href="otz__tee__crypto__api_8c_source.html">otz_tee_crypto_api.c</a>.</p>
<div class="fragment"><div class="line">{</div>
<div class="line">        <span class="keywordflow">if</span>(operation == <a class="code" href="sw__types_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) {</div>
<div class="line">                <span class="keywordflow">return</span>;</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">if</span>(operation-&gt;<a class="code" href="struct____TEE__OperationHandle.html#aabd85e41a59abec4e8ba16147636a982">operationClass</a> != <a class="code" href="otz__tee__crypto__api_8h.html#ad0c73c650876132dcd7cc6309bf8c2b9a8291e2f74dfb25cda0c443241efb5b83">TEE_OPERATION_DIGEST</a>) {</div>
<div class="line">                <a class="code" href="otz__tee__crypto__api_8h.html#a25a6ed042b2e933aeae3c26727987811">TEE_Panic</a>(<a class="code" href="otz__tee__api_8h.html#a586a43c1886aa09dc9541fb66e6d8d7fa4b7583ef234ccb0ef6f7492ee6e8200d">TEEC_ERROR_BAD_PARAMETERS</a>);</div>
<div class="line">                <span class="keywordflow">return</span>;</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">if</span>(operation-&gt;<a class="code" href="struct____TEE__OperationHandle.html#a4750f19edd1529680f9899db1da0f445">algorithm</a> == <a class="code" href="otz__tee__crypto__api_8h.html#a3fb37fc937a1cbad38ddb0279a4cca2dad7f9d26f078dae9356daf736e469a651">TEE_ALG_MD5</a>) {</div>
<div class="line">                <span class="comment">/*if(!MD5_Init((MD5_CTX*)(operation-&gt;crypto_ctxt))) {</span></div>
<div class="line"><span class="comment">                        return;</span></div>
<div class="line"><span class="comment">                }*/</span></div>
<div class="line">                MD5_Update((MD5_CTX*)(operation-&gt;<a class="code" href="struct____TEE__OperationHandle.html#a49c6130723c77a4571daa08289f220e1">crypto_ctxt</a>),chunk,chunkSize);</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">if</span>(operation-&gt;<a class="code" href="struct____TEE__OperationHandle.html#a4750f19edd1529680f9899db1da0f445">algorithm</a> == <a class="code" href="otz__tee__crypto__api_8h.html#a3fb37fc937a1cbad38ddb0279a4cca2da5046f27a1e92f6b237f11f166f07b56d">TEE_ALG_SHA1</a>) {</div>
<div class="line">                <span class="comment">/*if(!SHA_Init((SHA_CTX*)(operation-&gt;crypto_ctxt))) {</span></div>
<div class="line"><span class="comment">                        return;</span></div>
<div class="line"><span class="comment">                }*/</span></div>
<div class="line">                SHA_Update((SHA_CTX*)(operation-&gt;<a class="code" href="struct____TEE__OperationHandle.html#a49c6130723c77a4571daa08289f220e1">crypto_ctxt</a>),chunk,chunkSize);</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">if</span>((operation-&gt;<a class="code" href="struct____TEE__OperationHandle.html#a4750f19edd1529680f9899db1da0f445">algorithm</a> == <a class="code" href="otz__tee__crypto__api_8h.html#a3fb37fc937a1cbad38ddb0279a4cca2da8bf2921099c8ea45b4d6e6b4c739581b">TEE_ALG_SHA224</a>) ||</div>
<div class="line">                (operation-&gt;<a class="code" href="struct____TEE__OperationHandle.html#a4750f19edd1529680f9899db1da0f445">algorithm</a> == <a class="code" href="otz__tee__crypto__api_8h.html#a3fb37fc937a1cbad38ddb0279a4cca2da4d5569f60d52177f34c0437a9c0a944d">TEE_ALG_SHA256</a>)) {</div>
<div class="line">                <span class="comment">/*if(operation-&gt;algorithm == TEE_ALG_SHA224) {</span></div>
<div class="line"><span class="comment">                        if(!SHA224_Init((SHA256_CTX*)(operation-&gt;crypto_ctxt))) {</span></div>
<div class="line"><span class="comment">                                return;</span></div>
<div class="line"><span class="comment">                        }</span></div>
<div class="line"><span class="comment">                }</span></div>
<div class="line"><span class="comment">                if(operation-&gt;algorithm == TEE_ALG_SHA256) {</span></div>
<div class="line"><span class="comment">                        if(!SHA256_Init((SHA256_CTX*)(operation-&gt;crypto_ctxt))) {</span></div>
<div class="line"><span class="comment">                                return;</span></div>
<div class="line"><span class="comment">                        }</span></div>
<div class="line"><span class="comment">                }*/</span></div>
<div class="line">                SHA256_Update((SHA256_CTX*)(operation-&gt;<a class="code" href="struct____TEE__OperationHandle.html#a49c6130723c77a4571daa08289f220e1">crypto_ctxt</a>),chunk,chunkSize);</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">if</span>((operation-&gt;<a class="code" href="struct____TEE__OperationHandle.html#a4750f19edd1529680f9899db1da0f445">algorithm</a> == <a class="code" href="otz__tee__crypto__api_8h.html#a3fb37fc937a1cbad38ddb0279a4cca2da4c3d97a637bdffc9416b233e8c5d96de">TEE_ALG_SHA384</a>) ||</div>
<div class="line">                (operation-&gt;<a class="code" href="struct____TEE__OperationHandle.html#a4750f19edd1529680f9899db1da0f445">algorithm</a> == <a class="code" href="otz__tee__crypto__api_8h.html#a3fb37fc937a1cbad38ddb0279a4cca2da8a49f2bbc5ea5ec3a1c56dacbffe7728">TEE_ALG_SHA512</a>)) {</div>
<div class="line">                <span class="comment">/*if(operation-&gt;algorithm == TEE_ALG_SHA384) {</span></div>
<div class="line"><span class="comment">                        if(!SHA384_Init((SHA512_CTX*)(operation-&gt;crypto_ctxt))) {</span></div>
<div class="line"><span class="comment">                                return;</span></div>
<div class="line"><span class="comment">                        }</span></div>
<div class="line"><span class="comment">                }</span></div>
<div class="line"><span class="comment">                if(operation-&gt;algorithm == TEE_ALG_SHA512) {</span></div>
<div class="line"><span class="comment">                        if(!SHA512_Init((SHA512_CTX*)(operation-&gt;crypto_ctxt))) {</span></div>
<div class="line"><span class="comment">                                return;</span></div>
<div class="line"><span class="comment">                        }</span></div>
<div class="line"><span class="comment">                }*/</span></div>
<div class="line">                SHA512_Update((SHA512_CTX*)(operation-&gt;<a class="code" href="struct____TEE__OperationHandle.html#a49c6130723c77a4571daa08289f220e1">crypto_ctxt</a>),chunk,chunkSize);</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="af5f3a12e4fbaa2ae82d4dadf122ad4cd"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void TEE_FreeOperation </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="otz__tee__crypto__api_8h.html#a003ccda0ce6a2d7889b2933a201e2bd1">TEE_OperationHandle</a>&#160;</td>
          <td class="paramname"><em>operation</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">operation</td><td></td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="otz__tee__crypto__api_8c_source.html#l00607">607</a> of file <a class="el" href="otz__tee__crypto__api_8c_source.html">otz_tee_crypto_api.c</a>.</p>
<div class="fragment"><div class="line">{</div>
<div class="line">        <span class="keywordflow">if</span>(operation == <a class="code" href="sw__types_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) {</div>
<div class="line">                <a class="code" href="otz__tee__crypto__api_8h.html#a25a6ed042b2e933aeae3c26727987811">TEE_Panic</a>(<a class="code" href="otz__tee__api_8h.html#a586a43c1886aa09dc9541fb66e6d8d7fa4b7583ef234ccb0ef6f7492ee6e8200d">TEEC_ERROR_BAD_PARAMETERS</a>);</div>
<div class="line">                <span class="keywordflow">return</span>;</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">switch</span>(operation-&gt;<a class="code" href="struct____TEE__OperationHandle.html#aabd85e41a59abec4e8ba16147636a982">operationClass</a>) {</div>
<div class="line">                <span class="keywordflow">case</span> <a class="code" href="otz__tee__crypto__api_8h.html#ad0c73c650876132dcd7cc6309bf8c2b9a8291e2f74dfb25cda0c443241efb5b83">TEE_OPERATION_DIGEST</a>:</div>
<div class="line">                        handleDigestFree(operation);</div>
<div class="line">                        <span class="keywordflow">break</span>;</div>
<div class="line">                <span class="keywordflow">case</span> <a class="code" href="otz__tee__crypto__api_8h.html#ad0c73c650876132dcd7cc6309bf8c2b9acf36a2cc1dbc642035f06c853675fb32">TEE_OPERATION_MAC</a>:</div>
<div class="line">                        handleMacFree(operation);</div>
<div class="line">                        <span class="keywordflow">break</span>;</div>
<div class="line">                <span class="keywordflow">case</span> <a class="code" href="otz__tee__crypto__api_8h.html#ad0c73c650876132dcd7cc6309bf8c2b9ae19349aa696718354ffa15b9401f553f">TEE_OPERATION_CIPHER</a>:</div>
<div class="line">                <span class="keywordflow">case</span> <a class="code" href="otz__tee__crypto__api_8h.html#ad0c73c650876132dcd7cc6309bf8c2b9a37f7b80ca7f4cc2e049fb205bf46a950">TEE_OPERATION_AE</a>:</div>
<div class="line">                <span class="keywordflow">case</span> <a class="code" href="otz__tee__crypto__api_8h.html#ad0c73c650876132dcd7cc6309bf8c2b9aea1e65b9a3f86e8aa0c3537c510aaf65">TEE_OPERATION_ASYMMETRIC_CIPHER</a>:</div>
<div class="line">                        handleCipherFree(operation);</div>
<div class="line">                        <span class="keywordflow">break</span>;</div>
<div class="line">                <span class="keywordflow">case</span> <a class="code" href="otz__tee__crypto__api_8h.html#ad0c73c650876132dcd7cc6309bf8c2b9a9a4d80739a0c9476b584e7207f7485a4">TEE_OPERATION_ASYMMETRIC_SIGNATURE</a>:</div>
<div class="line">                        <span class="keywordflow">switch</span>(operation-&gt;<a class="code" href="struct____TEE__OperationHandle.html#a4750f19edd1529680f9899db1da0f445">algorithm</a>) {</div>
<div class="line">                                <span class="keywordflow">case</span> <a class="code" href="otz__tee__crypto__api_8h.html#a3fb37fc937a1cbad38ddb0279a4cca2daa7fe10548e4a524810f226b0b0e9b2ef">TEE_ALG_RSASSA_PKCS1_V1_5_MD5</a>:</div>
<div class="line">                                <span class="keywordflow">case</span> <a class="code" href="otz__tee__crypto__api_8h.html#a3fb37fc937a1cbad38ddb0279a4cca2da63f0d0ffe7c4a747ff3de3fde48a7a68">TEE_ALG_RSASSA_PKCS1_V1_5_SHA1</a>:</div>
<div class="line">                                        <span class="keywordflow">if</span>(operation-&gt;<a class="code" href="struct____TEE__OperationHandle.html#a1143afc5ba92c02e9e3ee751c585cace">keyValue</a> != <a class="code" href="sw__types_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) {</div>
<div class="line">                                                RSA_free(operation-&gt;<a class="code" href="struct____TEE__OperationHandle.html#a1143afc5ba92c02e9e3ee751c585cace">keyValue</a>);</div>
<div class="line">                                                <a class="code" href="sw__buddy_8h.html#a18008f7ca319ae3bbe7c8cc24bbc7d4b">sw_free</a>(operation-&gt;<a class="code" href="struct____TEE__OperationHandle.html#a1143afc5ba92c02e9e3ee751c585cace">keyValue</a>);</div>
<div class="line">                                        }</div>
<div class="line">                                        <span class="keywordflow">break</span>;</div>
<div class="line">                                <span class="keywordflow">case</span> <a class="code" href="otz__tee__crypto__api_8h.html#a3fb37fc937a1cbad38ddb0279a4cca2daa1817df024be65f38f7d43af0d9a341b">TEE_ALG_DSA_SHA1</a>:</div>
<div class="line">                                        <span class="keywordflow">if</span>(operation-&gt;<a class="code" href="struct____TEE__OperationHandle.html#a1143afc5ba92c02e9e3ee751c585cace">keyValue</a> != <a class="code" href="sw__types_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) {</div>
<div class="line">                                                DSA_free(operation-&gt;<a class="code" href="struct____TEE__OperationHandle.html#a1143afc5ba92c02e9e3ee751c585cace">keyValue</a>);</div>
<div class="line">                                                <a class="code" href="sw__buddy_8h.html#a18008f7ca319ae3bbe7c8cc24bbc7d4b">sw_free</a>(operation-&gt;<a class="code" href="struct____TEE__OperationHandle.html#a1143afc5ba92c02e9e3ee751c585cace">keyValue</a>);</div>
<div class="line">                                        }</div>
<div class="line">                                        <span class="keywordflow">break</span>;</div>
<div class="line">                                <span class="keywordflow">default</span>:</div>
<div class="line">                                        <span class="keywordflow">break</span>;</div>
<div class="line">                        }</div>
<div class="line">                        <span class="keywordflow">break</span>;</div>
<div class="line">                <span class="keywordflow">default</span>:</div>
<div class="line">                        <span class="keywordflow">break</span>;</div>
<div class="line">        }</div>
<div class="line">        <a class="code" href="sw__buddy_8h.html#a18008f7ca319ae3bbe7c8cc24bbc7d4b">sw_free</a>(operation-&gt;<a class="code" href="struct____TEE__OperationHandle.html#a49c6130723c77a4571daa08289f220e1">crypto_ctxt</a>);</div>
<div class="line">        <a class="code" href="sw__buddy_8h.html#a18008f7ca319ae3bbe7c8cc24bbc7d4b">sw_free</a>(operation);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a3c5a8cb6c0a8d91e1bcbec91abffffa5"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void TEE_GenerateRandom </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>randomBuffer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="sw__common__types_8h.html#a7c94ea6f8948649f8d181ae55911eeaf">size_t</a>&#160;</td>
          <td class="paramname"><em>randomBufferLen</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">randomBuffer</td><td></td></tr>
    <tr><td class="paramname">randomBufferLen</td><td></td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="otz__tee__crypto__api_8c_source.html#l01951">1951</a> of file <a class="el" href="otz__tee__crypto__api_8c_source.html">otz_tee_crypto_api.c</a>.</p>
<div class="fragment"><div class="line">{</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ab0c4a76983dc97122bf9c540458225d0"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void TEE_GetOperationInfo </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="otz__tee__crypto__api_8h.html#a003ccda0ce6a2d7889b2933a201e2bd1">TEE_OperationHandle</a>&#160;</td>
          <td class="paramname"><em>operation</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="otz__tee__crypto__api_8h.html#a383943b4a1fe4288e8247a834e7faf52">TEE_OperationInfo</a> *&#160;</td>
          <td class="paramname"><em>operationInfo</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">operation</td><td></td></tr>
    <tr><td class="paramname">operationInfo</td><td></td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="otz__tee__crypto__api_8c_source.html#l00658">658</a> of file <a class="el" href="otz__tee__crypto__api_8c_source.html">otz_tee_crypto_api.c</a>.</p>
<div class="fragment"><div class="line">{</div>
<div class="line">        <span class="keywordflow">if</span>(operation == <a class="code" href="sw__types_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) {</div>
<div class="line">                <a class="code" href="otz__tee__crypto__api_8h.html#a25a6ed042b2e933aeae3c26727987811">TEE_Panic</a>(<a class="code" href="otz__tee__api_8h.html#a586a43c1886aa09dc9541fb66e6d8d7fa4b7583ef234ccb0ef6f7492ee6e8200d">TEEC_ERROR_BAD_PARAMETERS</a>);</div>
<div class="line">                <span class="keywordflow">return</span>;</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">if</span>(operationInfo == <a class="code" href="sw__types_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) {</div>
<div class="line">                <span class="keywordflow">return</span>;</div>
<div class="line">        }</div>
<div class="line">        operationInfo-&gt;<a class="code" href="struct____TEE__OperationInfo.html#a062c53ebd215bedbf36f03cd4ae4cf1d">algorithm</a> = operation-&gt;<a class="code" href="struct____TEE__OperationHandle.html#a4750f19edd1529680f9899db1da0f445">algorithm</a>;</div>
<div class="line">        operationInfo-&gt;<a class="code" href="struct____TEE__OperationInfo.html#adb2e8cfc51291aaea88102903d3f885e">mode</a> = operation-&gt;<a class="code" href="struct____TEE__OperationHandle.html#ad399557c4571d3b2e41d81632803ed70">mode</a>;</div>
<div class="line">        operationInfo-&gt;<a class="code" href="struct____TEE__OperationInfo.html#adb2e8cfc51291aaea88102903d3f885e">mode</a> = operation-&gt;<a class="code" href="struct____TEE__OperationHandle.html#ad399557c4571d3b2e41d81632803ed70">mode</a>;</div>
<div class="line">        operationInfo-&gt;<a class="code" href="struct____TEE__OperationInfo.html#a2ea47b50f3c9e2e70dc3acfca3ab3353">digestLength</a> = operation-&gt;<a class="code" href="struct____TEE__OperationHandle.html#a3f8b3b35140e9d51bc7140fe66ff2343">digestLength</a>;</div>
<div class="line">        <span class="keywordflow">if</span>((operation-&gt;<a class="code" href="struct____TEE__OperationHandle.html#a4750f19edd1529680f9899db1da0f445">algorithm</a> == <a class="code" href="otz__tee__crypto__api_8h.html#a3fb37fc937a1cbad38ddb0279a4cca2dae9f210efdb8a6d22d22982a0ef9efbd1">TEE_ALG_RSAES_PKCS1_V1_5</a>) ||</div>
<div class="line">                        (operation-&gt;<a class="code" href="struct____TEE__OperationHandle.html#a4750f19edd1529680f9899db1da0f445">algorithm</a> == <a class="code" href="otz__tee__crypto__api_8h.html#a3fb37fc937a1cbad38ddb0279a4cca2da650d1d6a0a4e71b2cb2a3582afc0f44f">TEE_ALG_RSA_NOPAD</a>)) {</div>
<div class="line">                <span class="keywordflow">if</span>((operationInfo-&gt;<a class="code" href="struct____TEE__OperationInfo.html#ad217083e3c8464c1eaa7300cb2deb370">keyValue</a> =</div>
<div class="line">                                (<a class="code" href="sw__types_8h.html#aed742c436da53c1080638ce6ef7d13de">u8</a>*)<a class="code" href="sw__buddy_8h.html#a66652368e6d05f18bdc4be02b0c62694">sw_malloc</a>(<span class="keyword">sizeof</span>(<a class="code" href="sw__types_8h.html#aed742c436da53c1080638ce6ef7d13de">u8</a>)*<a class="code" href="otz__tee__crypto__api_8h.html#a88883bf575360b8c88762c61817d38ab" title="This is the size of the key that would be used for RSA.">SW_RSA_KEYLEN</a>)) != <a class="code" href="sw__types_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) {</div>
<div class="line">                        operationInfo-&gt;<a class="code" href="struct____TEE__OperationInfo.html#ad7b603e4ec9800ca35922e36c78b0b6c">keySize</a> =</div>
<div class="line">                        i2d_RSAPublicKey((RSA*)(operation-&gt;<a class="code" href="struct____TEE__OperationHandle.html#a1143afc5ba92c02e9e3ee751c585cace">keyValue</a>),</div>
<div class="line">                                (<a class="code" href="sw__types_8h.html#aed742c436da53c1080638ce6ef7d13de">u8</a>**)(&amp;(operationInfo-&gt;<a class="code" href="struct____TEE__OperationInfo.html#ad217083e3c8464c1eaa7300cb2deb370">keyValue</a>)));</div>
<div class="line">                        operationInfo-&gt;<a class="code" href="struct____TEE__OperationInfo.html#ad7b603e4ec9800ca35922e36c78b0b6c">keySize</a> +=</div>
<div class="line">                                i2d_RSAPrivateKey((RSA*)(operation-&gt;<a class="code" href="struct____TEE__OperationHandle.html#a1143afc5ba92c02e9e3ee751c585cace">keyValue</a>),</div>
<div class="line">                                (<a class="code" href="sw__types_8h.html#aed742c436da53c1080638ce6ef7d13de">u8</a>**)(&amp;(operationInfo-&gt;<a class="code" href="struct____TEE__OperationInfo.html#ad217083e3c8464c1eaa7300cb2deb370">keyValue</a>)));</div>
<div class="line">                        operationInfo-&gt;<a class="code" href="struct____TEE__OperationInfo.html#a96e71773ab2addb63483c22c5ecd5222">maxKeySize</a> = operationInfo-&gt;<a class="code" href="struct____TEE__OperationInfo.html#ad7b603e4ec9800ca35922e36c78b0b6c">keySize</a>;</div>
<div class="line">                }</div>
<div class="line">        } <span class="keywordflow">else</span> {</div>
<div class="line">                operationInfo-&gt;<a class="code" href="struct____TEE__OperationInfo.html#a96e71773ab2addb63483c22c5ecd5222">maxKeySize</a> = operation-&gt;<a class="code" href="struct____TEE__OperationHandle.html#a6fbb10608e0f1145a70e1a4368081706">maxKeySize</a>;</div>
<div class="line">                operationInfo-&gt;<a class="code" href="struct____TEE__OperationInfo.html#ad7b603e4ec9800ca35922e36c78b0b6c">keySize</a> = operation-&gt;<a class="code" href="struct____TEE__OperationHandle.html#ae445a64709be52b51708acbf247f2210">keySize</a>;</div>
<div class="line">                <span class="keywordflow">if</span>(operation-&gt;<a class="code" href="struct____TEE__OperationHandle.html#a1143afc5ba92c02e9e3ee751c585cace">keyValue</a> != <a class="code" href="sw__types_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) {</div>
<div class="line">                        <a class="code" href="sw__mem__functions_8h.html#a51ad02aba462d7be9a03231afa56de27" title="This version of memcpy assumes disjoint ptrs src, dst.">sw_memcpy</a>(operationInfo-&gt;<a class="code" href="struct____TEE__OperationInfo.html#ad217083e3c8464c1eaa7300cb2deb370">keyValue</a>,operation-&gt;<a class="code" href="struct____TEE__OperationHandle.html#a1143afc5ba92c02e9e3ee751c585cace">keyValue</a>,</div>
<div class="line">                                                                                                                operation-&gt;<a class="code" href="struct____TEE__OperationHandle.html#ae445a64709be52b51708acbf247f2210">keySize</a>);</div>
<div class="line">                }</div>
<div class="line">        }</div>
<div class="line">        operationInfo-&gt;<a class="code" href="struct____TEE__OperationInfo.html#a77879e98b62d43d4a65dd4abb2c2078e">requiredKeyUsage</a> = operation-&gt;<a class="code" href="struct____TEE__OperationHandle.html#a3e1f634c8756c283125b393ffaf4277a">requiredKeyUsage</a>;</div>
<div class="line">        operationInfo-&gt;<a class="code" href="struct____TEE__OperationInfo.html#a56c98435528db66a50ec6e8ad5344394">handleState</a> = operation-&gt;<a class="code" href="struct____TEE__OperationHandle.html#abb1e51eff08ef2ad1022015a3b4184ac">handleState</a>;</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a2f2ee76ede085e7b603ae552400de6d6"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="otz__tee__api_8h.html#a586a43c1886aa09dc9541fb66e6d8d7f">TEEC_Result</a> TEE_MACCompareFinal </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="otz__tee__crypto__api_8h.html#a003ccda0ce6a2d7889b2933a201e2bd1">TEE_OperationHandle</a>&#160;</td>
          <td class="paramname"><em>operation</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>message</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="sw__common__types_8h.html#a7c94ea6f8948649f8d181ae55911eeaf">size_t</a>&#160;</td>
          <td class="paramname"><em>messageLen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>mac</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="sw__common__types_8h.html#a7c94ea6f8948649f8d181ae55911eeaf">size_t</a> *&#160;</td>
          <td class="paramname"><em>macLen</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">operation</td><td></td></tr>
    <tr><td class="paramname">message</td><td></td></tr>
    <tr><td class="paramname">messageLen</td><td></td></tr>
    <tr><td class="paramname">mac</td><td></td></tr>
    <tr><td class="paramname">macLen</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd></dd></dl>

<p>Definition at line <a class="el" href="otz__tee__crypto__api_8c_source.html#l01413">1413</a> of file <a class="el" href="otz__tee__crypto__api_8c_source.html">otz_tee_crypto_api.c</a>.</p>
<div class="fragment"><div class="line">{</div>
<div class="line">        <a class="code" href="sw__types_8h.html#aed742c436da53c1080638ce6ef7d13de">u8</a> tempOutput[EVP_MAX_MD_SIZE+1];</div>
<div class="line">        <span class="keywordtype">size_t</span> tempOutputLen = EVP_MAX_MD_SIZE;</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span>(operation == <a class="code" href="sw__types_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) {</div>
<div class="line">                <span class="keywordflow">return</span>(<a class="code" href="otz__tee__api_8h.html#a586a43c1886aa09dc9541fb66e6d8d7fa4b7583ef234ccb0ef6f7492ee6e8200d">TEEC_ERROR_BAD_PARAMETERS</a>);</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">if</span>(operation-&gt;<a class="code" href="struct____TEE__OperationHandle.html#aabd85e41a59abec4e8ba16147636a982">operationClass</a> != <a class="code" href="otz__tee__crypto__api_8h.html#ad0c73c650876132dcd7cc6309bf8c2b9acf36a2cc1dbc642035f06c853675fb32">TEE_OPERATION_MAC</a>) {</div>
<div class="line">                <a class="code" href="otz__tee__crypto__api_8h.html#a25a6ed042b2e933aeae3c26727987811">TEE_Panic</a>(<a class="code" href="otz__tee__api_8h.html#a586a43c1886aa09dc9541fb66e6d8d7fa4b7583ef234ccb0ef6f7492ee6e8200d">TEEC_ERROR_BAD_PARAMETERS</a>);</div>
<div class="line">                <span class="keywordflow">return</span>(<a class="code" href="otz__tee__api_8h.html#a586a43c1886aa09dc9541fb66e6d8d7fa4b7583ef234ccb0ef6f7492ee6e8200d">TEEC_ERROR_BAD_PARAMETERS</a>);</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">switch</span>(operation-&gt;<a class="code" href="struct____TEE__OperationHandle.html#a4750f19edd1529680f9899db1da0f445">algorithm</a>) {</div>
<div class="line">                <span class="keywordflow">case</span> <a class="code" href="otz__tee__crypto__api_8h.html#a3fb37fc937a1cbad38ddb0279a4cca2da7c764bcc368658423818c1a2a66daf6a">TEE_ALG_HMAC_MD5</a>:</div>
<div class="line">                <span class="keywordflow">case</span> <a class="code" href="otz__tee__crypto__api_8h.html#a3fb37fc937a1cbad38ddb0279a4cca2da3bb54819ca96192f6d141ad4cdc6fd6e">TEE_ALG_HMAC_SHA1</a>:</div>
<div class="line">                <span class="keywordflow">case</span> <a class="code" href="otz__tee__crypto__api_8h.html#a3fb37fc937a1cbad38ddb0279a4cca2da0fa0ae8dfe702d270cc20b62fe758ea8">TEE_ALG_HMAC_SHA224</a>:</div>
<div class="line">                <span class="keywordflow">case</span> <a class="code" href="otz__tee__crypto__api_8h.html#a3fb37fc937a1cbad38ddb0279a4cca2da6d3676f84816577fd0700b705128a971">TEE_ALG_HMAC_SHA256</a>:</div>
<div class="line">                <span class="keywordflow">case</span> <a class="code" href="otz__tee__crypto__api_8h.html#a3fb37fc937a1cbad38ddb0279a4cca2dacffe8239ab9402d416500bcc2f639e75">TEE_ALG_HMAC_SHA384</a>:</div>
<div class="line">                <span class="keywordflow">case</span> <a class="code" href="otz__tee__crypto__api_8h.html#a3fb37fc937a1cbad38ddb0279a4cca2dad2e5e1916c04be276835c4a536be94b5">TEE_ALG_HMAC_SHA512</a>:</div>
<div class="line">                        <span class="keywordflow">if</span>(messageLen &gt; 0) {</div>
<div class="line">                                <span class="keywordflow">if</span>(!HMAC_Update((HMAC_CTX*)operation-&gt;<a class="code" href="struct____TEE__OperationHandle.html#a49c6130723c77a4571daa08289f220e1">crypto_ctxt</a>,</div>
<div class="line">                                        message,messageLen)) {</div>
<div class="line">                                        <span class="keywordflow">return</span>(<a class="code" href="otz__tee__api_8h.html#a586a43c1886aa09dc9541fb66e6d8d7fa4b7583ef234ccb0ef6f7492ee6e8200d">TEEC_ERROR_BAD_PARAMETERS</a>);</div>
<div class="line">                                }</div>
<div class="line">                        }</div>
<div class="line">                        <span class="keywordflow">if</span>(!HMAC_Final((HMAC_CTX*)operation-&gt;<a class="code" href="struct____TEE__OperationHandle.html#a49c6130723c77a4571daa08289f220e1">crypto_ctxt</a>,</div>
<div class="line">                                (<span class="keywordtype">void</span>*)tempOutput,&amp;tempOutputLen)) {</div>
<div class="line">                                <span class="keywordflow">return</span>(<a class="code" href="otz__tee__api_8h.html#a586a43c1886aa09dc9541fb66e6d8d7fa4b7583ef234ccb0ef6f7492ee6e8200d">TEEC_ERROR_BAD_PARAMETERS</a>);</div>
<div class="line">                        }</div>
<div class="line">                        <span class="keywordflow">if</span>(*macLen != tempOutputLen) {</div>
<div class="line">                                <span class="keywordflow">return</span>(<a class="code" href="otz__tee__api_8h.html#a586a43c1886aa09dc9541fb66e6d8d7fadbaa696ecb3b3146be3c69fa055f893a">TEEC_ERROR_MAC_INVALID</a>);</div>
<div class="line">                        }</div>
<div class="line">                        <span class="keywordflow">if</span>(<a class="code" href="sw__mem__functions_8h.html#abe3b68a59cfcf8036f5b9dc008d0333d" title="custom version of memcmp function">sw_memcmp</a>(tempOutput,mac,*macLen) != 0) {</div>
<div class="line">                                <span class="keywordflow">return</span>(<a class="code" href="otz__tee__api_8h.html#a586a43c1886aa09dc9541fb66e6d8d7fadbaa696ecb3b3146be3c69fa055f893a">TEEC_ERROR_MAC_INVALID</a>);</div>
<div class="line">                        }</div>
<div class="line">                        <span class="keywordflow">break</span>;</div>
<div class="line">                <span class="keywordflow">default</span>:</div>
<div class="line">                        <span class="keywordflow">break</span>;</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">return</span>(<a class="code" href="otz__tee__api_8h.html#a586a43c1886aa09dc9541fb66e6d8d7fa4d19c2c024e37edc5f04892bb6739dbe">TEEC_SUCCESS</a>);</div>
<div class="line">}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a3b92d51c8e81018ea174ed15cc15de71"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="otz__tee__api_8h.html#a586a43c1886aa09dc9541fb66e6d8d7f">TEEC_Result</a> TEE_MACComputeFinal </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="otz__tee__crypto__api_8h.html#a003ccda0ce6a2d7889b2933a201e2bd1">TEE_OperationHandle</a>&#160;</td>
          <td class="paramname"><em>operation</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>message</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="sw__common__types_8h.html#a7c94ea6f8948649f8d181ae55911eeaf">size_t</a>&#160;</td>
          <td class="paramname"><em>messageLen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>mac</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="sw__common__types_8h.html#a7c94ea6f8948649f8d181ae55911eeaf">size_t</a> *&#160;</td>
          <td class="paramname"><em>macLen</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">operation</td><td></td></tr>
    <tr><td class="paramname">message</td><td></td></tr>
    <tr><td class="paramname">messageLen</td><td></td></tr>
    <tr><td class="paramname">mac</td><td></td></tr>
    <tr><td class="paramname">macLen</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd></dd></dl>

<p>Definition at line <a class="el" href="otz__tee__crypto__api_8c_source.html#l01366">1366</a> of file <a class="el" href="otz__tee__crypto__api_8c_source.html">otz_tee_crypto_api.c</a>.</p>
<div class="fragment"><div class="line">{</div>
<div class="line">        <span class="keywordflow">if</span>(operation == <a class="code" href="sw__types_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) {</div>
<div class="line">                <span class="keywordflow">return</span>(<a class="code" href="otz__tee__api_8h.html#a586a43c1886aa09dc9541fb66e6d8d7fa4b7583ef234ccb0ef6f7492ee6e8200d">TEEC_ERROR_BAD_PARAMETERS</a>);</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">if</span>(operation-&gt;<a class="code" href="struct____TEE__OperationHandle.html#aabd85e41a59abec4e8ba16147636a982">operationClass</a> != <a class="code" href="otz__tee__crypto__api_8h.html#ad0c73c650876132dcd7cc6309bf8c2b9acf36a2cc1dbc642035f06c853675fb32">TEE_OPERATION_MAC</a>) {</div>
<div class="line">                <a class="code" href="otz__tee__crypto__api_8h.html#a25a6ed042b2e933aeae3c26727987811">TEE_Panic</a>(<a class="code" href="otz__tee__api_8h.html#a586a43c1886aa09dc9541fb66e6d8d7fa4b7583ef234ccb0ef6f7492ee6e8200d">TEEC_ERROR_BAD_PARAMETERS</a>);</div>
<div class="line">                <span class="keywordflow">return</span>(<a class="code" href="otz__tee__api_8h.html#a586a43c1886aa09dc9541fb66e6d8d7fa4b7583ef234ccb0ef6f7492ee6e8200d">TEEC_ERROR_BAD_PARAMETERS</a>);</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">switch</span>(operation-&gt;<a class="code" href="struct____TEE__OperationHandle.html#a4750f19edd1529680f9899db1da0f445">algorithm</a>) {</div>
<div class="line">                <span class="keywordflow">case</span> <a class="code" href="otz__tee__crypto__api_8h.html#a3fb37fc937a1cbad38ddb0279a4cca2da7c764bcc368658423818c1a2a66daf6a">TEE_ALG_HMAC_MD5</a>:</div>
<div class="line">                <span class="keywordflow">case</span> <a class="code" href="otz__tee__crypto__api_8h.html#a3fb37fc937a1cbad38ddb0279a4cca2da3bb54819ca96192f6d141ad4cdc6fd6e">TEE_ALG_HMAC_SHA1</a>:</div>
<div class="line">                <span class="keywordflow">case</span> <a class="code" href="otz__tee__crypto__api_8h.html#a3fb37fc937a1cbad38ddb0279a4cca2da0fa0ae8dfe702d270cc20b62fe758ea8">TEE_ALG_HMAC_SHA224</a>:</div>
<div class="line">                <span class="keywordflow">case</span> <a class="code" href="otz__tee__crypto__api_8h.html#a3fb37fc937a1cbad38ddb0279a4cca2da6d3676f84816577fd0700b705128a971">TEE_ALG_HMAC_SHA256</a>:</div>
<div class="line">                <span class="keywordflow">case</span> <a class="code" href="otz__tee__crypto__api_8h.html#a3fb37fc937a1cbad38ddb0279a4cca2dacffe8239ab9402d416500bcc2f639e75">TEE_ALG_HMAC_SHA384</a>:</div>
<div class="line">                <span class="keywordflow">case</span> <a class="code" href="otz__tee__crypto__api_8h.html#a3fb37fc937a1cbad38ddb0279a4cca2dad2e5e1916c04be276835c4a536be94b5">TEE_ALG_HMAC_SHA512</a>:</div>
<div class="line">                        <span class="keywordflow">if</span>(*macLen &lt; EVP_MAX_MD_SIZE) {</div>
<div class="line">                                <span class="keywordflow">return</span>(<a class="code" href="otz__tee__api_8h.html#a586a43c1886aa09dc9541fb66e6d8d7fac72ab519c77b51a03a6ceb17d656fcc1">TEEC_ERROR_SHORT_BUFFER</a>);</div>
<div class="line">                        }</div>
<div class="line">                        <span class="keywordflow">if</span>(messageLen &gt; 0) {</div>
<div class="line">                                <span class="keywordflow">if</span>(!HMAC_Update((HMAC_CTX*)operation-&gt;<a class="code" href="struct____TEE__OperationHandle.html#a49c6130723c77a4571daa08289f220e1">crypto_ctxt</a>,message,</div>
<div class="line">                                                                                                                                messageLen)) {</div>
<div class="line">                                        <span class="keywordflow">return</span>(<a class="code" href="otz__tee__api_8h.html#a586a43c1886aa09dc9541fb66e6d8d7fa4b7583ef234ccb0ef6f7492ee6e8200d">TEEC_ERROR_BAD_PARAMETERS</a>);</div>
<div class="line">                                }</div>
<div class="line">                        }</div>
<div class="line">                        <span class="keywordflow">if</span>(!HMAC_Final((HMAC_CTX*)operation-&gt;<a class="code" href="struct____TEE__OperationHandle.html#a49c6130723c77a4571daa08289f220e1">crypto_ctxt</a>,mac,macLen)) {</div>
<div class="line">                                <span class="keywordflow">return</span>(<a class="code" href="otz__tee__api_8h.html#a586a43c1886aa09dc9541fb66e6d8d7fa4b7583ef234ccb0ef6f7492ee6e8200d">TEEC_ERROR_BAD_PARAMETERS</a>);</div>
<div class="line">                        }</div>
<div class="line">                        <span class="keywordflow">break</span>;</div>
<div class="line">                <span class="keywordflow">default</span>:</div>
<div class="line">                        <span class="keywordflow">break</span>;</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">return</span>(<a class="code" href="otz__tee__api_8h.html#a586a43c1886aa09dc9541fb66e6d8d7fa4d19c2c024e37edc5f04892bb6739dbe">TEEC_SUCCESS</a>);</div>
<div class="line">}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="acb4efa28654d099dd29e3934637d166b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void TEE_MACInit </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="otz__tee__crypto__api_8h.html#a003ccda0ce6a2d7889b2933a201e2bd1">TEE_OperationHandle</a>&#160;</td>
          <td class="paramname"><em>operation</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>IV</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="sw__common__types_8h.html#a7c94ea6f8948649f8d181ae55911eeaf">size_t</a>&#160;</td>
          <td class="paramname"><em>IVLen</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">operation</td><td></td></tr>
    <tr><td class="paramname">IV</td><td></td></tr>
    <tr><td class="paramname">IVLen</td><td></td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="otz__tee__crypto__api_8c_source.html#l01270">1270</a> of file <a class="el" href="otz__tee__crypto__api_8c_source.html">otz_tee_crypto_api.c</a>.</p>
<div class="fragment"><div class="line">{</div>
<div class="line">        <span class="keywordflow">if</span>(operation == <a class="code" href="sw__types_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) {</div>
<div class="line">                <span class="keywordflow">return</span>;</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">if</span>(operation-&gt;<a class="code" href="struct____TEE__OperationHandle.html#aabd85e41a59abec4e8ba16147636a982">operationClass</a> != <a class="code" href="otz__tee__crypto__api_8h.html#ad0c73c650876132dcd7cc6309bf8c2b9acf36a2cc1dbc642035f06c853675fb32">TEE_OPERATION_MAC</a>) {</div>
<div class="line">                <a class="code" href="otz__tee__crypto__api_8h.html#a25a6ed042b2e933aeae3c26727987811">TEE_Panic</a>(<a class="code" href="otz__tee__api_8h.html#a586a43c1886aa09dc9541fb66e6d8d7fa4b7583ef234ccb0ef6f7492ee6e8200d">TEEC_ERROR_BAD_PARAMETERS</a>);</div>
<div class="line">                <span class="keywordflow">return</span>;</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">if</span>(IV == <a class="code" href="sw__types_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) {</div>
<div class="line">                <a class="code" href="otz__tee__crypto__api_8h.html#a25a6ed042b2e933aeae3c26727987811">TEE_Panic</a>(<a class="code" href="otz__tee__api_8h.html#a586a43c1886aa09dc9541fb66e6d8d7fa4b7583ef234ccb0ef6f7492ee6e8200d">TEEC_ERROR_BAD_PARAMETERS</a>);</div>
<div class="line">                <span class="keywordflow">return</span>;</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">switch</span>(operation-&gt;<a class="code" href="struct____TEE__OperationHandle.html#a4750f19edd1529680f9899db1da0f445">algorithm</a>) {</div>
<div class="line">                <span class="keywordflow">case</span> <a class="code" href="otz__tee__crypto__api_8h.html#a3fb37fc937a1cbad38ddb0279a4cca2da7c764bcc368658423818c1a2a66daf6a">TEE_ALG_HMAC_MD5</a>:</div>
<div class="line">                        <span class="keywordflow">if</span>(!HMAC_Init((HMAC_CTX*)(operation-&gt;<a class="code" href="struct____TEE__OperationHandle.html#a49c6130723c77a4571daa08289f220e1">crypto_ctxt</a>),IV,IVLen,EVP_md5())) {</div>
<div class="line">                                <span class="keywordflow">return</span>;</div>
<div class="line">                        }</div>
<div class="line">                        <span class="keywordflow">break</span>;</div>
<div class="line">                <span class="keywordflow">case</span> <a class="code" href="otz__tee__crypto__api_8h.html#a3fb37fc937a1cbad38ddb0279a4cca2da3bb54819ca96192f6d141ad4cdc6fd6e">TEE_ALG_HMAC_SHA1</a>:</div>
<div class="line">                        <span class="keywordflow">if</span>(!HMAC_Init((HMAC_CTX*)(operation-&gt;<a class="code" href="struct____TEE__OperationHandle.html#a49c6130723c77a4571daa08289f220e1">crypto_ctxt</a>),IV,IVLen,EVP_sha1())) {</div>
<div class="line">                                <span class="keywordflow">return</span>;</div>
<div class="line">                        }</div>
<div class="line">                        <span class="keywordflow">break</span>;</div>
<div class="line">                <span class="keywordflow">case</span> <a class="code" href="otz__tee__crypto__api_8h.html#a3fb37fc937a1cbad38ddb0279a4cca2da0fa0ae8dfe702d270cc20b62fe758ea8">TEE_ALG_HMAC_SHA224</a>:</div>
<div class="line">                        <span class="keywordflow">if</span>(!HMAC_Init((HMAC_CTX*)(operation-&gt;<a class="code" href="struct____TEE__OperationHandle.html#a49c6130723c77a4571daa08289f220e1">crypto_ctxt</a>),IV,IVLen,EVP_sha224())) {</div>
<div class="line">                                <span class="keywordflow">return</span>;</div>
<div class="line">                        }</div>
<div class="line">                        <span class="keywordflow">break</span>;</div>
<div class="line">                <span class="keywordflow">case</span> <a class="code" href="otz__tee__crypto__api_8h.html#a3fb37fc937a1cbad38ddb0279a4cca2da6d3676f84816577fd0700b705128a971">TEE_ALG_HMAC_SHA256</a>:</div>
<div class="line">                        <span class="keywordflow">if</span>(!HMAC_Init((HMAC_CTX*)(operation-&gt;<a class="code" href="struct____TEE__OperationHandle.html#a49c6130723c77a4571daa08289f220e1">crypto_ctxt</a>),IV,IVLen,EVP_sha256())) {</div>
<div class="line">                                <span class="keywordflow">return</span>;</div>
<div class="line">                        }</div>
<div class="line">                        <span class="keywordflow">break</span>;</div>
<div class="line">                <span class="keywordflow">case</span> <a class="code" href="otz__tee__crypto__api_8h.html#a3fb37fc937a1cbad38ddb0279a4cca2dacffe8239ab9402d416500bcc2f639e75">TEE_ALG_HMAC_SHA384</a>:</div>
<div class="line">                        <span class="keywordflow">if</span>(!HMAC_Init((HMAC_CTX*)(operation-&gt;<a class="code" href="struct____TEE__OperationHandle.html#a49c6130723c77a4571daa08289f220e1">crypto_ctxt</a>),IV,IVLen,EVP_sha384())) {</div>
<div class="line">                                <span class="keywordflow">return</span>;</div>
<div class="line">                        }</div>
<div class="line">                        <span class="keywordflow">break</span>;</div>
<div class="line">                <span class="keywordflow">case</span> <a class="code" href="otz__tee__crypto__api_8h.html#a3fb37fc937a1cbad38ddb0279a4cca2dad2e5e1916c04be276835c4a536be94b5">TEE_ALG_HMAC_SHA512</a>:</div>
<div class="line">                        <span class="keywordflow">if</span>(!HMAC_Init((HMAC_CTX*)(operation-&gt;<a class="code" href="struct____TEE__OperationHandle.html#a49c6130723c77a4571daa08289f220e1">crypto_ctxt</a>),IV,IVLen,EVP_sha512())) {</div>
<div class="line">                                <span class="keywordflow">return</span>;</div>
<div class="line">                        }</div>
<div class="line">                        <span class="keywordflow">break</span>;</div>
<div class="line">                <span class="keywordflow">default</span>:</div>
<div class="line">                        <span class="keywordflow">break</span>;</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a28c22840ca8936cb69f8ce5cc7f32c6c"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void TEE_MACUpdate </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="otz__tee__crypto__api_8h.html#a003ccda0ce6a2d7889b2933a201e2bd1">TEE_OperationHandle</a>&#160;</td>
          <td class="paramname"><em>operation</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>chunk</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="sw__common__types_8h.html#a7c94ea6f8948649f8d181ae55911eeaf">size_t</a>&#160;</td>
          <td class="paramname"><em>chunkSize</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">operation</td><td></td></tr>
    <tr><td class="paramname">chunk</td><td></td></tr>
    <tr><td class="paramname">chunkSize</td><td></td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="otz__tee__crypto__api_8c_source.html#l01328">1328</a> of file <a class="el" href="otz__tee__crypto__api_8c_source.html">otz_tee_crypto_api.c</a>.</p>
<div class="fragment"><div class="line">{</div>
<div class="line">        <span class="keywordflow">if</span>(operation == <a class="code" href="sw__types_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) {</div>
<div class="line">                <span class="keywordflow">return</span>;</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">if</span>(operation-&gt;<a class="code" href="struct____TEE__OperationHandle.html#aabd85e41a59abec4e8ba16147636a982">operationClass</a> != <a class="code" href="otz__tee__crypto__api_8h.html#ad0c73c650876132dcd7cc6309bf8c2b9acf36a2cc1dbc642035f06c853675fb32">TEE_OPERATION_MAC</a>) {</div>
<div class="line">                <a class="code" href="otz__tee__crypto__api_8h.html#a25a6ed042b2e933aeae3c26727987811">TEE_Panic</a>(<a class="code" href="otz__tee__api_8h.html#a586a43c1886aa09dc9541fb66e6d8d7fa4b7583ef234ccb0ef6f7492ee6e8200d">TEEC_ERROR_BAD_PARAMETERS</a>);</div>
<div class="line">                <span class="keywordflow">return</span>;</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">switch</span>(operation-&gt;<a class="code" href="struct____TEE__OperationHandle.html#a4750f19edd1529680f9899db1da0f445">algorithm</a>) {</div>
<div class="line">                <span class="keywordflow">case</span> <a class="code" href="otz__tee__crypto__api_8h.html#a3fb37fc937a1cbad38ddb0279a4cca2da7c764bcc368658423818c1a2a66daf6a">TEE_ALG_HMAC_MD5</a>:</div>
<div class="line">                <span class="keywordflow">case</span> <a class="code" href="otz__tee__crypto__api_8h.html#a3fb37fc937a1cbad38ddb0279a4cca2da3bb54819ca96192f6d141ad4cdc6fd6e">TEE_ALG_HMAC_SHA1</a>:</div>
<div class="line">                <span class="keywordflow">case</span> <a class="code" href="otz__tee__crypto__api_8h.html#a3fb37fc937a1cbad38ddb0279a4cca2da0fa0ae8dfe702d270cc20b62fe758ea8">TEE_ALG_HMAC_SHA224</a>:</div>
<div class="line">                <span class="keywordflow">case</span> <a class="code" href="otz__tee__crypto__api_8h.html#a3fb37fc937a1cbad38ddb0279a4cca2da6d3676f84816577fd0700b705128a971">TEE_ALG_HMAC_SHA256</a>:</div>
<div class="line">                <span class="keywordflow">case</span> <a class="code" href="otz__tee__crypto__api_8h.html#a3fb37fc937a1cbad38ddb0279a4cca2dacffe8239ab9402d416500bcc2f639e75">TEE_ALG_HMAC_SHA384</a>:</div>
<div class="line">                <span class="keywordflow">case</span> <a class="code" href="otz__tee__crypto__api_8h.html#a3fb37fc937a1cbad38ddb0279a4cca2dad2e5e1916c04be276835c4a536be94b5">TEE_ALG_HMAC_SHA512</a>:</div>
<div class="line">                        <span class="keywordflow">if</span>(!HMAC_Update((HMAC_CTX*)operation-&gt;<a class="code" href="struct____TEE__OperationHandle.html#a49c6130723c77a4571daa08289f220e1">crypto_ctxt</a>,chunk,chunkSize)) {</div>
<div class="line">                                <span class="keywordflow">return</span>;</div>
<div class="line">                        }</div>
<div class="line">                        <span class="keywordflow">break</span>;</div>
<div class="line">                <span class="keywordflow">default</span>:</div>
<div class="line">                        <span class="keywordflow">break</span>;</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a25a6ed042b2e933aeae3c26727987811"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void TEE_Panic </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="otz__tee__api_8h.html#aa1b64b7b46cd8040d03cb32c6504796a">TEE_Result</a>&#160;</td>
          <td class="paramname"><em>panicCode</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">panicCode</td><td></td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="otz__tee__crypto__api_8c_source.html#l00043">43</a> of file <a class="el" href="otz__tee__crypto__api_8c_source.html">otz_tee_crypto_api.c</a>.</p>
<div class="fragment"><div class="line">{</div>
<div class="line">        <span class="comment">/* A suitable panic function needs to be implemented, which will not</span></div>
<div class="line"><span class="comment">         * return to the caller. For now, we use just return();</span></div>
<div class="line"><span class="comment">         */</span></div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a2d36adb59a76af1f73090475e98aa4c9"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void TEE_ResetOperation </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="otz__tee__crypto__api_8h.html#a003ccda0ce6a2d7889b2933a201e2bd1">TEE_OperationHandle</a>&#160;</td>
          <td class="paramname"><em>operation</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">operation</td><td></td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="otz__tee__crypto__api_8c_source.html#l00702">702</a> of file <a class="el" href="otz__tee__crypto__api_8c_source.html">otz_tee_crypto_api.c</a>.</p>
<div class="fragment"><div class="line">{</div>
<div class="line">        <span class="keywordflow">if</span>(operation == <a class="code" href="sw__types_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) {</div>
<div class="line">                <a class="code" href="otz__tee__crypto__api_8h.html#a25a6ed042b2e933aeae3c26727987811">TEE_Panic</a>(<a class="code" href="otz__tee__api_8h.html#a586a43c1886aa09dc9541fb66e6d8d7fa4b7583ef234ccb0ef6f7492ee6e8200d">TEEC_ERROR_BAD_PARAMETERS</a>);</div>
<div class="line">                <span class="keywordflow">return</span>;</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">switch</span>(operation-&gt;<a class="code" href="struct____TEE__OperationHandle.html#ad399557c4571d3b2e41d81632803ed70">mode</a>) {</div>
<div class="line">                <span class="keywordflow">case</span> <a class="code" href="otz__tee__crypto__api_8h.html#ad0c73c650876132dcd7cc6309bf8c2b9aea1e65b9a3f86e8aa0c3537c510aaf65">TEE_OPERATION_ASYMMETRIC_CIPHER</a>:</div>
<div class="line">                <span class="keywordflow">case</span> <a class="code" href="otz__tee__crypto__api_8h.html#ad0c73c650876132dcd7cc6309bf8c2b9a9a4d80739a0c9476b584e7207f7485a4">TEE_OPERATION_ASYMMETRIC_SIGNATURE</a>:</div>
<div class="line">                <span class="keywordflow">case</span> <a class="code" href="otz__tee__crypto__api_8h.html#ad0c73c650876132dcd7cc6309bf8c2b9aec6ff5e5db5b23f11088b2371d7f1692">TEE_OPERATION_KEY_DERIVATION</a>:</div>
<div class="line">                        <span class="keywordflow">return</span>;</div>
<div class="line">                <span class="keywordflow">break</span>;</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a6a7ec2dacb75dee7a6610bc9d4483bae"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="otz__tee__api_8h.html#a586a43c1886aa09dc9541fb66e6d8d7f">TEEC_Result</a> TEE_SetOperationKey </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="otz__tee__crypto__api_8h.html#a003ccda0ce6a2d7889b2933a201e2bd1">TEE_OperationHandle</a>&#160;</td>
          <td class="paramname"><em>operation</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="otz__api_8h.html#a6a2cfeba38a0f61d5937bcc8cf04b9a2">TEE_ObjectHandle</a> *&#160;</td>
          <td class="paramname"><em>key</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">operation</td><td></td></tr>
    <tr><td class="paramname">key</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd></dd></dl>

<p>Definition at line <a class="el" href="otz__tee__crypto__api_8c_source.html#l00779">779</a> of file <a class="el" href="otz__tee__crypto__api_8c_source.html">otz_tee_crypto_api.c</a>.</p>
<div class="fragment"><div class="line">{</div>
<div class="line">        <a class="code" href="otz__tee__api_8h.html#a586a43c1886aa09dc9541fb66e6d8d7f" title="Error codes.">TEEC_Result</a> retVal;</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span>(operation == <a class="code" href="sw__types_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) {</div>
<div class="line">                <span class="keywordflow">return</span>(<a class="code" href="otz__tee__api_8h.html#a586a43c1886aa09dc9541fb66e6d8d7fa4b7583ef234ccb0ef6f7492ee6e8200d">TEEC_ERROR_BAD_PARAMETERS</a>);</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">if</span>(operation-&gt;<a class="code" href="struct____TEE__OperationHandle.html#ad399557c4571d3b2e41d81632803ed70">mode</a> == <a class="code" href="otz__tee__crypto__api_8h.html#a883ffc5fb861ac33d91c7a8058d59744a14fd1dd01b612be722995b8753a9ced3">TEE_MODE_DIGEST</a>) {</div>
<div class="line">                <a class="code" href="otz__tee__crypto__api_8h.html#a25a6ed042b2e933aeae3c26727987811">TEE_Panic</a>(<a class="code" href="otz__tee__api_8h.html#a586a43c1886aa09dc9541fb66e6d8d7fa4b7583ef234ccb0ef6f7492ee6e8200d">TEEC_ERROR_BAD_PARAMETERS</a>);</div>
<div class="line">                <span class="keywordflow">return</span>(<a class="code" href="otz__tee__api_8h.html#a586a43c1886aa09dc9541fb66e6d8d7fa4b7583ef234ccb0ef6f7492ee6e8200d">TEEC_ERROR_BAD_PARAMETERS</a>);</div>
<div class="line">        }</div>
<div class="line">        <span class="comment">/*if(operation-&gt;algorithm == TEE_ALG_AES_XTS) {</span></div>
<div class="line"><span class="comment">                TEE_Panic(TEEC_ERROR_BAD_PARAMETERS);</span></div>
<div class="line"><span class="comment">                return(TEEC_ERROR_BAD_PARAMETERS);</span></div>
<div class="line"><span class="comment">        }*/</span></div>
<div class="line">        <span class="keywordflow">if</span>(operation-&gt;<a class="code" href="struct____TEE__OperationHandle.html#aabd85e41a59abec4e8ba16147636a982">operationClass</a> == <a class="code" href="otz__tee__crypto__api_8h.html#ad0c73c650876132dcd7cc6309bf8c2b9ae19349aa696718354ffa15b9401f553f">TEE_OPERATION_CIPHER</a>) {</div>
<div class="line">                <span class="keywordflow">if</span>((operation-&gt;<a class="code" href="struct____TEE__OperationHandle.html#a4a8cf4911ff381adc90e66a0ea2d1066">crypto_cipher</a> != <a class="code" href="sw__types_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) &amp;&amp;</div>
<div class="line">                        (key-&gt;<a class="code" href="struct____TEE__ObjectHandle.html#a0aaa3d54773c38d5db99a6a06b75230d">dataLen</a> != ((EVP_CIPHER*)(operation-&gt;<a class="code" href="struct____TEE__OperationHandle.html#a4a8cf4911ff381adc90e66a0ea2d1066">crypto_cipher</a>))-&gt;key_len)) {</div>
<div class="line">                        <span class="keywordflow">return</span>(<a class="code" href="otz__tee__api_8h.html#a586a43c1886aa09dc9541fb66e6d8d7fa4b7583ef234ccb0ef6f7492ee6e8200d">TEEC_ERROR_BAD_PARAMETERS</a>);</div>
<div class="line">                }</div>
<div class="line">                <span class="keywordflow">if</span>((operation-&gt;<a class="code" href="struct____TEE__OperationHandle.html#a1143afc5ba92c02e9e3ee751c585cace">keyValue</a> = (<a class="code" href="sw__types_8h.html#aed742c436da53c1080638ce6ef7d13de">u8</a>*)<a class="code" href="sw__buddy_8h.html#a66652368e6d05f18bdc4be02b0c62694">sw_malloc</a>(key-&gt;<a class="code" href="struct____TEE__ObjectHandle.html#a0aaa3d54773c38d5db99a6a06b75230d">dataLen</a>)) == <a class="code" href="sw__types_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) {</div>
<div class="line">                        <span class="keywordflow">return</span>(<a class="code" href="otz__tee__api_8h.html#a586a43c1886aa09dc9541fb66e6d8d7fac4927fa5eae4d0446bb2aa422f0d244f">TEEC_ERROR_OUT_OF_MEMORY</a>);</div>
<div class="line">                }</div>
<div class="line">                <a class="code" href="libc__sos_8h.html#a6b3ecd2ddb1fd4d219b4839d0561d11b">memcpy</a>(operation-&gt;<a class="code" href="struct____TEE__OperationHandle.html#a1143afc5ba92c02e9e3ee751c585cace">keyValue</a>,key-&gt;<a class="code" href="struct____TEE__ObjectHandle.html#a75b46fb067bec602da788b547b1221bd">dataPtr</a>,key-&gt;<a class="code" href="struct____TEE__ObjectHandle.html#a0aaa3d54773c38d5db99a6a06b75230d">dataLen</a>);</div>
<div class="line">                operation-&gt;<a class="code" href="struct____TEE__OperationHandle.html#ae445a64709be52b51708acbf247f2210">keySize</a> = key-&gt;<a class="code" href="struct____TEE__ObjectHandle.html#a0aaa3d54773c38d5db99a6a06b75230d">dataLen</a>;</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">if</span>((operation-&gt;<a class="code" href="struct____TEE__OperationHandle.html#aabd85e41a59abec4e8ba16147636a982">operationClass</a> == <a class="code" href="otz__tee__crypto__api_8h.html#ad0c73c650876132dcd7cc6309bf8c2b9a37f7b80ca7f4cc2e049fb205bf46a950">TEE_OPERATION_AE</a>) ||</div>
<div class="line">                        (operation-&gt;<a class="code" href="struct____TEE__OperationHandle.html#a4750f19edd1529680f9899db1da0f445">algorithm</a> == <a class="code" href="otz__tee__crypto__api_8h.html#a3fb37fc937a1cbad38ddb0279a4cca2da11b384ccb3cc9ed5a421332660096b17">TEE_ALG_AES_CTS</a>))  {</div>
<div class="line">                <span class="keywordflow">if</span>((operation-&gt;<a class="code" href="struct____TEE__OperationHandle.html#a1143afc5ba92c02e9e3ee751c585cace">keyValue</a> = (AES_KEY*)<a class="code" href="sw__buddy_8h.html#a66652368e6d05f18bdc4be02b0c62694">sw_malloc</a>(<span class="keyword">sizeof</span>(AES_KEY))) == <a class="code" href="sw__types_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) {</div>
<div class="line">                        <span class="keywordflow">return</span>(<a class="code" href="otz__tee__api_8h.html#a586a43c1886aa09dc9541fb66e6d8d7fac4927fa5eae4d0446bb2aa422f0d244f">TEEC_ERROR_OUT_OF_MEMORY</a>);</div>
<div class="line">                }</div>
<div class="line">                <span class="keywordflow">if</span>(operation-&gt;<a class="code" href="struct____TEE__OperationHandle.html#ad399557c4571d3b2e41d81632803ed70">mode</a> == <a class="code" href="otz__tee__crypto__api_8h.html#a883ffc5fb861ac33d91c7a8058d59744aa20104f46a28d0fe8596fec000b93fb0">TEE_MODE_DECRYPT</a>) {</div>
<div class="line">                        AES_set_decrypt_key(key-&gt;<a class="code" href="struct____TEE__ObjectHandle.html#a75b46fb067bec602da788b547b1221bd">dataPtr</a>,key-&gt;<a class="code" href="struct____TEE__ObjectHandle.html#a0aaa3d54773c38d5db99a6a06b75230d">dataLen</a>,operation-&gt;<a class="code" href="struct____TEE__OperationHandle.html#a1143afc5ba92c02e9e3ee751c585cace">keyValue</a>);</div>
<div class="line">                } <span class="keywordflow">else</span> <span class="keywordflow">if</span>(operation-&gt;<a class="code" href="struct____TEE__OperationHandle.html#ad399557c4571d3b2e41d81632803ed70">mode</a> == <a class="code" href="otz__tee__crypto__api_8h.html#a883ffc5fb861ac33d91c7a8058d59744ae986e0ac521db4f424b1c1fae66778c9">TEE_MODE_ENCRYPT</a>) {</div>
<div class="line">                        AES_set_encrypt_key(key-&gt;<a class="code" href="struct____TEE__ObjectHandle.html#a75b46fb067bec602da788b547b1221bd">dataPtr</a>,key-&gt;<a class="code" href="struct____TEE__ObjectHandle.html#a0aaa3d54773c38d5db99a6a06b75230d">dataLen</a>,operation-&gt;<a class="code" href="struct____TEE__OperationHandle.html#a1143afc5ba92c02e9e3ee751c585cace">keyValue</a>);</div>
<div class="line">                }</div>
<div class="line">                operation-&gt;<a class="code" href="struct____TEE__OperationHandle.html#ae445a64709be52b51708acbf247f2210">keySize</a> = key-&gt;<a class="code" href="struct____TEE__ObjectHandle.html#a0aaa3d54773c38d5db99a6a06b75230d">dataLen</a>;</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">if</span>((operation-&gt;<a class="code" href="struct____TEE__OperationHandle.html#aabd85e41a59abec4e8ba16147636a982">operationClass</a> == <a class="code" href="otz__tee__crypto__api_8h.html#ad0c73c650876132dcd7cc6309bf8c2b9aea1e65b9a3f86e8aa0c3537c510aaf65">TEE_OPERATION_ASYMMETRIC_CIPHER</a>) &amp;&amp;</div>
<div class="line">                ((operation-&gt;<a class="code" href="struct____TEE__OperationHandle.html#a4750f19edd1529680f9899db1da0f445">algorithm</a> == <a class="code" href="otz__tee__crypto__api_8h.html#a3fb37fc937a1cbad38ddb0279a4cca2dae9f210efdb8a6d22d22982a0ef9efbd1">TEE_ALG_RSAES_PKCS1_V1_5</a>) ||</div>
<div class="line">                        (operation-&gt;<a class="code" href="struct____TEE__OperationHandle.html#a4750f19edd1529680f9899db1da0f445">algorithm</a> == <a class="code" href="otz__tee__crypto__api_8h.html#a3fb37fc937a1cbad38ddb0279a4cca2da650d1d6a0a4e71b2cb2a3582afc0f44f">TEE_ALG_RSA_NOPAD</a>))) {</div>
<div class="line">                <span class="keywordflow">if</span>((retVal = fillRSAKeys(operation,key)) != <a class="code" href="otz__tee__api_8h.html#a586a43c1886aa09dc9541fb66e6d8d7fa4d19c2c024e37edc5f04892bb6739dbe">TEEC_SUCCESS</a>) {</div>
<div class="line">                        <span class="keywordflow">return</span>(retVal);</div>
<div class="line">                }</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">if</span>((operation-&gt;<a class="code" href="struct____TEE__OperationHandle.html#aabd85e41a59abec4e8ba16147636a982">operationClass</a> == <a class="code" href="otz__tee__crypto__api_8h.html#ad0c73c650876132dcd7cc6309bf8c2b9a9a4d80739a0c9476b584e7207f7485a4">TEE_OPERATION_ASYMMETRIC_SIGNATURE</a>)) {</div>
<div class="line">                <span class="keywordflow">if</span>((operation-&gt;<a class="code" href="struct____TEE__OperationHandle.html#a4750f19edd1529680f9899db1da0f445">algorithm</a> == <a class="code" href="otz__tee__crypto__api_8h.html#a3fb37fc937a1cbad38ddb0279a4cca2daa7fe10548e4a524810f226b0b0e9b2ef">TEE_ALG_RSASSA_PKCS1_V1_5_MD5</a>) ||</div>
<div class="line">                        (operation-&gt;<a class="code" href="struct____TEE__OperationHandle.html#a4750f19edd1529680f9899db1da0f445">algorithm</a> == <a class="code" href="otz__tee__crypto__api_8h.html#a3fb37fc937a1cbad38ddb0279a4cca2da63f0d0ffe7c4a747ff3de3fde48a7a68">TEE_ALG_RSASSA_PKCS1_V1_5_SHA1</a>)) {</div>
<div class="line">                        <span class="keywordflow">if</span>((retVal = fillRSAKeys(operation,key)) != <a class="code" href="otz__tee__api_8h.html#a586a43c1886aa09dc9541fb66e6d8d7fa4d19c2c024e37edc5f04892bb6739dbe">TEEC_SUCCESS</a>) {</div>
<div class="line">                                <span class="keywordflow">return</span>(retVal);</div>
<div class="line">                        }</div>
<div class="line">                } <span class="keywordflow">else</span> <span class="keywordflow">if</span>(operation-&gt;<a class="code" href="struct____TEE__OperationHandle.html#a4750f19edd1529680f9899db1da0f445">algorithm</a> == <a class="code" href="otz__tee__crypto__api_8h.html#a3fb37fc937a1cbad38ddb0279a4cca2daa1817df024be65f38f7d43af0d9a341b">TEE_ALG_DSA_SHA1</a>) {</div>
<div class="line">                        <span class="keywordflow">if</span>((operation-&gt;<a class="code" href="struct____TEE__OperationHandle.html#a1143afc5ba92c02e9e3ee751c585cace">keyValue</a> = DSA_generate_parameters(<a class="code" href="otz__tee__crypto__api_8h.html#ab142512efb5942034ea23150e984063b" title="This is the size of the key that would be used for DSA.">SW_DSA_KEYLEN</a>,</div>
<div class="line">                        <a class="code" href="sw__types_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>,0,<a class="code" href="sw__types_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>,<a class="code" href="sw__types_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>,<a class="code" href="sw__types_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>,<a class="code" href="sw__types_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)) == <a class="code" href="sw__types_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) {</div>
<div class="line">                                operation-&gt;<a class="code" href="struct____TEE__OperationHandle.html#ae445a64709be52b51708acbf247f2210">keySize</a> = operation-&gt;<a class="code" href="struct____TEE__OperationHandle.html#a6fbb10608e0f1145a70e1a4368081706">maxKeySize</a> = 0;</div>
<div class="line">                                <span class="keywordflow">return</span>(<a class="code" href="otz__tee__api_8h.html#a586a43c1886aa09dc9541fb66e6d8d7fa4b7583ef234ccb0ef6f7492ee6e8200d">TEEC_ERROR_BAD_PARAMETERS</a>);</div>
<div class="line">                        }</div>
<div class="line">                        operation-&gt;<a class="code" href="struct____TEE__OperationHandle.html#ae445a64709be52b51708acbf247f2210">keySize</a> = operation-&gt;<a class="code" href="struct____TEE__OperationHandle.html#a6fbb10608e0f1145a70e1a4368081706">maxKeySize</a> = <a class="code" href="otz__tee__crypto__api_8h.html#ab142512efb5942034ea23150e984063b" title="This is the size of the key that would be used for DSA.">SW_DSA_KEYLEN</a>;</div>
<div class="line">                }</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">return</span>(<a class="code" href="otz__tee__api_8h.html#a586a43c1886aa09dc9541fb66e6d8d7fa4d19c2c024e37edc5f04892bb6739dbe">TEEC_SUCCESS</a>);</div>
<div class="line">}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="aed1be97cdf1711948daa246802d11dec"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="otz__tee__api_8h.html#a586a43c1886aa09dc9541fb66e6d8d7f">TEEC_Result</a> TEE_SetOperationKey2 </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="otz__tee__crypto__api_8h.html#a003ccda0ce6a2d7889b2933a201e2bd1">TEE_OperationHandle</a>&#160;</td>
          <td class="paramname"><em>operation</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="otz__api_8h.html#a6a2cfeba38a0f61d5937bcc8cf04b9a2">TEE_ObjectHandle</a> *&#160;</td>
          <td class="paramname"><em>key1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="otz__api_8h.html#a6a2cfeba38a0f61d5937bcc8cf04b9a2">TEE_ObjectHandle</a> *&#160;</td>
          <td class="paramname"><em>key2</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">operation</td><td></td></tr>
    <tr><td class="paramname">key1</td><td></td></tr>
    <tr><td class="paramname">key2</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd></dd></dl>

<p>Definition at line <a class="el" href="otz__tee__crypto__api_8c_source.html#l00853">853</a> of file <a class="el" href="otz__tee__crypto__api_8c_source.html">otz_tee_crypto_api.c</a>.</p>
<div class="fragment"><div class="line">{</div>
<div class="line">        <span class="keywordflow">if</span>(operation == <a class="code" href="sw__types_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) {</div>
<div class="line">                <span class="keywordflow">return</span>(<a class="code" href="otz__tee__api_8h.html#a586a43c1886aa09dc9541fb66e6d8d7fa4b7583ef234ccb0ef6f7492ee6e8200d">TEEC_ERROR_BAD_PARAMETERS</a>);</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">if</span>(key1 == <a class="code" href="sw__types_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a> || key2 == <a class="code" href="sw__types_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) {</div>
<div class="line">                <a class="code" href="otz__tee__crypto__api_8h.html#a25a6ed042b2e933aeae3c26727987811">TEE_Panic</a>(<a class="code" href="otz__tee__api_8h.html#a586a43c1886aa09dc9541fb66e6d8d7fa4b7583ef234ccb0ef6f7492ee6e8200d">TEEC_ERROR_BAD_PARAMETERS</a>);</div>
<div class="line">                <span class="keywordflow">return</span>(<a class="code" href="otz__tee__api_8h.html#a586a43c1886aa09dc9541fb66e6d8d7fa4b7583ef234ccb0ef6f7492ee6e8200d">TEEC_ERROR_BAD_PARAMETERS</a>);</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">if</span>(operation-&gt;<a class="code" href="struct____TEE__OperationHandle.html#ad399557c4571d3b2e41d81632803ed70">mode</a> == <a class="code" href="otz__tee__crypto__api_8h.html#a883ffc5fb861ac33d91c7a8058d59744a14fd1dd01b612be722995b8753a9ced3">TEE_MODE_DIGEST</a>) {</div>
<div class="line">                <a class="code" href="otz__tee__crypto__api_8h.html#a25a6ed042b2e933aeae3c26727987811">TEE_Panic</a>(<a class="code" href="otz__tee__api_8h.html#a586a43c1886aa09dc9541fb66e6d8d7fa4b7583ef234ccb0ef6f7492ee6e8200d">TEEC_ERROR_BAD_PARAMETERS</a>);</div>
<div class="line">                <span class="keywordflow">return</span>(<a class="code" href="otz__tee__api_8h.html#a586a43c1886aa09dc9541fb66e6d8d7fa4b7583ef234ccb0ef6f7492ee6e8200d">TEEC_ERROR_BAD_PARAMETERS</a>);</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">if</span>(operation-&gt;<a class="code" href="struct____TEE__OperationHandle.html#a4750f19edd1529680f9899db1da0f445">algorithm</a> == <a class="code" href="otz__tee__crypto__api_8h.html#a3fb37fc937a1cbad38ddb0279a4cca2da4e1c7084aac77abb91dd78c925075536">TEE_ALG_AES_XTS</a>) {</div>
<div class="line">                <a class="code" href="otz__tee__crypto__api_8h.html#a25a6ed042b2e933aeae3c26727987811">TEE_Panic</a>(<a class="code" href="otz__tee__api_8h.html#a586a43c1886aa09dc9541fb66e6d8d7fa4b7583ef234ccb0ef6f7492ee6e8200d">TEEC_ERROR_BAD_PARAMETERS</a>);</div>
<div class="line">                <span class="keywordflow">return</span>(<a class="code" href="otz__tee__api_8h.html#a586a43c1886aa09dc9541fb66e6d8d7fa4b7583ef234ccb0ef6f7492ee6e8200d">TEEC_ERROR_BAD_PARAMETERS</a>);</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">return</span>(<a class="code" href="otz__tee__api_8h.html#a586a43c1886aa09dc9541fb66e6d8d7fa4d19c2c024e37edc5f04892bb6739dbe">TEEC_SUCCESS</a>);</div>
<div class="line">}</div>
</div><!-- fragment -->
</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Thu Jan 3 2013 00:33:52 by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.2
</small></address>
</body>
</html>
