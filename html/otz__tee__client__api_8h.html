<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>otz_tee_client_api.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<!-- end header part -->
<!-- Generated by Doxygen 1.8.2 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_d44c64559bbebec7f509842c48db8b23.html">include</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#define-members">Macros</a> &#124;
<a href="#typedef-members">Typedefs</a> &#124;
<a href="#enum-members">Enumerations</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">otz_tee_client_api.h File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &lt;<a class="el" href="sw__list_8h_source.html">sw_list.h</a>&gt;</code><br/>
<code>#include &lt;<a class="el" href="otz__tee__api_8h_source.html">otz_tee_api.h</a>&gt;</code><br/>
</div>
<p><a href="otz__tee__client__api_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structTEEC__Session.html">TEEC_Session</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">The <a class="el" href="structTEEC__Session.html" title="The TEEC_Session structure is used to contain control information related to a session between a clie...">TEEC_Session</a> structure is used to contain control information related to a session between a client and a service.  <a href="structTEEC__Session.html#details">More...</a><br/></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structTEEC__Context.html">TEEC_Context</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">The <a class="el" href="structTEEC__Context.html" title="The TEEC_Context structure is used to contain control information related to the TEE.">TEEC_Context</a> structure is used to contain control information related to the TEE.  <a href="structTEEC__Context.html#details">More...</a><br/></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structTEEC__SharedMemory.html">TEEC_SharedMemory</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">The <a class="el" href="structTEEC__SharedMemory.html" title="The TEEC_SharedMemory structure is used to contain control information related to a block of shared m...">TEEC_SharedMemory</a> structure is used to contain control information related to a block of shared memory that is mapped between the client and the service.  <a href="structTEEC__SharedMemory.html#details">More...</a><br/></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structTEEC__Value.html">TEEC_Value</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Small raw data value type.  <a href="structTEEC__Value.html#details">More...</a><br/></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structTEEC__TempMemoryReference.html">TEEC_TempMemoryReference</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Temporary shared memory reference.  <a href="structTEEC__TempMemoryReference.html#details">More...</a><br/></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structTEEC__RegisteredMemoryReference.html">TEEC_RegisteredMemoryReference</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Registered memory reference.  <a href="structTEEC__RegisteredMemoryReference.html#details">More...</a><br/></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">union &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="unionTEEC__Parameter.html">TEEC_Parameter</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Parameter of a <a class="el" href="structTEEC__Operation.html" title="The TEEC_Operation structure is used to contain control information related to an operation that is t...">TEEC_Operation</a>.  <a href="unionTEEC__Parameter.html#details">More...</a><br/></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structTEEC__Operation.html">TEEC_Operation</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">The <a class="el" href="structTEEC__Operation.html" title="The TEEC_Operation structure is used to contain control information related to an operation that is t...">TEEC_Operation</a> structure is used to contain control information related to an operation that is to be invoked with the security environment.  <a href="structTEEC__Operation.html#details">More...</a><br/></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:a635a75a61ec3b66d6cd970314b27c0ce"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="otz__tee__client__api_8h.html#a635a75a61ec3b66d6cd970314b27c0ce">MAX_SESSIONS_PER_DEVICE</a>&#160;&#160;&#160;16</td></tr>
<tr class="separator:a635a75a61ec3b66d6cd970314b27c0ce"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad512d4f7244cd23759f09d8feb379ce2"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="otz__tee__client__api_8h.html#ad512d4f7244cd23759f09d8feb379ce2">MAX_OPERATIONS_PER_SESSION</a>&#160;&#160;&#160;16</td></tr>
<tr class="separator:ad512d4f7244cd23759f09d8feb379ce2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae2021798c8fad5fe5ad5a59c22efb697"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="otz__tee__client__api_8h.html#ae2021798c8fad5fe5ad5a59c22efb697">MAX_MEMBLOCKS_PER_SESSION</a>&#160;&#160;&#160;16</td></tr>
<tr class="separator:ae2021798c8fad5fe5ad5a59c22efb697"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a12bcf1760a725c67f750d606944ae8ca"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="otz__tee__client__api_8h.html#a12bcf1760a725c67f750d606944ae8ca">MAX_MEMBLOCKS_PER_OPERATION</a>&#160;&#160;&#160;4</td></tr>
<tr class="separator:a12bcf1760a725c67f750d606944ae8ca"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a12c33840ad3d1701675ed9a2f50ae3b5"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="otz__tee__client__api_8h.html#a12c33840ad3d1701675ed9a2f50ae3b5">TEEC_PARAM_TYPES</a>(param0Type, param1Type, param2Type, param3Type)&#160;&#160;&#160;(param3Type &lt;&lt; 12 | param2Type &lt;&lt; 8 | param1Type &lt;&lt; 4 | param0Type)</td></tr>
<tr class="separator:a12c33840ad3d1701675ed9a2f50ae3b5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8cee8c3207cf162f74fe0e6832640a72"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="otz__tee__client__api_8h.html#a8cee8c3207cf162f74fe0e6832640a72">TEEC_VALUE_UNDEF</a>&#160;&#160;&#160;0xffffffff</td></tr>
<tr class="separator:a8cee8c3207cf162f74fe0e6832640a72"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="typedef-members"></a>
Typedefs</h2></td></tr>
<tr class="memitem:a4c30c4c5327b8e2dc61ef9006b66a8a8"><td class="memItemLeft" align="right" valign="top">typedef struct <a class="el" href="structTEEC__Operation.html">TEEC_Operation</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="otz__tee__client__api_8h.html#a4c30c4c5327b8e2dc61ef9006b66a8a8">TEEC_Operation</a></td></tr>
<tr class="separator:a4c30c4c5327b8e2dc61ef9006b66a8a8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5cc1338f1a154a28620da49cef4aa2ee"><td class="memItemLeft" align="right" valign="top">typedef struct <a class="el" href="structTEEC__Session.html">TEEC_Session</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="otz__tee__client__api_8h.html#a5cc1338f1a154a28620da49cef4aa2ee">TEEC_Session</a></td></tr>
<tr class="separator:a5cc1338f1a154a28620da49cef4aa2ee"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a29b1302fc4bfe8f37a529e0b47680450"><td class="memItemLeft" align="right" valign="top">typedef struct <a class="el" href="structTEEC__Context.html">TEEC_Context</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="otz__tee__client__api_8h.html#a29b1302fc4bfe8f37a529e0b47680450">TEEC_Context</a></td></tr>
<tr class="separator:a29b1302fc4bfe8f37a529e0b47680450"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a41a80a32a4e5d167a501a02bb73155b2"><td class="memItemLeft" align="right" valign="top">typedef struct <a class="el" href="structTEEC__SharedMemory.html">TEEC_SharedMemory</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="otz__tee__client__api_8h.html#a41a80a32a4e5d167a501a02bb73155b2">TEEC_SharedMemory</a></td></tr>
<tr class="separator:a41a80a32a4e5d167a501a02bb73155b2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1501ab7c9fa4f0e910683d5a37080a32"><td class="memItemLeft" align="right" valign="top">typedef struct <br class="typebreak"/>
<a class="el" href="structTEEC__TempMemoryReference.html">TEEC_TempMemoryReference</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="otz__tee__client__api_8h.html#a1501ab7c9fa4f0e910683d5a37080a32">TEEC_TempMemoryReference</a></td></tr>
<tr class="separator:a1501ab7c9fa4f0e910683d5a37080a32"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a94fdd74a8f7a005dfdac70ab38670f41"><td class="memItemLeft" align="right" valign="top">typedef struct <br class="typebreak"/>
<a class="el" href="structTEEC__RegisteredMemoryReference.html">TEEC_RegisteredMemoryReference</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="otz__tee__client__api_8h.html#a94fdd74a8f7a005dfdac70ab38670f41">TEEC_RegisteredMemoryReference</a></td></tr>
<tr class="separator:a94fdd74a8f7a005dfdac70ab38670f41"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abe8a2b29a8828e8d074a3df1a6227542"><td class="memItemLeft" align="right" valign="top">typedef struct <a class="el" href="structTEEC__Value.html">TEEC_Value</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="otz__tee__client__api_8h.html#abe8a2b29a8828e8d074a3df1a6227542">TEEC_Value</a></td></tr>
<tr class="separator:abe8a2b29a8828e8d074a3df1a6227542"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a361ded2dff83f4a00e85cdc7c8a04274"><td class="memItemLeft" align="right" valign="top">typedef <a class="el" href="otz__api_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="otz__tee__client__api_8h.html#a361ded2dff83f4a00e85cdc7c8a04274">TEEC_UUID</a></td></tr>
<tr class="separator:a361ded2dff83f4a00e85cdc7c8a04274"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="enum-members"></a>
Enumerations</h2></td></tr>
<tr class="memitem:a7cec7a0d1fa340adc3d3186b6eeb63fc"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="otz__tee__client__api_8h.html#a7cec7a0d1fa340adc3d3186b6eeb63fc">TEEC_return_code_origin</a> { <a class="el" href="otz__tee__client__api_8h.html#a7cec7a0d1fa340adc3d3186b6eeb63fca8f66dc5e481382d361fd654fb9e42ed1">TEEC_ORIGIN_API</a> = 0x1, 
<a class="el" href="otz__tee__client__api_8h.html#a7cec7a0d1fa340adc3d3186b6eeb63fca0d25fcbd36c2ae3afc02c1c3c447fcad">TEEC_ORIGIN_COMMS</a> = 0x2, 
<a class="el" href="otz__tee__client__api_8h.html#a7cec7a0d1fa340adc3d3186b6eeb63fca93200fb6850597016a7261d1a2877458">TEEC_ORIGIN_TEE</a> = 0x3, 
<a class="el" href="otz__tee__client__api_8h.html#a7cec7a0d1fa340adc3d3186b6eeb63fcac1e440c31589196e83b79353fcf5ebce">TEEC_ORIGIN_TRUSTED_APP</a> = 0x4
 }</td></tr>
<tr class="memdesc:a7cec7a0d1fa340adc3d3186b6eeb63fc"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return code origin.  <a href="otz__tee__client__api_8h.html#a7cec7a0d1fa340adc3d3186b6eeb63fc">More...</a><br/></td></tr>
<tr class="separator:a7cec7a0d1fa340adc3d3186b6eeb63fc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acea56784d3146198a50dca0fb5b2a7cd"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="otz__tee__client__api_8h.html#acea56784d3146198a50dca0fb5b2a7cd">TEEC_login_flags</a> { <br/>
&#160;&#160;<a class="el" href="otz__tee__client__api_8h.html#acea56784d3146198a50dca0fb5b2a7cda8bb5b8a7dfc0334f90ed7407dd4ddd9d">TEEC_LOGIN_PUBLIC</a> = 0x0, 
<a class="el" href="otz__tee__client__api_8h.html#acea56784d3146198a50dca0fb5b2a7cda8c6ad7380cec6f7fa09c852247f4abed">TEEC_LOGIN_USER</a>, 
<a class="el" href="otz__tee__client__api_8h.html#acea56784d3146198a50dca0fb5b2a7cdac1e52a37c3e8e6829c5e0c232756cc76">TEEC_LOGIN_GROUP</a>, 
<a class="el" href="otz__tee__client__api_8h.html#acea56784d3146198a50dca0fb5b2a7cda3cc79d313bb7bcb1aa9d52614682d08a">TEEC_LOGIN_APPLICATION</a> = 0x4, 
<br/>
&#160;&#160;<a class="el" href="otz__tee__client__api_8h.html#acea56784d3146198a50dca0fb5b2a7cda646983f0da4bbdd6f96d64681dd31e73">TEEC_LOGIN_USER_APPLICATION</a> = 0x5, 
<a class="el" href="otz__tee__client__api_8h.html#acea56784d3146198a50dca0fb5b2a7cda53642939ec71bb330122acdabff4bc22">TEEC_LOGIN_GROUP_APPLICATION</a> = 0x6
<br/>
 }</td></tr>
<tr class="memdesc:acea56784d3146198a50dca0fb5b2a7cd"><td class="mdescLeft">&#160;</td><td class="mdescRight">Login flag constants.  <a href="otz__tee__client__api_8h.html#acea56784d3146198a50dca0fb5b2a7cd">More...</a><br/></td></tr>
<tr class="separator:acea56784d3146198a50dca0fb5b2a7cd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad2ca265b0a012cb196691e4037b558dc"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="otz__tee__client__api_8h.html#ad2ca265b0a012cb196691e4037b558dc">TEEC_shared_mem_flags</a> { <a class="el" href="otz__tee__client__api_8h.html#ad2ca265b0a012cb196691e4037b558dca8407d60bc4211cd205bdf111c3ce512c">TEEC_MEM_INPUT</a> = 0x1, 
<a class="el" href="otz__tee__client__api_8h.html#ad2ca265b0a012cb196691e4037b558dca4d822f60ca1969d1513b14b2805b234e">TEEC_MEM_OUTPUT</a> = 0x2
 }</td></tr>
<tr class="memdesc:ad2ca265b0a012cb196691e4037b558dc"><td class="mdescLeft">&#160;</td><td class="mdescRight">Shared memory flag constants.  <a href="otz__tee__client__api_8h.html#ad2ca265b0a012cb196691e4037b558dc">More...</a><br/></td></tr>
<tr class="separator:ad2ca265b0a012cb196691e4037b558dc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a844239ef6fbb152b5e83b296be117fa9"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="otz__tee__client__api_8h.html#a844239ef6fbb152b5e83b296be117fa9">TEEC_param_type</a> { <br/>
&#160;&#160;<a class="el" href="otz__tee__client__api_8h.html#a844239ef6fbb152b5e83b296be117fa9a257e01b5d678ddeed940f39b9f17a764">TEEC_NONE</a> = 0x1, 
<a class="el" href="otz__tee__client__api_8h.html#a844239ef6fbb152b5e83b296be117fa9ae062e0502be2f5372812053a3d1fc031">TEEC_VALUE_INPUT</a>, 
<a class="el" href="otz__tee__client__api_8h.html#a844239ef6fbb152b5e83b296be117fa9ad8e807bd3166fb18b91917a42426323b">TEEC_VALUE_OUTPUT</a>, 
<a class="el" href="otz__tee__client__api_8h.html#a844239ef6fbb152b5e83b296be117fa9a0d3155a759f5f3ea299be0a493ee4924">TEEC_VALUE_INOUT</a>, 
<br/>
&#160;&#160;<a class="el" href="otz__tee__client__api_8h.html#a844239ef6fbb152b5e83b296be117fa9a08f93f6ac7c6615ff26838e8fa4e441d">TEEC_MEMREF_TEMP_INPUT</a>, 
<a class="el" href="otz__tee__client__api_8h.html#a844239ef6fbb152b5e83b296be117fa9a40a27415d0c255d58f1fad5287879785">TEEC_MEMREF_TEMP_OUTPUT</a>, 
<a class="el" href="otz__tee__client__api_8h.html#a844239ef6fbb152b5e83b296be117fa9a61b21cbecaf1827ddca58f49b2176748">TEEC_MEMREF_TEMP_INOUT</a>, 
<a class="el" href="otz__tee__client__api_8h.html#a844239ef6fbb152b5e83b296be117fa9a0fde2e095c933376a0360788e2dd7f90">TEEC_MEMREF_WHOLE</a> = 0xc, 
<br/>
&#160;&#160;<a class="el" href="otz__tee__client__api_8h.html#a844239ef6fbb152b5e83b296be117fa9a83a852a82f09a38ddd6358bf83084dda">TEEC_MEMREF_PARTIAL_INPUT</a> = 0xd, 
<a class="el" href="otz__tee__client__api_8h.html#a844239ef6fbb152b5e83b296be117fa9a3b0c66b1008718e5108fe84da60fafe0">TEEC_MEMREF_PARTIAL_OUTPUT</a> = 0xe, 
<a class="el" href="otz__tee__client__api_8h.html#a844239ef6fbb152b5e83b296be117fa9a530eefe7668b93a6e6a5e02d70233cd3">TEEC_MEMREF_PARTIAL_INOUT</a> = 0xf
<br/>
 }</td></tr>
<tr class="memdesc:a844239ef6fbb152b5e83b296be117fa9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Param type constants.  <a href="otz__tee__client__api_8h.html#a844239ef6fbb152b5e83b296be117fa9">More...</a><br/></td></tr>
<tr class="separator:a844239ef6fbb152b5e83b296be117fa9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0726f9cc52e17d8e6cd7dd085cc62527"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="otz__tee__client__api_8h.html#a0726f9cc52e17d8e6cd7dd085cc62527">otz_shared_mem_flags</a> { <br/>
&#160;&#160;<a class="el" href="otz__api_8h.html#a0726f9cc52e17d8e6cd7dd085cc62527a7aa74f7037354b0cd675442b600060c0">OTZ_MEM_SERVICE_RO</a> = 0x0, 
<a class="el" href="otz__api_8h.html#a0726f9cc52e17d8e6cd7dd085cc62527a8035deccf29fcd9fe345e3f3e0e4accb">OTZ_MEM_SERVICE_WO</a>, 
<a class="el" href="otz__api_8h.html#a0726f9cc52e17d8e6cd7dd085cc62527a33f6f503a1e274dc317a34352157100c">OTZ_MEM_SERVICE_RW</a>, 
<a class="el" href="otz__api_8h.html#a0726f9cc52e17d8e6cd7dd085cc62527aa462fe85425a0bde33600ba164e20325">OTZ_MEM_SERVICE_UNDEFINED</a>, 
<br/>
&#160;&#160;<a class="el" href="otz__tee__client__api_8h.html#a0726f9cc52e17d8e6cd7dd085cc62527a7aa74f7037354b0cd675442b600060c0">OTZ_MEM_SERVICE_RO</a> = 0x0, 
<a class="el" href="otz__tee__client__api_8h.html#a0726f9cc52e17d8e6cd7dd085cc62527a8035deccf29fcd9fe345e3f3e0e4accb">OTZ_MEM_SERVICE_WO</a>, 
<a class="el" href="otz__tee__client__api_8h.html#a0726f9cc52e17d8e6cd7dd085cc62527a33f6f503a1e274dc317a34352157100c">OTZ_MEM_SERVICE_RW</a>, 
<a class="el" href="otz__tee__client__api_8h.html#a0726f9cc52e17d8e6cd7dd085cc62527aa462fe85425a0bde33600ba164e20325">OTZ_MEM_SERVICE_UNDEFINED</a>
<br/>
 }</td></tr>
<tr class="memdesc:a0726f9cc52e17d8e6cd7dd085cc62527"><td class="mdescLeft">&#160;</td><td class="mdescRight">Shared memory flag constants.  <a href="otz__tee__client__api_8h.html#a0726f9cc52e17d8e6cd7dd085cc62527">More...</a><br/></td></tr>
<tr class="separator:a0726f9cc52e17d8e6cd7dd085cc62527"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a3e9d47511b2b76ec947655708cca039f"><td class="memItemLeft" align="right" valign="top"><a class="el" href="otz__tee__api_8h.html#a586a43c1886aa09dc9541fb66e6d8d7f">TEEC_Result</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="otz__tee__client__api_8h.html#a3e9d47511b2b76ec947655708cca039f">TEEC_InitializeContext</a> (const char *name, <a class="el" href="structTEEC__Context.html">TEEC_Context</a> *context)</td></tr>
<tr class="memdesc:a3e9d47511b2b76ec947655708cca039f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialize Context.  <a href="#a3e9d47511b2b76ec947655708cca039f"></a><br/></td></tr>
<tr class="separator:a3e9d47511b2b76ec947655708cca039f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8ff39851efe335623922e6f800f3113b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="otz__tee__client__api_8h.html#a8ff39851efe335623922e6f800f3113b">TEEC_FinalizeContext</a> (<a class="el" href="structTEEC__Context.html">TEEC_Context</a> *context)</td></tr>
<tr class="memdesc:a8ff39851efe335623922e6f800f3113b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Finalizes an initialized TEE context.  <a href="#a8ff39851efe335623922e6f800f3113b"></a><br/></td></tr>
<tr class="separator:a8ff39851efe335623922e6f800f3113b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae95c1a0a68654f50a280d94581859d76"><td class="memItemLeft" align="right" valign="top"><a class="el" href="otz__tee__api_8h.html#a586a43c1886aa09dc9541fb66e6d8d7f">TEEC_Result</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="otz__tee__client__api_8h.html#ae95c1a0a68654f50a280d94581859d76">TEEC_RegisterSharedMemory</a> (<a class="el" href="structTEEC__Context.html">TEEC_Context</a> *context, <a class="el" href="structTEEC__SharedMemory.html">TEEC_SharedMemory</a> *sharedMem)</td></tr>
<tr class="memdesc:ae95c1a0a68654f50a280d94581859d76"><td class="mdescLeft">&#160;</td><td class="mdescRight">Register a allocated shared memory block.  <a href="#ae95c1a0a68654f50a280d94581859d76"></a><br/></td></tr>
<tr class="separator:ae95c1a0a68654f50a280d94581859d76"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8358037528cb0d29d57f1da4fdb12d23"><td class="memItemLeft" align="right" valign="top"><a class="el" href="otz__tee__api_8h.html#a586a43c1886aa09dc9541fb66e6d8d7f">TEEC_Result</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="otz__tee__client__api_8h.html#a8358037528cb0d29d57f1da4fdb12d23">TEEC_AllocateSharedMemory</a> (<a class="el" href="structTEEC__Context.html">TEEC_Context</a> *context, <a class="el" href="structTEEC__SharedMemory.html">TEEC_SharedMemory</a> *sharedMem)</td></tr>
<tr class="memdesc:a8358037528cb0d29d57f1da4fdb12d23"><td class="mdescLeft">&#160;</td><td class="mdescRight">Allocate a shared memory block.  <a href="#a8358037528cb0d29d57f1da4fdb12d23"></a><br/></td></tr>
<tr class="separator:a8358037528cb0d29d57f1da4fdb12d23"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a28ced54521d6576f50cbd8743dbfa1e9"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="otz__tee__client__api_8h.html#a28ced54521d6576f50cbd8743dbfa1e9">TEEC_ReleaseSharedMemory</a> (<a class="el" href="structTEEC__SharedMemory.html">TEEC_SharedMemory</a> *sharedMem)</td></tr>
<tr class="memdesc:a28ced54521d6576f50cbd8743dbfa1e9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Release a shared memory block.  <a href="#a28ced54521d6576f50cbd8743dbfa1e9"></a><br/></td></tr>
<tr class="separator:a28ced54521d6576f50cbd8743dbfa1e9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2e057c67c5ec43b8052ad89809929e61"><td class="memItemLeft" align="right" valign="top"><a class="el" href="otz__tee__api_8h.html#a586a43c1886aa09dc9541fb66e6d8d7f">TEEC_Result</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="otz__tee__client__api_8h.html#a2e057c67c5ec43b8052ad89809929e61">TEEC_OpenSession</a> (<a class="el" href="structTEEC__Context.html">TEEC_Context</a> *context, <a class="el" href="structTEEC__Session.html">TEEC_Session</a> *session, const <a class="el" href="otz__tee__client__api_8h.html#a361ded2dff83f4a00e85cdc7c8a04274">TEEC_UUID</a> *destination, <a class="el" href="otz__api_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> connectionMethod, const void *connectionData, <a class="el" href="structTEEC__Operation.html">TEEC_Operation</a> *operation, <a class="el" href="otz__api_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> *returnOrigin)</td></tr>
<tr class="memdesc:a2e057c67c5ec43b8052ad89809929e61"><td class="mdescLeft">&#160;</td><td class="mdescRight">Opens a new session between client and trusted application.  <a href="#a2e057c67c5ec43b8052ad89809929e61"></a><br/></td></tr>
<tr class="separator:a2e057c67c5ec43b8052ad89809929e61"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abbd4e86c7d7a2830b66dd1c455e57708"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="otz__tee__client__api_8h.html#abbd4e86c7d7a2830b66dd1c455e57708">TEEC_CloseSession</a> (<a class="el" href="structTEEC__Session.html">TEEC_Session</a> *session)</td></tr>
<tr class="memdesc:abbd4e86c7d7a2830b66dd1c455e57708"><td class="mdescLeft">&#160;</td><td class="mdescRight">Close a opened session between client and trusted application.  <a href="#abbd4e86c7d7a2830b66dd1c455e57708"></a><br/></td></tr>
<tr class="separator:abbd4e86c7d7a2830b66dd1c455e57708"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a33d421ce57c64600db759fe55bd0541e"><td class="memItemLeft" align="right" valign="top"><a class="el" href="otz__tee__api_8h.html#a586a43c1886aa09dc9541fb66e6d8d7f">TEEC_Result</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="otz__tee__client__api_8h.html#a33d421ce57c64600db759fe55bd0541e">TEEC_InvokeCommand</a> (<a class="el" href="structTEEC__Session.html">TEEC_Session</a> *session, <a class="el" href="otz__api_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> commandID, <a class="el" href="structTEEC__Operation.html">TEEC_Operation</a> *operation, <a class="el" href="otz__api_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> *returnOrigin)</td></tr>
<tr class="memdesc:a33d421ce57c64600db759fe55bd0541e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Invokes a command within the session.  <a href="#a33d421ce57c64600db759fe55bd0541e"></a><br/></td></tr>
<tr class="separator:a33d421ce57c64600db759fe55bd0541e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab0f689a7da4d607e46fe9f8d7dba277c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="otz__tee__client__api_8h.html#ab0f689a7da4d607e46fe9f8d7dba277c">TEEC_RequestCancellation</a> (<a class="el" href="structTEEC__Operation.html">TEEC_Operation</a> *operation)</td></tr>
<tr class="memdesc:ab0f689a7da4d607e46fe9f8d7dba277c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Request cancellation of pending open session or command invocation.  <a href="#ab0f689a7da4d607e46fe9f8d7dba277c"></a><br/></td></tr>
<tr class="separator:ab0f689a7da4d607e46fe9f8d7dba277c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a015f78683598134139320994260db34c"><td class="memItemLeft" align="right" valign="top">char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="otz__tee__client__api_8h.html#a015f78683598134139320994260db34c">TEEC_GetError</a> (int error, int returnOrigin)</td></tr>
<tr class="memdesc:a015f78683598134139320994260db34c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns error string.  <a href="#a015f78683598134139320994260db34c"></a><br/></td></tr>
<tr class="separator:a015f78683598134139320994260db34c"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Macro Definition Documentation</h2>
<a class="anchor" id="a12bcf1760a725c67f750d606944ae8ca"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define MAX_MEMBLOCKS_PER_OPERATION&#160;&#160;&#160;4</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="otz__tee__client__api_8h_source.html#l00031">31</a> of file <a class="el" href="otz__tee__client__api_8h_source.html">otz_tee_client_api.h</a>.</p>

</div>
</div>
<a class="anchor" id="ae2021798c8fad5fe5ad5a59c22efb697"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define MAX_MEMBLOCKS_PER_SESSION&#160;&#160;&#160;16</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="otz__tee__client__api_8h_source.html#l00030">30</a> of file <a class="el" href="otz__tee__client__api_8h_source.html">otz_tee_client_api.h</a>.</p>

</div>
</div>
<a class="anchor" id="ad512d4f7244cd23759f09d8feb379ce2"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define MAX_OPERATIONS_PER_SESSION&#160;&#160;&#160;16</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="otz__tee__client__api_8h_source.html#l00029">29</a> of file <a class="el" href="otz__tee__client__api_8h_source.html">otz_tee_client_api.h</a>.</p>

</div>
</div>
<a class="anchor" id="a635a75a61ec3b66d6cd970314b27c0ce"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define MAX_SESSIONS_PER_DEVICE&#160;&#160;&#160;16</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="otz__tee__client__api_8h_source.html#l00028">28</a> of file <a class="el" href="otz__tee__client__api_8h_source.html">otz_tee_client_api.h</a>.</p>

</div>
</div>
<a class="anchor" id="a12c33840ad3d1701675ed9a2f50ae3b5"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define TEEC_PARAM_TYPES</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">param0Type, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">param1Type, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">param2Type, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">param3Type&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td>&#160;&#160;&#160;(param3Type &lt;&lt; 12 | param2Type &lt;&lt; 8 | param1Type &lt;&lt; 4 | param0Type)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="otz__tee__client__api_8h_source.html#l00034">34</a> of file <a class="el" href="otz__tee__client__api_8h_source.html">otz_tee_client_api.h</a>.</p>

</div>
</div>
<a class="anchor" id="a8cee8c3207cf162f74fe0e6832640a72"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define TEEC_VALUE_UNDEF&#160;&#160;&#160;0xffffffff</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="otz__tee__client__api_8h_source.html#l00037">37</a> of file <a class="el" href="otz__tee__client__api_8h_source.html">otz_tee_client_api.h</a>.</p>

</div>
</div>
<h2 class="groupheader">Typedef Documentation</h2>
<a class="anchor" id="a29b1302fc4bfe8f37a529e0b47680450"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef struct <a class="el" href="structTEEC__Context.html">TEEC_Context</a> <a class="el" href="structTEEC__Context.html">TEEC_Context</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="otz__tee__client__api_8h_source.html#l00167">167</a> of file <a class="el" href="otz__tee__client__api_8h_source.html">otz_tee_client_api.h</a>.</p>

</div>
</div>
<a class="anchor" id="a4c30c4c5327b8e2dc61ef9006b66a8a8"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef struct <a class="el" href="structTEEC__Operation.html">TEEC_Operation</a> <a class="el" href="structTEEC__Operation.html">TEEC_Operation</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="otz__tee__client__api_8h_source.html#l00159">159</a> of file <a class="el" href="otz__tee__client__api_8h_source.html">otz_tee_client_api.h</a>.</p>

</div>
</div>
<a class="anchor" id="a94fdd74a8f7a005dfdac70ab38670f41"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef struct <a class="el" href="structTEEC__RegisteredMemoryReference.html">TEEC_RegisteredMemoryReference</a> <a class="el" href="structTEEC__RegisteredMemoryReference.html">TEEC_RegisteredMemoryReference</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="otz__tee__client__api_8h_source.html#l00179">179</a> of file <a class="el" href="otz__tee__client__api_8h_source.html">otz_tee_client_api.h</a>.</p>

</div>
</div>
<a class="anchor" id="a5cc1338f1a154a28620da49cef4aa2ee"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef struct <a class="el" href="structTEEC__Session.html">TEEC_Session</a> <a class="el" href="structTEEC__Session.html">TEEC_Session</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="otz__tee__client__api_8h_source.html#l00163">163</a> of file <a class="el" href="otz__tee__client__api_8h_source.html">otz_tee_client_api.h</a>.</p>

</div>
</div>
<a class="anchor" id="a41a80a32a4e5d167a501a02bb73155b2"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef struct <a class="el" href="structTEEC__SharedMemory.html">TEEC_SharedMemory</a> <a class="el" href="structTEEC__SharedMemory.html">TEEC_SharedMemory</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="otz__tee__client__api_8h_source.html#l00171">171</a> of file <a class="el" href="otz__tee__client__api_8h_source.html">otz_tee_client_api.h</a>.</p>

</div>
</div>
<a class="anchor" id="a1501ab7c9fa4f0e910683d5a37080a32"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef struct <a class="el" href="structTEEC__TempMemoryReference.html">TEEC_TempMemoryReference</a> <a class="el" href="structTEEC__TempMemoryReference.html">TEEC_TempMemoryReference</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="otz__tee__client__api_8h_source.html#l00175">175</a> of file <a class="el" href="otz__tee__client__api_8h_source.html">otz_tee_client_api.h</a>.</p>

</div>
</div>
<a class="anchor" id="a361ded2dff83f4a00e85cdc7c8a04274"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef <a class="el" href="otz__api_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> <a class="el" href="otz__tee__client__api_8h.html#a361ded2dff83f4a00e85cdc7c8a04274">TEEC_UUID</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="otz__tee__client__api_8h_source.html#l00202">202</a> of file <a class="el" href="otz__tee__client__api_8h_source.html">otz_tee_client_api.h</a>.</p>

</div>
</div>
<a class="anchor" id="abe8a2b29a8828e8d074a3df1a6227542"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef struct <a class="el" href="structTEEC__Value.html">TEEC_Value</a> <a class="el" href="structTEEC__Value.html">TEEC_Value</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="otz__tee__client__api_8h_source.html#l00183">183</a> of file <a class="el" href="otz__tee__client__api_8h_source.html">otz_tee_client_api.h</a>.</p>

</div>
</div>
<h2 class="groupheader">Enumeration Type Documentation</h2>
<a class="anchor" id="a0726f9cc52e17d8e6cd7dd085cc62527"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="otz__api_8h.html#a0726f9cc52e17d8e6cd7dd085cc62527">otz_shared_mem_flags</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Shared memory flag constants. </p>
<dl><dt><b>Enumerator: </b></dt><dd><table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em><a class="anchor" id="a0726f9cc52e17d8e6cd7dd085cc62527a7aa74f7037354b0cd675442b600060c0"></a>OTZ_MEM_SERVICE_RO</em>&nbsp;</td><td>
<p>Service can only read from the memory block. </p>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="a0726f9cc52e17d8e6cd7dd085cc62527a8035deccf29fcd9fe345e3f3e0e4accb"></a>OTZ_MEM_SERVICE_WO</em>&nbsp;</td><td>
<p>Service can only write from the memory block. </p>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="a0726f9cc52e17d8e6cd7dd085cc62527a33f6f503a1e274dc317a34352157100c"></a>OTZ_MEM_SERVICE_RW</em>&nbsp;</td><td>
<p>Service can read and write from the memory block. </p>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="a0726f9cc52e17d8e6cd7dd085cc62527aa462fe85425a0bde33600ba164e20325"></a>OTZ_MEM_SERVICE_UNDEFINED</em>&nbsp;</td><td>
<p>Invalid flag </p>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="a0726f9cc52e17d8e6cd7dd085cc62527a7aa74f7037354b0cd675442b600060c0"></a>OTZ_MEM_SERVICE_RO</em>&nbsp;</td><td>
<p>Service can only read from the memory block. </p>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="a0726f9cc52e17d8e6cd7dd085cc62527a8035deccf29fcd9fe345e3f3e0e4accb"></a>OTZ_MEM_SERVICE_WO</em>&nbsp;</td><td>
<p>Service can only write from the memory block. </p>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="a0726f9cc52e17d8e6cd7dd085cc62527a33f6f503a1e274dc317a34352157100c"></a>OTZ_MEM_SERVICE_RW</em>&nbsp;</td><td>
<p>Service can read and write from the memory block. </p>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="a0726f9cc52e17d8e6cd7dd085cc62527aa462fe85425a0bde33600ba164e20325"></a>OTZ_MEM_SERVICE_UNDEFINED</em>&nbsp;</td><td>
<p>Invalid flag </p>
</td></tr>
</table>
</dd>
</dl>

<p>Definition at line <a class="el" href="otz__tee__client__api_8h_source.html#l00463">463</a> of file <a class="el" href="otz__tee__client__api_8h_source.html">otz_tee_client_api.h</a>.</p>
<div class="fragment"><div class="line">                          {</div>
<div class="line">    <a class="code" href="otz__api_8h.html#a0726f9cc52e17d8e6cd7dd085cc62527a7aa74f7037354b0cd675442b600060c0">OTZ_MEM_SERVICE_RO</a> = 0x0,</div>
<div class="line">    <a class="code" href="otz__api_8h.html#a0726f9cc52e17d8e6cd7dd085cc62527a8035deccf29fcd9fe345e3f3e0e4accb">OTZ_MEM_SERVICE_WO</a> ,</div>
<div class="line">    <a class="code" href="otz__api_8h.html#a0726f9cc52e17d8e6cd7dd085cc62527a33f6f503a1e274dc317a34352157100c">OTZ_MEM_SERVICE_RW</a>,</div>
<div class="line">    <a class="code" href="otz__api_8h.html#a0726f9cc52e17d8e6cd7dd085cc62527aa462fe85425a0bde33600ba164e20325">OTZ_MEM_SERVICE_UNDEFINED</a></div>
<div class="line">};</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="acea56784d3146198a50dca0fb5b2a7cd"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="otz__tee__client__api_8h.html#acea56784d3146198a50dca0fb5b2a7cd">TEEC_login_flags</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Login flag constants. </p>
<dl><dt><b>Enumerator: </b></dt><dd><table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em><a class="anchor" id="acea56784d3146198a50dca0fb5b2a7cda8bb5b8a7dfc0334f90ed7407dd4ddd9d"></a>TEEC_LOGIN_PUBLIC</em>&nbsp;</td><td>
<p>No login is to be used. </p>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="acea56784d3146198a50dca0fb5b2a7cda8c6ad7380cec6f7fa09c852247f4abed"></a>TEEC_LOGIN_USER</em>&nbsp;</td><td>
<p>The user executing the application is provided. </p>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="acea56784d3146198a50dca0fb5b2a7cdac1e52a37c3e8e6829c5e0c232756cc76"></a>TEEC_LOGIN_GROUP</em>&nbsp;</td><td>
<p>The user group executing the application is provided. </p>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="acea56784d3146198a50dca0fb5b2a7cda3cc79d313bb7bcb1aa9d52614682d08a"></a>TEEC_LOGIN_APPLICATION</em>&nbsp;</td><td>
<p>Login data about the running Client Application itself is provided. </p>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="acea56784d3146198a50dca0fb5b2a7cda646983f0da4bbdd6f96d64681dd31e73"></a>TEEC_LOGIN_USER_APPLICATION</em>&nbsp;</td><td>
<p>Login data about the user running the Client Application and about the Client Application itself is provided. </p>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="acea56784d3146198a50dca0fb5b2a7cda53642939ec71bb330122acdabff4bc22"></a>TEEC_LOGIN_GROUP_APPLICATION</em>&nbsp;</td><td>
<p>Login data about the group running the Client Application and about the Client Application itself is provided. </p>
</td></tr>
</table>
</dd>
</dl>

<p>Definition at line <a class="el" href="otz__tee__client__api_8h_source.html#l00068">68</a> of file <a class="el" href="otz__tee__client__api_8h_source.html">otz_tee_client_api.h</a>.</p>
<div class="fragment"><div class="line">                      {</div>
<div class="line">    <a class="code" href="otz__tee__client__api_8h.html#acea56784d3146198a50dca0fb5b2a7cda8bb5b8a7dfc0334f90ed7407dd4ddd9d">TEEC_LOGIN_PUBLIC</a> = 0x0,</div>
<div class="line">    <a class="code" href="otz__tee__client__api_8h.html#acea56784d3146198a50dca0fb5b2a7cda8c6ad7380cec6f7fa09c852247f4abed">TEEC_LOGIN_USER</a> ,</div>
<div class="line">    <a class="code" href="otz__tee__client__api_8h.html#acea56784d3146198a50dca0fb5b2a7cdac1e52a37c3e8e6829c5e0c232756cc76">TEEC_LOGIN_GROUP</a> ,</div>
<div class="line">    <a class="code" href="otz__tee__client__api_8h.html#acea56784d3146198a50dca0fb5b2a7cda3cc79d313bb7bcb1aa9d52614682d08a">TEEC_LOGIN_APPLICATION</a> = 0x4 ,</div>
<div class="line">    <a class="code" href="otz__tee__client__api_8h.html#acea56784d3146198a50dca0fb5b2a7cda646983f0da4bbdd6f96d64681dd31e73">TEEC_LOGIN_USER_APPLICATION</a> = 0x5 ,</div>
<div class="line">    <a class="code" href="otz__tee__client__api_8h.html#acea56784d3146198a50dca0fb5b2a7cda53642939ec71bb330122acdabff4bc22">TEEC_LOGIN_GROUP_APPLICATION</a> = 0x6 ,</div>
<div class="line">};</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a844239ef6fbb152b5e83b296be117fa9"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="otz__tee__client__api_8h.html#a844239ef6fbb152b5e83b296be117fa9">TEEC_param_type</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Param type constants. </p>
<dl><dt><b>Enumerator: </b></dt><dd><table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em><a class="anchor" id="a844239ef6fbb152b5e83b296be117fa9a257e01b5d678ddeed940f39b9f17a764"></a>TEEC_NONE</em>&nbsp;</td><td>
<p>The Parameter is not used. </p>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="a844239ef6fbb152b5e83b296be117fa9ae062e0502be2f5372812053a3d1fc031"></a>TEEC_VALUE_INPUT</em>&nbsp;</td><td>
<p>The Parameter is a <a class="el" href="structTEEC__Value.html" title="Small raw data value type.">TEEC_Value</a> tagged as input. </p>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="a844239ef6fbb152b5e83b296be117fa9ad8e807bd3166fb18b91917a42426323b"></a>TEEC_VALUE_OUTPUT</em>&nbsp;</td><td>
<p>The Parameter is a <a class="el" href="structTEEC__Value.html" title="Small raw data value type.">TEEC_Value</a> tagged as output. </p>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="a844239ef6fbb152b5e83b296be117fa9a0d3155a759f5f3ea299be0a493ee4924"></a>TEEC_VALUE_INOUT</em>&nbsp;</td><td>
<p>The Parameter is a <a class="el" href="structTEEC__Value.html" title="Small raw data value type.">TEEC_Value</a> tagged as both as input and output, i.e., for which both the behaviors of TEEC_VALUE_INPUT and TEEC_VALUE_OUTPUT apply. </p>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="a844239ef6fbb152b5e83b296be117fa9a08f93f6ac7c6615ff26838e8fa4e441d"></a>TEEC_MEMREF_TEMP_INPUT</em>&nbsp;</td><td>
<p>The Parameter is a <a class="el" href="structTEEC__TempMemoryReference.html" title="Temporary shared memory reference.">TEEC_TempMemoryReference</a> describing a region of memory which needs to be temporarily registered for the duration of the Operation and is tagged as input. </p>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="a844239ef6fbb152b5e83b296be117fa9a40a27415d0c255d58f1fad5287879785"></a>TEEC_MEMREF_TEMP_OUTPUT</em>&nbsp;</td><td>
<p>Same as TEEC_MEMREF_TEMP_INPUT, but the Memory Reference is tagged as output. The Implementation may update the size field to reflect the required output size in some use cases. </p>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="a844239ef6fbb152b5e83b296be117fa9a61b21cbecaf1827ddca58f49b2176748"></a>TEEC_MEMREF_TEMP_INOUT</em>&nbsp;</td><td>
<p>A Temporary Memory Reference tagged as both input and output, i.e., for which both the behaviors of TEEC_MEMREF_TEMP_INPUT and TEEC_MEMREF_TEMP_OUTPUT apply. </p>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="a844239ef6fbb152b5e83b296be117fa9a0fde2e095c933376a0360788e2dd7f90"></a>TEEC_MEMREF_WHOLE</em>&nbsp;</td><td>
<p>The Parameter is a Registered Memory Reference that refers to the entirety of its parent Shared Memory block. The parameter structure is a TEEC_MemoryReference. In this structure, the Implementation MUST read only the parent field and MAY update the size field when the operation completes. </p>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="a844239ef6fbb152b5e83b296be117fa9a83a852a82f09a38ddd6358bf83084dda"></a>TEEC_MEMREF_PARTIAL_INPUT</em>&nbsp;</td><td>
<p>A Registered Memory Reference structure that refers to a partial region of its parent Shared Memory block and is tagged as input. </p>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="a844239ef6fbb152b5e83b296be117fa9a3b0c66b1008718e5108fe84da60fafe0"></a>TEEC_MEMREF_PARTIAL_OUTPUT</em>&nbsp;</td><td>
<p>A Registered Memory Reference structure that refers to a partial region of its parent Shared Memory block and is tagged as output. </p>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="a844239ef6fbb152b5e83b296be117fa9a530eefe7668b93a6e6a5e02d70233cd3"></a>TEEC_MEMREF_PARTIAL_INOUT</em>&nbsp;</td><td>
<p>A Registered Memory Reference structure that refers to a partial region of its parent Shared Memory block and is tagged as both input and output. </p>
</td></tr>
</table>
</dd>
</dl>

<p>Definition at line <a class="el" href="otz__tee__client__api_8h_source.html#l00103">103</a> of file <a class="el" href="otz__tee__client__api_8h_source.html">otz_tee_client_api.h</a>.</p>
<div class="fragment"><div class="line">                     {</div>
<div class="line">    <a class="code" href="otz__tee__client__api_8h.html#a844239ef6fbb152b5e83b296be117fa9a257e01b5d678ddeed940f39b9f17a764">TEEC_NONE</a> = 0x1,</div>
<div class="line">    <a class="code" href="otz__tee__client__api_8h.html#a844239ef6fbb152b5e83b296be117fa9ae062e0502be2f5372812053a3d1fc031">TEEC_VALUE_INPUT</a>,</div>
<div class="line">    <a class="code" href="otz__tee__client__api_8h.html#a844239ef6fbb152b5e83b296be117fa9ad8e807bd3166fb18b91917a42426323b">TEEC_VALUE_OUTPUT</a>,</div>
<div class="line">    <a class="code" href="otz__tee__client__api_8h.html#a844239ef6fbb152b5e83b296be117fa9a0d3155a759f5f3ea299be0a493ee4924">TEEC_VALUE_INOUT</a>,</div>
<div class="line">    <a class="code" href="otz__tee__client__api_8h.html#a844239ef6fbb152b5e83b296be117fa9a08f93f6ac7c6615ff26838e8fa4e441d">TEEC_MEMREF_TEMP_INPUT</a>,</div>
<div class="line">    <a class="code" href="otz__tee__client__api_8h.html#a844239ef6fbb152b5e83b296be117fa9a40a27415d0c255d58f1fad5287879785">TEEC_MEMREF_TEMP_OUTPUT</a>,</div>
<div class="line">    <a class="code" href="otz__tee__client__api_8h.html#a844239ef6fbb152b5e83b296be117fa9a61b21cbecaf1827ddca58f49b2176748">TEEC_MEMREF_TEMP_INOUT</a>,</div>
<div class="line">    <a class="code" href="otz__tee__client__api_8h.html#a844239ef6fbb152b5e83b296be117fa9a0fde2e095c933376a0360788e2dd7f90">TEEC_MEMREF_WHOLE</a> = 0xc,</div>
<div class="line"></div>
<div class="line">    <a class="code" href="otz__tee__client__api_8h.html#a844239ef6fbb152b5e83b296be117fa9a83a852a82f09a38ddd6358bf83084dda">TEEC_MEMREF_PARTIAL_INPUT</a> = 0xd,</div>
<div class="line"></div>
<div class="line">    <a class="code" href="otz__tee__client__api_8h.html#a844239ef6fbb152b5e83b296be117fa9a3b0c66b1008718e5108fe84da60fafe0">TEEC_MEMREF_PARTIAL_OUTPUT</a> = 0xe,</div>
<div class="line"></div>
<div class="line">    <a class="code" href="otz__tee__client__api_8h.html#a844239ef6fbb152b5e83b296be117fa9a530eefe7668b93a6e6a5e02d70233cd3">TEEC_MEMREF_PARTIAL_INOUT</a> = 0xf</div>
<div class="line">};</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a7cec7a0d1fa340adc3d3186b6eeb63fc"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="otz__tee__client__api_8h.html#a7cec7a0d1fa340adc3d3186b6eeb63fc">TEEC_return_code_origin</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Return code origin. </p>
<dl><dt><b>Enumerator: </b></dt><dd><table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em><a class="anchor" id="a7cec7a0d1fa340adc3d3186b6eeb63fca8f66dc5e481382d361fd654fb9e42ed1"></a>TEEC_ORIGIN_API</em>&nbsp;</td><td>
<p>The return code is an error that originated within the TEE Client API implementation. </p>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="a7cec7a0d1fa340adc3d3186b6eeb63fca0d25fcbd36c2ae3afc02c1c3c447fcad"></a>TEEC_ORIGIN_COMMS</em>&nbsp;</td><td>
<p>The return code is an error that originated within the underlying communications stack linking the rich OS with the TEE. </p>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="a7cec7a0d1fa340adc3d3186b6eeb63fca93200fb6850597016a7261d1a2877458"></a>TEEC_ORIGIN_TEE</em>&nbsp;</td><td>
<p>The return code is an error that originated within the common TEE code. </p>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="a7cec7a0d1fa340adc3d3186b6eeb63fcac1e440c31589196e83b79353fcf5ebce"></a>TEEC_ORIGIN_TRUSTED_APP</em>&nbsp;</td><td>
<p>The return code is an error that originated within the Trusted application code. This includes the case where the return code is a success. </p>
</td></tr>
</table>
</dd>
</dl>

<p>Definition at line <a class="el" href="otz__tee__client__api_8h_source.html#l00048">48</a> of file <a class="el" href="otz__tee__client__api_8h_source.html">otz_tee_client_api.h</a>.</p>
<div class="fragment"><div class="line">                             {</div>
<div class="line">    <a class="code" href="otz__tee__client__api_8h.html#a7cec7a0d1fa340adc3d3186b6eeb63fca8f66dc5e481382d361fd654fb9e42ed1">TEEC_ORIGIN_API</a> = 0x1,</div>
<div class="line">    <a class="code" href="otz__tee__client__api_8h.html#a7cec7a0d1fa340adc3d3186b6eeb63fca0d25fcbd36c2ae3afc02c1c3c447fcad">TEEC_ORIGIN_COMMS</a> = 0x2,</div>
<div class="line">    <a class="code" href="otz__tee__client__api_8h.html#a7cec7a0d1fa340adc3d3186b6eeb63fca93200fb6850597016a7261d1a2877458">TEEC_ORIGIN_TEE</a> = 0x3,</div>
<div class="line">    <a class="code" href="otz__tee__client__api_8h.html#a7cec7a0d1fa340adc3d3186b6eeb63fcac1e440c31589196e83b79353fcf5ebce">TEEC_ORIGIN_TRUSTED_APP</a> = 0x4,</div>
<div class="line">};</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ad2ca265b0a012cb196691e4037b558dc"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="otz__tee__client__api_8h.html#ad2ca265b0a012cb196691e4037b558dc">TEEC_shared_mem_flags</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Shared memory flag constants. </p>
<dl><dt><b>Enumerator: </b></dt><dd><table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em><a class="anchor" id="ad2ca265b0a012cb196691e4037b558dca8407d60bc4211cd205bdf111c3ce512c"></a>TEEC_MEM_INPUT</em>&nbsp;</td><td>
<p>The Shared Memory can carry data from the Client Application to the Trusted Application. </p>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="ad2ca265b0a012cb196691e4037b558dca4d822f60ca1969d1513b14b2805b234e"></a>TEEC_MEM_OUTPUT</em>&nbsp;</td><td>
<p>The Shared Memory can carry data from the Trusted Application to the Client Application. </p>
</td></tr>
</table>
</dd>
</dl>

<p>Definition at line <a class="el" href="otz__tee__client__api_8h_source.html#l00090">90</a> of file <a class="el" href="otz__tee__client__api_8h_source.html">otz_tee_client_api.h</a>.</p>
<div class="fragment"><div class="line">                           {</div>
<div class="line">    <a class="code" href="otz__tee__client__api_8h.html#ad2ca265b0a012cb196691e4037b558dca8407d60bc4211cd205bdf111c3ce512c">TEEC_MEM_INPUT</a> = 0x1,</div>
<div class="line">    <a class="code" href="otz__tee__client__api_8h.html#ad2ca265b0a012cb196691e4037b558dca4d822f60ca1969d1513b14b2805b234e">TEEC_MEM_OUTPUT</a> = 0x2,</div>
<div class="line">};</div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="a8358037528cb0d29d57f1da4fdb12d23"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="otz__tee__api_8h.html#a586a43c1886aa09dc9541fb66e6d8d7f">TEEC_Result</a> TEEC_AllocateSharedMemory </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structTEEC__Context.html">TEEC_Context</a> *&#160;</td>
          <td class="paramname"><em>context</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structTEEC__SharedMemory.html">TEEC_SharedMemory</a> *&#160;</td>
          <td class="paramname"><em>sharedMem</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Allocate a shared memory block. </p>
<p>This function allocates a new block of memory as a block of Shared Memory within the scope of the specified TEE Context, in accordance with the parameters which have been set by the Client Application inside the <em>sharedMem</em> structure.</p>
<p>The parameter <em>context</em> MUST point to an initialized TEE Context.</p>
<p>The <em>sharedMem</em> parameter MUST point to the Shared Memory structure defining the region to allocate. Client Application MUST have populated the following fields of the Shared Memory structure: <br/>
 The <em>size</em> field MUST contain the desired size of the buffer, in bytes. The size is allowed to be zero. In this case memory is allocated and the pointer written in to the buffer field on return MUST not be NULL but MUST never be de-referenced by the Client Application. In this case however, the Shared Memory block can be used in Registered Memory References. <br/>
 The <em>flags</em> field indicates the allowed directions of data flow between the Client Application and the TEE. <br/>
 The Implementation MUST assume that all other fields in the Shared Memory structure have undefined content.</p>
<p>An Implementation MAY put a hard limit on the size of a single Shared Memory block, defined by the constant <em>TEEC_CONFIG_SHAREDMEM_MAX_SIZE</em>. However note that this function may fail to allocate a block smaller than this limit due to a low resource condition encountered at run-time.</p>
<p>If this function returns any code other than <em>TEEC_SUCCESS</em> the Implementation MUST have set the <em>buffer</em> field of <em>sharedMem</em> to NULL.</p>
<p><b>Programmer</b> <b>Error</b> <br/>
 The following usage of the API is a programmer error:<br/>
 Calling with a <em>context</em> which is not initialized.<br/>
 Calling with a <em>sharedMem</em> which has not be correctly populated in accordance with the specification.<br/>
 Attempting to initialize the same Shared Memory structure concurrently from multiple threads.Multi-threaded Client Applications must use platform-provided locking mechanisms to ensure that this case does not occur.</p>
<p><b>Implementor's</b> <b>Notes</b> <br/>
 Once successfully allocated the Shared Memory block can be used for efficient data transfers between the Client Application and the Trusted Application. The TEE Client API and the underlying communications infrastructure should attempt to transfer data in to the TEE without using copies, if this is possible on the underlying implementation, but may have to fall back on data copies if zero-copy cannot be achieved. The memory buffer allocated by this function must have sufficient alignment to store any fundamental C data type at a natural alignment. For most platforms this will require the memory buffer to have 8-byte alignment, but refer to the Application Binary Interface (ABI) of the target platform for details.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">context,:</td><td>A pointer to an initialized TEE Context </td></tr>
    <tr><td class="paramname">sharedMem,:</td><td>A pointer to a Shared Memory structure to allocate: <br/>
 Before calling this function, the Client Application MUST have set the <em>size</em>, and <em>flags</em> fields. <br/>
 On return, for a successful allocation the Implementation MUST have set the pointer buffer to the address of the allocated block, otherwise it MUST set buffer to NULL.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>TEEC_Result: TEEC_SUCCESS: The allocation was successful. <br/>
 TEEC_ERROR_*: An implementation-defined error code for any other error.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">context,:</td><td>Pointer to the context </td></tr>
    <tr><td class="paramname">sharedMem,:</td><td>Pointer to the shared memory</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>TEEC_Result: TEEC_SUCCESS: The allocation was successful. <br/>
 TEEC_ERROR_*: An implementation-defined error code for any other error. </dd></dl>

<p>Definition at line <a class="el" href="otz__tee__api_8c_source.html#l00204">204</a> of file <a class="el" href="otz__tee__api_8c_source.html">otz_tee_api.c</a>.</p>
<div class="fragment"><div class="line">{</div>
<div class="line">    <span class="keywordtype">int</span> mmap_flags;</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">if</span>(context == <a class="code" href="sw__types_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a> || sharedMem == <a class="code" href="sw__types_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a> ) {</div>
<div class="line">        printf(<span class="stringliteral">&quot;TEEC_AllocateSharedMemory : Error Illegal argument\n&quot;</span>);</div>
<div class="line">        <span class="keywordflow">return</span> <a class="code" href="otz__tee__api_8h.html#a586a43c1886aa09dc9541fb66e6d8d7fa4b7583ef234ccb0ef6f7492ee6e8200d">TEEC_ERROR_BAD_PARAMETERS</a>;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">if</span>((sharedMem-&gt;<a class="code" href="structTEEC__SharedMemory.html#ade465778b424b13ee99e044c2a221af8">size</a> == 0) ||</div>
<div class="line">        ((sharedMem-&gt;<a class="code" href="structTEEC__SharedMemory.html#a952af666858535b863b162a8b9e53e0c">flags</a> != <a class="code" href="otz__tee__client__api_8h.html#ad2ca265b0a012cb196691e4037b558dca8407d60bc4211cd205bdf111c3ce512c">TEEC_MEM_INPUT</a>) &amp;&amp; </div>
<div class="line">         (sharedMem-&gt;<a class="code" href="structTEEC__SharedMemory.html#a952af666858535b863b162a8b9e53e0c">flags</a> != <a class="code" href="otz__tee__client__api_8h.html#ad2ca265b0a012cb196691e4037b558dca4d822f60ca1969d1513b14b2805b234e">TEEC_MEM_OUTPUT</a>) &amp;&amp; </div>
<div class="line">         (sharedMem-&gt;<a class="code" href="structTEEC__SharedMemory.html#a952af666858535b863b162a8b9e53e0c">flags</a> != (<a class="code" href="otz__tee__client__api_8h.html#ad2ca265b0a012cb196691e4037b558dca8407d60bc4211cd205bdf111c3ce512c">TEEC_MEM_INPUT</a> | <a class="code" href="otz__tee__client__api_8h.html#ad2ca265b0a012cb196691e4037b558dca4d822f60ca1969d1513b14b2805b234e">TEEC_MEM_OUTPUT</a>)))) {</div>
<div class="line">        printf(<span class="stringliteral">&quot;TEEC_AllocateSharedMemory : Error Illegal argument\n&quot;</span>);</div>
<div class="line">        <span class="keywordflow">return</span> <a class="code" href="otz__tee__api_8h.html#a586a43c1886aa09dc9541fb66e6d8d7fa4b7583ef234ccb0ef6f7492ee6e8200d">TEEC_ERROR_BAD_PARAMETERS</a>;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    sharedMem-&gt;<a class="code" href="structTEEC__SharedMemory.html#a7ced755c88a53bfadc0354fe1e33e0f9">buffer</a> = <a class="code" href="sw__types_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div>
<div class="line"></div>
<div class="line">    mmap_flags = PROT_READ | PROT_WRITE;</div>
<div class="line"></div>
<div class="line">    sharedMem-&gt;<a class="code" href="structTEEC__SharedMemory.html#a7ced755c88a53bfadc0354fe1e33e0f9">buffer</a> = mmap(0, sharedMem-&gt;<a class="code" href="structTEEC__SharedMemory.html#ade465778b424b13ee99e044c2a221af8">size</a>,</div>
<div class="line">                        mmap_flags , MAP_SHARED,</div>
<div class="line">                        context-&gt;<a class="code" href="structTEEC__Context.html#a33f0bc3b43f53a2daf1dbafc82e3a804">fd</a>, 0);</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">if</span>(sharedMem-&gt;<a class="code" href="structTEEC__SharedMemory.html#a7ced755c88a53bfadc0354fe1e33e0f9">buffer</a> == MAP_FAILED) {</div>
<div class="line">        perror(<span class="stringliteral">&quot;TEEC_AllocateSharedMemory - mmap failed\n&quot;</span>); </div>
<div class="line">        sharedMem-&gt;<a class="code" href="structTEEC__SharedMemory.html#adde3813dfcdccd8cd15846d626763260">s_errno</a> = <a class="code" href="sw__filelib_8h.html#ad65a8842cc674e3ddf69355898c0ecbf">errno</a>;</div>
<div class="line">        sharedMem-&gt;<a class="code" href="structTEEC__SharedMemory.html#a7ced755c88a53bfadc0354fe1e33e0f9">buffer</a> = <a class="code" href="sw__types_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div>
<div class="line">        <span class="keywordflow">return</span> <a class="code" href="otz__tee__api_8h.html#a586a43c1886aa09dc9541fb66e6d8d7fac4927fa5eae4d0446bb2aa422f0d244f">TEEC_ERROR_OUT_OF_MEMORY</a>;</div>
<div class="line">    }</div>
<div class="line">    sharedMem-&gt;<a class="code" href="structTEEC__SharedMemory.html#af662eccaf65008ef806549dda52368f1">allocated</a> = 1;</div>
<div class="line">    sharedMem-&gt;<a class="code" href="structTEEC__SharedMemory.html#a7532915172f8700fd0687bd12df96980">context</a> = context;</div>
<div class="line">    sharedMem-&gt;<a class="code" href="structTEEC__SharedMemory.html#af5682d369305070e83514a18cc2a2260">operation_count</a> = 0;</div>
<div class="line"></div>
<div class="line">    <a class="code" href="sw__list_8h.html#a0ffe9d28c36d7b018a9cfae33bae45c0">INIT_LIST_HEAD</a>(&amp;sharedMem-&gt;<a class="code" href="structTEEC__SharedMemory.html#a04c50f42331105464d2eb3d66cc4e8eb">head_ref</a>);</div>
<div class="line">    list_add_tail(&amp;context-&gt;<a class="code" href="structTEEC__Context.html#aeb59522c8cdeefc9afcf4b458846a286">shared_mem_list</a>, &amp;sharedMem-&gt;<a class="code" href="structTEEC__SharedMemory.html#a04c50f42331105464d2eb3d66cc4e8eb">head_ref</a>);</div>
<div class="line">    context-&gt;<a class="code" href="structTEEC__Context.html#adceafa85960b8f7ee684a540e8aa932f">shared_mem_cnt</a>++;</div>
<div class="line">    <span class="keywordflow">return</span> <a class="code" href="otz__tee__api_8h.html#a586a43c1886aa09dc9541fb66e6d8d7fa4d19c2c024e37edc5f04892bb6739dbe">TEEC_SUCCESS</a>;</div>
<div class="line"></div>
<div class="line">}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="abbd4e86c7d7a2830b66dd1c455e57708"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void TEEC_CloseSession </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structTEEC__Session.html">TEEC_Session</a> *&#160;</td>
          <td class="paramname"><em>session</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Close a opened session between client and trusted application. </p>
<p>This function closes a Session which has been opened with a Trusted Application.</p>
<p>All Commands within the Session MUST have completed before calling this function.</p>
<p>The Implementation MUST do nothing if the session parameter is NULL.</p>
<p>The implementation of this function MUST NOT be able to fail: after this function returns the Client Application must be able to consider that the Session has been closed.</p>
<p><b>Programmer</b> <b>Error</b> <br/>
 The following usage of the API is a programmer error:<br/>
 Calling with a session which still has commands running.<br/>
 Attempting to close the same Session concurrently from multiple threads. <br/>
 Attempting to close the same Session more than once.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">session,:</td><td>Session to close</td></tr>
  </table>
  </dd>
</dl>
<p>Close a opened session between client and trusted application.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">session,:</td><td>Pointer to the session structure </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="otz__tee__api_8c_source.html#l00444">444</a> of file <a class="el" href="otz__tee__api_8c_source.html">otz_tee_api.c</a>.</p>
<div class="fragment"><div class="line">{</div>
<div class="line">    <span class="keywordtype">int</span> ret = 0;</div>
<div class="line">    <span class="keyword">struct </span><a class="code" href="structser__ses__id.html" title="Session details structure.">ser_ses_id</a> ses_close;</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">if</span>(session == <a class="code" href="sw__types_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) {</div>
<div class="line">        printf(<span class="stringliteral">&quot;TEEC_CloseSession: Warning: Session pointer is NULL\n&quot;</span>);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">if</span>(session-&gt;<a class="code" href="structTEEC__Session.html#ae21202e1d124456453722861aee399aa">operation_cnt</a>) {</div>
<div class="line">        printf(<span class="stringliteral">&quot;TEEC_CloseSession: Warning: Pending operations %d\n&quot;</span>, </div>
<div class="line">            session-&gt;<a class="code" href="structTEEC__Session.html#ae21202e1d124456453722861aee399aa">operation_cnt</a>);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line">    ses_close.service_id = session-&gt;<a class="code" href="structTEEC__Session.html#aa2fc5ceee64cdc8d7f3e3b83c82c1be3">service_id</a> ;</div>
<div class="line">    ses_close.session_id = session-&gt;<a class="code" href="structTEEC__Session.html#a00ba158c15263804225042278230d3b1">session_id</a> ;</div>
<div class="line"></div>
<div class="line">    ret = ioctl(session-&gt;<a class="code" href="structTEEC__Session.html#ab72c9ecca6e5cb3d7b10ff75754549bb">device</a>-&gt;<a class="code" href="structTEEC__Context.html#a33f0bc3b43f53a2daf1dbafc82e3a804">fd</a>,</div>
<div class="line">                <a class="code" href="otz__client_8h.html#a4d3f346f8ed5d6932d3f8a47ecd06585">OTZ_CLIENT_IOCTL_SES_CLOSE_REQ</a>, &amp;ses_close);</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">if</span>(ret == 0){</div>
<div class="line">        session-&gt;<a class="code" href="structTEEC__Session.html#ab72c9ecca6e5cb3d7b10ff75754549bb">device</a>-&gt;<a class="code" href="structTEEC__Context.html#aab72b42cacee05486d681a2c7aa34fcd">session_count</a>--;</div>
<div class="line">        session-&gt;<a class="code" href="structTEEC__Session.html#ab72c9ecca6e5cb3d7b10ff75754549bb">device</a> = <a class="code" href="sw__types_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div>
<div class="line">        session-&gt;<a class="code" href="structTEEC__Session.html#a00ba158c15263804225042278230d3b1">session_id</a> = -1;</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">else</span> {</div>
<div class="line">        perror(<span class="stringliteral">&quot;TEEC_CloseSession: Session client close request failed\n&quot;</span>);</div>
<div class="line">    }</div>
<div class="line">}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a8ff39851efe335623922e6f800f3113b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void TEEC_FinalizeContext </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structTEEC__Context.html">TEEC_Context</a> *&#160;</td>
          <td class="paramname"><em>context</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Finalizes an initialized TEE context. </p>
<p>This function finalizes an initialized TEE Context, closing the connection between the Client Application and the TEE. The Client Application MUST only call this function when all Sessions inside this TEE Context have been closed and all Shared Memory blocks have been released. <br/>
 The implementation of this function MUST NOT be able to fail: after this function returns the Client Application must be able to consider that the Context has been closed.<br/>
 The function implementation MUST do nothing if context is NULL.</p>
<p><b>Programmer</b> <b>Error</b> <br/>
 The following usage of the API is a programmer error:<br/>
 Calling with a context which still has sessions opened.<br/>
 Calling with a context which contains unreleased Shared Memory blocks.<br/>
 Attempting to finalize the same TEE Context structure concurrently from multiple threads.<br/>
 Attempting to finalize the same TEE Context structure more than once, without an intervening call to TEEC_InitalizeContext.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">context,:</td><td>An initialized <a class="el" href="structTEEC__Context.html" title="The TEEC_Context structure is used to contain control information related to the TEE.">TEEC_Context</a> structure which is to be finalized.</td></tr>
    <tr><td class="paramname">context,:</td><td>An initialized <a class="el" href="structTEEC__Context.html" title="The TEEC_Context structure is used to contain control information related to the TEE.">TEEC_Context</a> structure which is to be finalized. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="otz__tee__api_8c_source.html#l00167">167</a> of file <a class="el" href="otz__tee__api_8c_source.html">otz_tee_api.c</a>.</p>
<div class="fragment"><div class="line">{</div>
<div class="line">    <span class="keywordflow">if</span>(!context)</div>
<div class="line">    {</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">if</span>(context-&gt;<a class="code" href="structTEEC__Context.html#aab72b42cacee05486d681a2c7aa34fcd">session_count</a> != 0) {</div>
<div class="line">        printf(<span class="stringliteral">&quot;warning: pending open sessions %d\n&quot;</span>, </div>
<div class="line">                    context-&gt;<a class="code" href="structTEEC__Context.html#aab72b42cacee05486d681a2c7aa34fcd">session_count</a>);</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">if</span>(context-&gt;<a class="code" href="structTEEC__Context.html#adceafa85960b8f7ee684a540e8aa932f">shared_mem_cnt</a> != 0) {</div>
<div class="line">        printf(<span class="stringliteral">&quot;warning: unreleased shared memory blocks %d\n&quot;</span>, </div>
<div class="line">                    context-&gt;<a class="code" href="structTEEC__Context.html#adceafa85960b8f7ee684a540e8aa932f">shared_mem_cnt</a>);</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">if</span>( (context-&gt;<a class="code" href="structTEEC__Context.html#aab72b42cacee05486d681a2c7aa34fcd">session_count</a> == 0) &amp;&amp; (context-&gt;<a class="code" href="structTEEC__Context.html#adceafa85960b8f7ee684a540e8aa932f">shared_mem_cnt</a> == 0)) {</div>
<div class="line">        printf(<span class="stringliteral">&quot;device closed \n&quot;</span>);</div>
<div class="line">        <a class="code" href="virtual__keyboard__app_8c.html#ae8a3b46baffb627f3917b08c4b84c49d">close</a>(context-&gt;<a class="code" href="structTEEC__Context.html#a33f0bc3b43f53a2daf1dbafc82e3a804">fd</a>);</div>
<div class="line">        context-&gt;<a class="code" href="structTEEC__Context.html#a33f0bc3b43f53a2daf1dbafc82e3a804">fd</a> = 0;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">return</span>;</div>
<div class="line">}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a015f78683598134139320994260db34c"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">char* TEEC_GetError </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>error</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>returnOrigin</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Returns error string. </p>
<p>This function returns the error string value based on error number and return origin.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">error,:</td><td>Error number. </td></tr>
    <tr><td class="paramname">returnOrigin,:</td><td>Origin of the return.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>char*: Error string value. </dd></dl>

<p>Definition at line <a class="el" href="otz__tee__api_8c_source.html#l00099">99</a> of file <a class="el" href="otz__tee__api_8c_source.html">otz_tee_api.c</a>.</p>
<div class="fragment"><div class="line">{                        </div>
<div class="line">    <span class="keywordflow">if</span>(returnOrigin == <a class="code" href="otz__tee__client__api_8h.html#a7cec7a0d1fa340adc3d3186b6eeb63fcac1e440c31589196e83b79353fcf5ebce">TEEC_ORIGIN_TRUSTED_APP</a>)   </div>
<div class="line">        <span class="keywordflow">return</span> (<span class="keywordtype">char</span>*)TEEC_service_errorlist[error];  </div>
<div class="line">    <span class="keywordflow">else</span></div>
<div class="line">        <span class="keywordflow">return</span> (<span class="keywordtype">char</span>*)TEEC_errorlist[error];  </div>
<div class="line">}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a3e9d47511b2b76ec947655708cca039f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="otz__tee__api_8h.html#a586a43c1886aa09dc9541fb66e6d8d7f">TEEC_Result</a> TEEC_InitializeContext </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structTEEC__Context.html">TEEC_Context</a> *&#160;</td>
          <td class="paramname"><em>context</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initialize Context. </p>
<p>This function initializes a new TEE Context, forming a connection between this Client Application and the TEE identified by the string identifier name.<br/>
 The Client Application MAY pass a NULL name, which means that the Implementation MUST select a default TEE to connect to. The supported name strings, the mapping of these names to a specific TEE, and the nature of the default TEE are implementation-defined.<br/>
 The caller MUST pass a pointer to a valid TEEC Context in context. The Implementation MUST assume that all fields of the <a class="el" href="structTEEC__Context.html" title="The TEEC_Context structure is used to contain control information related to the TEE.">TEEC_Context</a> structure are in an undefined state.<br/>
</p>
<p><b>Programmer</b> <b>Error</b> <br/>
 The following usage of the API is a programmer error: <br/>
 Attempting to initialize the same TEE Context structure concurrently from multiple threads. Multi-threaded Client Applications must use platform-provided locking mechanisms to ensure that this case does not occur. <br/>
 <br/>
 <b>Implementers’</b> <b>Notes</b> <br/>
 It is valid Client Application behavior to concurrently initialize different TEE Contexts, so the Implementation MUST support this.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">name,:</td><td>A zero-terminated string that describes the TEE to connect to. If this parameter is set to NULL the Implementation MUST select a default TEE.</td></tr>
    <tr><td class="paramname">context,:</td><td>A <a class="el" href="structTEEC__Context.html" title="The TEEC_Context structure is used to contain control information related to the TEE.">TEEC_Context</a> structure that MUST be initialized by the Implementation.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>TEEC_Result: TEEC_SUCCESS: The initialization was successful. <br/>
 TEEC_ERROR_*: An implementation-defined error code for any other error.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">name,:</td><td>A zero-terminated string that describes the TEE to connect to. If this parameter is set to NULL the Implementation MUST select a default TEE.</td></tr>
    <tr><td class="paramname">context,:</td><td>A <a class="el" href="structTEEC__Context.html" title="The TEEC_Context structure is used to contain control information related to the TEE.">TEEC_Context</a> structure that MUST be initialized by the Implementation.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>TEEC_Result: TEEC_SUCCESS: The initialization was successful. <br/>
 TEEC_ERROR_*: An implementation-defined error code for any other error. </dd></dl>

<p>Definition at line <a class="el" href="otz__tee__api_8c_source.html#l00120">120</a> of file <a class="el" href="otz__tee__api_8c_source.html">otz_tee_api.c</a>.</p>
<div class="fragment"><div class="line">{</div>
<div class="line">    <span class="keywordtype">int</span> ret=0;</div>
<div class="line">    <span class="keywordtype">char</span> temp_name[256];</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">if</span>(context == <a class="code" href="sw__types_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) {</div>
<div class="line">        printf(<span class="stringliteral">&quot;TEEC_InitializeContext : Context is null\n&quot;</span>);</div>
<div class="line">        <span class="keywordflow">return</span> <a class="code" href="otz__tee__api_8h.html#a586a43c1886aa09dc9541fb66e6d8d7fa4b7583ef234ccb0ef6f7492ee6e8200d">TEEC_ERROR_BAD_PARAMETERS</a>;</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">if</span>(name == <a class="code" href="sw__types_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) {</div>
<div class="line"><span class="preprocessor">#ifdef OTZ_DEBUG</span></div>
<div class="line"><span class="preprocessor"></span>        printf(<span class="stringliteral">&quot;%s is assigned as default context\n&quot;</span>, </div>
<div class="line">            <a class="code" href="otz__client_8h.html#aece194c75f564c1efd000bb0cde9a911">OTZ_CLIENT_FULL_PATH_DEV_NAME</a> );</div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line"><span class="preprocessor"></span>        <a class="code" href="libc__sos_8h.html#a0bdde5c387a0682534e738d2c212d58a">strcpy</a>(temp_name, <a class="code" href="otz__client_8h.html#aece194c75f564c1efd000bb0cde9a911">OTZ_CLIENT_FULL_PATH_DEV_NAME</a>);</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">else</span> {</div>
<div class="line">        <a class="code" href="libc__sos_8h.html#a0bdde5c387a0682534e738d2c212d58a">strcpy</a>(temp_name, name);</div>
<div class="line">    }</div>
<div class="line">    ret = open(temp_name, O_RDWR); </div>
<div class="line">    <span class="keywordflow">if</span>( ret == -1){</div>
<div class="line">        perror(<span class="stringliteral">&quot;TEEC_InitializeContext : device open failed\n&quot;</span>);</div>
<div class="line">        context-&gt;<a class="code" href="structTEEC__Context.html#a33bf223f26ee1b208b0cdc5ead6a7bcf">s_errno</a> = <a class="code" href="sw__filelib_8h.html#ad65a8842cc674e3ddf69355898c0ecbf">errno</a>;</div>
<div class="line">        <span class="keywordflow">return</span> <a class="code" href="otz__tee__api_8h.html#a586a43c1886aa09dc9541fb66e6d8d7fae90c214f5f14bdcd9cfa2fffd5baa877">TEEC_ERROR_GENERIC</a>;</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">else</span>{</div>
<div class="line">        context-&gt;<a class="code" href="structTEEC__Context.html#a33f0bc3b43f53a2daf1dbafc82e3a804">fd</a> = ret ;</div>
<div class="line">        context-&gt;<a class="code" href="structTEEC__Context.html#aab72b42cacee05486d681a2c7aa34fcd">session_count</a> = 0;</div>
<div class="line">        context-&gt;<a class="code" href="structTEEC__Context.html#adceafa85960b8f7ee684a540e8aa932f">shared_mem_cnt</a> = 0;</div>
<div class="line">        <a class="code" href="sw__list_8h.html#a0ffe9d28c36d7b018a9cfae33bae45c0">INIT_LIST_HEAD</a>(&amp;context-&gt;<a class="code" href="structTEEC__Context.html#aeb59522c8cdeefc9afcf4b458846a286">shared_mem_list</a>);</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line"><span class="preprocessor">#ifdef OTZ_DEBUG</span></div>
<div class="line"><span class="preprocessor"></span>    printf(<span class="stringliteral">&quot;TEEC_InitializeContext success\n&quot;</span>);</div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line"><span class="preprocessor"></span>    <span class="keywordflow">return</span> <a class="code" href="otz__tee__api_8h.html#a586a43c1886aa09dc9541fb66e6d8d7fa4d19c2c024e37edc5f04892bb6739dbe">TEEC_SUCCESS</a>;</div>
<div class="line"></div>
<div class="line">}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a33d421ce57c64600db759fe55bd0541e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="otz__tee__api_8h.html#a586a43c1886aa09dc9541fb66e6d8d7f">TEEC_Result</a> TEEC_InvokeCommand </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structTEEC__Session.html">TEEC_Session</a> *&#160;</td>
          <td class="paramname"><em>session</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="otz__api_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a>&#160;</td>
          <td class="paramname"><em>commandID</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structTEEC__Operation.html">TEEC_Operation</a> *&#160;</td>
          <td class="paramname"><em>operation</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="otz__api_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> *&#160;</td>
          <td class="paramname"><em>returnOrigin</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Invokes a command within the session. </p>
<p>This function invokes a Command within the specified Session.</p>
<p>The parameter <em>session</em> MUST point to a valid open Session.</p>
<p>The parameter <em>commandID</em> is an identifier that is used to indicate which of the exposed Trusted Application functions should be invoked. The supported command identifiers are defined by the Trusted Application‟s protocol.</p>
<p><b>Operation</b> <b>Handling</b> <br/>
 A Command MAY optionally carry an Operation Payload. When the payload is present the parameter <em>operation</em> MUST point to a <em><a class="el" href="structTEEC__Operation.html" title="The TEEC_Operation structure is used to contain control information related to an operation that is t...">TEEC_Operation</a></em> structure populated by the Client Application. If <em>operation</em> is NULL then no parameters are exchanged with the Trusted Application, and only the Command ID is exchanged.</p>
<p>The <em>operation</em> structure is also used to manage cancellation of the Command. If cancellation is required then <em>the</em> operation pointer MUST be <em>non-NULL</em> and the Client Application MUST have zeroed the <em>started</em> field of the <em>operation</em> structure before calling this function. The <em>operation</em> structure MAY contain no Parameters if no data payload is to be exchanged.</p>
<p>The Operation Payload is handled as described by the following steps, which are executed sequentially: <br/>
</p>
<ol type="1">
<li>Each Parameter in the Operation Payload is examined. If the parameter is a Temporary Memory Reference, then it is registered for the duration of the Operation in accordance with the fields set in the <em><a class="el" href="structTEEC__TempMemoryReference.html" title="Temporary shared memory reference.">TEEC_TempMemoryReference</a></em> structure and the data flow direction specified in the parameter type. Refer to the <em>TEEC_RegisterSharedMemory</em> function for error conditions which can be triggered during temporary registration of a memory region. <br/>
</li>
<li>The contents of all the Memory Regions which are exchanged with the TEE are synchronized <br/>
</li>
<li>The fields of all Value Parameters tagged as input are read by the Implementation. This applies to Parameters of type <em>TEEC_VALUE_INPUT</em> or <em>TEEC_VALUE_INOUT</em>. <br/>
</li>
<li>The Operation is issued to the Trusted Application. During the execution of the Command, the Trusted Application may read the data held within the memory referred to by input Memory References. It may also write data in to the memory referred to by output Memory References, but these modifications are not guaranteed to be observable by the Client Application until the command completes. <br/>
</li>
<li>After the Command has completed, the Implementation MUST update the <em>size</em> field of the Memory Reference structures flagged as output: <br/>
</li>
</ol>
<p>a. For Memory References that are non-null and marked as output, the updated size field MAY be less than or equal to original size field. In this case this indicates the number of bytes actually written by the Trusted Application, and the Implementation MUST synchronize this region with the Client Application memory space. <br/>
 b. For all Memory References marked as output, the updated size field MAY be larger than the original size field. For null Memory References, a required buffer size MAY be specified by the Trusted Application. In these cases the passed output buffer was too small or absent, and the returned size indicates the size of the output buffer which is necessary for the operation to succeed. In these cases the Implementation SHOULD NOT synchronize any shared data with the Client Application.<br/>
<br/>
</p>
<ol type="1">
<li>When the Command completes, the Implementation MUST update the fields of all Value Parameters tagged as output, i.e., of type <em>TEEC_VALUE_OUTPUT</em> or <em>TEEC_VALUE_INOUT</em>. <br/>
</li>
<li>All memory regions that were temporarily registered at the beginning of the function are deregistered as if the function <em>TEEC_ReleaseSharedMemory</em> was called on each of them.</li>
<li>Control is passed back to the calling Client Application code. <br/>
 <b>Programmer</b> <b>Error</b> <br/>
.</li>
</ol>
<p>The result of this function is returned both in the function <em>TEEC_Result</em> return code and the return origin, stored in the variable pointed to by <em>returnOrigin:</em> <br/>
 If the return origin is different from <em>TEEC_ORIGIN_TRUSTED_APP</em>, then the return code MUST be one of the error codes. If the return code is TEEC_ERROR_CANCEL then it means that the operation was cancelled before it reached the Trusted Application.<br/>
 If the return origin is <em>TEEC_ORIGIN_TRUSTED_APP</em>, then the meaning of the return code is determined by the protocol exposed by the Trusted Application. It is recommended that the Trusted Application developer chooses TEEC_SUCCESS (0) to indicate success in their protocol, as this means that it is possible for the Client Application developer to determine success or failure without looking at the return origin.</p>
<p><b>Programmer</b> <br/>
 Error <br/>
 The following usage of the API is a programmer error:<br/>
 Calling with a <em>session</em> which is not an open session. <br/>
 Calling with invalid content in the <em>paramTypes</em> field of the <em>operation</em> structure. This invalid behavior includes types which are <em>Reserved</em> for future use or which conflict with the <em>flags</em> of the parent Shared Memory block. <br/>
 Encoding Registered Memory References which refer to Shared Memory blocks allocated or registered within the scope of a different TEE Context. <br/>
 Using the same operation structure concurrently for multiple operations, whether open Session operations or Command invocations.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">session,:</td><td>The open Session in which the command will be invoked. </td></tr>
    <tr><td class="paramname">commandID,:</td><td>The identifier of the Command within the Trusted Application to invoke. The meaning of each Command Identifier must be defined in the protocol exposed by the Trusted Application </td></tr>
    <tr><td class="paramname">operation,:</td><td>A pointer to a Client Application initialized <em><a class="el" href="structTEEC__Operation.html" title="The TEEC_Operation structure is used to contain control information related to an operation that is t...">TEEC_Operation</a></em> structure, or NULL if there is no payload to send or if the Command does not need to support cancellation. </td></tr>
    <tr><td class="paramname">returnOrigin,:</td><td>A pointer to a variable which will contain the return origin. This field may be <em>NULL</em> if the return origin is not needed.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>TEEC_Result: TEEC_SUCCESS: The command was successfully invoked. <br/>
 TEEC_ERROR_*: An implementation-defined error code for any other error.</dd></dl>
<p>Invokes a command within the session.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">session,:</td><td>Pointer to session </td></tr>
    <tr><td class="paramname">commandID,:</td><td>Command ID </td></tr>
    <tr><td class="paramname">operation,:</td><td>Pointer to operation structure </td></tr>
    <tr><td class="paramname">returnOrigin,:</td><td>Pointer to the return origin</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>TEEC_Result: TEEC_SUCCESS: The command was successfully invoked. <br/>
 TEEC_ERROR_*: An implementation-defined error code for any other error. </dd></dl>

<p>Definition at line <a class="el" href="otz__tee__api_8c_source.html#l00488">488</a> of file <a class="el" href="otz__tee__api_8c_source.html">otz_tee_api.c</a>.</p>
<div class="fragment"><div class="line">{</div>
<div class="line">        <span class="keywordtype">int</span> ret = <a class="code" href="otz__tee__api_8h.html#a586a43c1886aa09dc9541fb66e6d8d7fa4d19c2c024e37edc5f04892bb6739dbe">TEEC_SUCCESS</a>;</div>
<div class="line">    <span class="keywordtype">int</span> rel_ret;</div>
<div class="line">    <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> inout = 0; <span class="comment">/* in = 0; out = 1; inout = 2 */</span></div>
<div class="line">    <a class="code" href="otz__api_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> param_types[4], param_count;</div>
<div class="line">    <span class="keyword">struct </span><a class="code" href="structotz__client__encode__cmd.html" title="Encode command structure.">otz_client_encode_cmd</a> enc;</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">if</span>(session == <a class="code" href="sw__types_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) {</div>
<div class="line">        printf(<span class="stringliteral">&quot;TEEC_InvokeCommand : Illegal argument\n&quot;</span>);    </div>
<div class="line">        <span class="keywordflow">return</span> <a class="code" href="otz__tee__api_8h.html#a586a43c1886aa09dc9541fb66e6d8d7fa4b7583ef234ccb0ef6f7492ee6e8200d">TEEC_ERROR_BAD_PARAMETERS</a>;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    enc.encode_id = -1;</div>
<div class="line">    enc.cmd_id = commandID;</div>
<div class="line">    enc.service_id = session-&gt;<a class="code" href="structTEEC__Session.html#aa2fc5ceee64cdc8d7f3e3b83c82c1be3">service_id</a> ;</div>
<div class="line">    enc.session_id = session-&gt;<a class="code" href="structTEEC__Session.html#a00ba158c15263804225042278230d3b1">session_id</a> ;</div>
<div class="line"></div>
<div class="line"><span class="comment">/* Need to support cancellation in future releases */</span></div>
<div class="line">    <span class="keywordflow">if</span>(operation &amp;&amp; !operation-&gt;<a class="code" href="structTEEC__Operation.html#a7eae7fcad883d4d78c9daef00fe08e6c">started</a>) {</div>
<div class="line">        printf(</div>
<div class="line">            <span class="stringliteral">&quot;TEEC_InvokeCommand : cancellation support not yet implemented\n&quot;</span>);   </div>
<div class="line">        <span class="keywordflow">return</span> <a class="code" href="otz__tee__api_8h.html#a586a43c1886aa09dc9541fb66e6d8d7fa4179635876af36d07712ab79da64afa7">TEEC_ERROR_NOT_IMPLEMENTED</a>;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    session-&gt;<a class="code" href="structTEEC__Session.html#ae21202e1d124456453722861aee399aa">operation_cnt</a>++;</div>
<div class="line"><span class="comment">/* Encode the data */</span></div>
<div class="line">    <span class="keywordflow">if</span>(operation-&gt;<a class="code" href="structTEEC__Operation.html#afd2f1c406a61de0f0595824295bcb050">paramTypes</a> != 0) {</div>
<div class="line">        param_types[0] = operation-&gt;<a class="code" href="structTEEC__Operation.html#afd2f1c406a61de0f0595824295bcb050">paramTypes</a> &amp; 0xf;</div>
<div class="line">        param_types[1] = (operation-&gt;<a class="code" href="structTEEC__Operation.html#afd2f1c406a61de0f0595824295bcb050">paramTypes</a> &gt;&gt; 4) &amp; 0xf;        </div>
<div class="line">        param_types[2] = (operation-&gt;<a class="code" href="structTEEC__Operation.html#afd2f1c406a61de0f0595824295bcb050">paramTypes</a> &gt;&gt; 8) &amp; 0xf;        </div>
<div class="line">        param_types[3] = (operation-&gt;<a class="code" href="structTEEC__Operation.html#afd2f1c406a61de0f0595824295bcb050">paramTypes</a> &gt;&gt; 12) &amp; 0xf;        </div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">for</span>(param_count = 0; param_count &lt; 4; param_count++) {</div>
<div class="line">            <span class="keywordflow">if</span>( (param_types[param_count] == <a class="code" href="otz__tee__client__api_8h.html#a844239ef6fbb152b5e83b296be117fa9ae062e0502be2f5372812053a3d1fc031">TEEC_VALUE_INPUT</a>) ||</div>
<div class="line">                (param_types[param_count] == <a class="code" href="otz__tee__client__api_8h.html#a844239ef6fbb152b5e83b296be117fa9a0d3155a759f5f3ea299be0a493ee4924">TEEC_VALUE_INOUT</a>) ||</div>
<div class="line">                (param_types[param_count] == <a class="code" href="otz__tee__client__api_8h.html#a844239ef6fbb152b5e83b296be117fa9ad8e807bd3166fb18b91917a42426323b">TEEC_VALUE_OUTPUT</a>)) {</div>
<div class="line">                enc.data = (<span class="keywordtype">void</span>*)&amp;operation-&gt;<a class="code" href="structTEEC__Operation.html#a7c40ba20ef6ab4bcbd5a75e2c577e011">params</a>[param_count].<a class="code" href="unionTEEC__Parameter.html#a819a08a56fe8d2cbbeb4a4409d60c975">value</a>.<a class="code" href="structTEEC__Value.html#a9092e5e087843ebfc5d7cfa40f04a1c2">a</a>;</div>
<div class="line">                enc.len  = <span class="keyword">sizeof</span>(<a class="code" href="otz__api_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a>);</div>
<div class="line"></div>
<div class="line">                <span class="keywordflow">if</span>(param_types[param_count] == <a class="code" href="otz__tee__client__api_8h.html#a844239ef6fbb152b5e83b296be117fa9ae062e0502be2f5372812053a3d1fc031">TEEC_VALUE_INPUT</a>)</div>
<div class="line">                    inout = 0;</div>
<div class="line">                <span class="keywordflow">else</span> <span class="keywordflow">if</span>(param_types[param_count] == <a class="code" href="otz__tee__client__api_8h.html#a844239ef6fbb152b5e83b296be117fa9ad8e807bd3166fb18b91917a42426323b">TEEC_VALUE_OUTPUT</a>)</div>
<div class="line">                    inout = 1;</div>
<div class="line">                <span class="keywordflow">else</span> <span class="keywordflow">if</span>(param_types[param_count] == <a class="code" href="otz__tee__client__api_8h.html#a844239ef6fbb152b5e83b296be117fa9a0d3155a759f5f3ea299be0a493ee4924">TEEC_VALUE_INOUT</a>)</div>
<div class="line">                    inout = 2;</div>
<div class="line">                                </div>
<div class="line">                <span class="keywordflow">if</span>((inout == 0) | (inout == 2))</div>
<div class="line">                    enc.param_type = <a class="code" href="otz__common_8h.html#a792f9d4615b444fce1b56b3c7b6e8052af60016bf7987a1ce074d83f028f07614">OTZC_PARAM_IN</a>; </div>
<div class="line">                <span class="keywordflow">else</span> <span class="keywordflow">if</span>(inout == 1)</div>
<div class="line">                    enc.param_type = <a class="code" href="otz__common_8h.html#a792f9d4615b444fce1b56b3c7b6e8052a53a3f6b1183de5cf3cf9c9d564b164bc">OTZC_PARAM_OUT</a>; </div>
<div class="line"></div>
<div class="line">                ret = ioctl(session-&gt;<a class="code" href="structTEEC__Session.html#ab72c9ecca6e5cb3d7b10ff75754549bb">device</a>-&gt;<a class="code" href="structTEEC__Context.html#a33f0bc3b43f53a2daf1dbafc82e3a804">fd</a>, </div>
<div class="line">                            <a class="code" href="otz__client_8h.html#ac6a8a73b9377df5e63f60dfbf9163fbb">OTZ_CLIENT_IOCTL_ENC_UINT32</a>, &amp;enc);</div>
<div class="line">                <span class="keywordflow">if</span> (ret) {</div>
<div class="line">                    <span class="keywordflow">if</span>(returnOrigin)</div>
<div class="line">                        *returnOrigin = <a class="code" href="otz__tee__client__api_8h.html#a7cec7a0d1fa340adc3d3186b6eeb63fca8f66dc5e481382d361fd654fb9e42ed1">TEEC_ORIGIN_API</a>;</div>
<div class="line">                    session-&gt;<a class="code" href="structTEEC__Session.html#ad23a0825971ef9d621f36eb05035c7da">s_errno</a> = <a class="code" href="sw__filelib_8h.html#ad65a8842cc674e3ddf69355898c0ecbf">errno</a>;</div>
<div class="line">                    perror(<span class="stringliteral">&quot;TEEC_InvokeCommand: encoding value data failed\n&quot;</span>);</div>
<div class="line">                    <span class="keywordflow">break</span>;</div>
<div class="line">                }</div>
<div class="line"></div>
<div class="line">                <span class="keywordflow">if</span>(inout == 2) {</div>
<div class="line">                    enc.param_type = <a class="code" href="otz__common_8h.html#a792f9d4615b444fce1b56b3c7b6e8052a53a3f6b1183de5cf3cf9c9d564b164bc">OTZC_PARAM_OUT</a>; </div>
<div class="line">                    ret = ioctl(session-&gt;<a class="code" href="structTEEC__Session.html#ab72c9ecca6e5cb3d7b10ff75754549bb">device</a>-&gt;<a class="code" href="structTEEC__Context.html#a33f0bc3b43f53a2daf1dbafc82e3a804">fd</a>, </div>
<div class="line">                                <a class="code" href="otz__client_8h.html#ac6a8a73b9377df5e63f60dfbf9163fbb">OTZ_CLIENT_IOCTL_ENC_UINT32</a>, &amp;enc);</div>
<div class="line">                    <span class="keywordflow">if</span> (ret) {</div>
<div class="line">                        <span class="keywordflow">if</span>(returnOrigin)</div>
<div class="line">                            *returnOrigin = <a class="code" href="otz__tee__client__api_8h.html#a7cec7a0d1fa340adc3d3186b6eeb63fca8f66dc5e481382d361fd654fb9e42ed1">TEEC_ORIGIN_API</a>;</div>
<div class="line">                        session-&gt;<a class="code" href="structTEEC__Session.html#ad23a0825971ef9d621f36eb05035c7da">s_errno</a> = <a class="code" href="sw__filelib_8h.html#ad65a8842cc674e3ddf69355898c0ecbf">errno</a>;</div>
<div class="line">                        perror(</div>
<div class="line">                            <span class="stringliteral">&quot;TEEC_InvokeCommand: encoding value data failed\n&quot;</span>);</div>
<div class="line">                        <span class="keywordflow">break</span>;</div>
<div class="line">                    }</div>
<div class="line">                }</div>
<div class="line"></div>
<div class="line"></div>
<div class="line">                <span class="keywordflow">if</span>(<a class="code" href="otz__tee__client__api_8h.html#a8cee8c3207cf162f74fe0e6832640a72">TEEC_VALUE_UNDEF</a> != </div>
<div class="line">                    operation-&gt;<a class="code" href="structTEEC__Operation.html#a7c40ba20ef6ab4bcbd5a75e2c577e011">params</a>[param_count].<a class="code" href="unionTEEC__Parameter.html#a819a08a56fe8d2cbbeb4a4409d60c975">value</a>.<a class="code" href="structTEEC__Value.html#ad6cef620e07a83dabbc6220020ee47b5">b</a>) {</div>
<div class="line">                    enc.data = (<span class="keywordtype">void</span>*)&amp;operation-&gt;<a class="code" href="structTEEC__Operation.html#a7c40ba20ef6ab4bcbd5a75e2c577e011">params</a>[param_count].<a class="code" href="unionTEEC__Parameter.html#a819a08a56fe8d2cbbeb4a4409d60c975">value</a>.<a class="code" href="structTEEC__Value.html#ad6cef620e07a83dabbc6220020ee47b5">b</a>;</div>
<div class="line">                    enc.len  = <span class="keyword">sizeof</span>(<a class="code" href="otz__api_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a>);</div>
<div class="line">                    <span class="keywordflow">if</span>((inout == 0) | (inout == 2))</div>
<div class="line">                        enc.param_type = <a class="code" href="otz__common_8h.html#a792f9d4615b444fce1b56b3c7b6e8052af60016bf7987a1ce074d83f028f07614">OTZC_PARAM_IN</a>; </div>
<div class="line">                    <span class="keywordflow">else</span> <span class="keywordflow">if</span>(inout == 1)</div>
<div class="line">                        enc.param_type = <a class="code" href="otz__common_8h.html#a792f9d4615b444fce1b56b3c7b6e8052a53a3f6b1183de5cf3cf9c9d564b164bc">OTZC_PARAM_OUT</a>; </div>
<div class="line"></div>
<div class="line">                    ret = ioctl(session-&gt;<a class="code" href="structTEEC__Session.html#ab72c9ecca6e5cb3d7b10ff75754549bb">device</a>-&gt;<a class="code" href="structTEEC__Context.html#a33f0bc3b43f53a2daf1dbafc82e3a804">fd</a>, </div>
<div class="line">                                <a class="code" href="otz__client_8h.html#ac6a8a73b9377df5e63f60dfbf9163fbb">OTZ_CLIENT_IOCTL_ENC_UINT32</a>, &amp;enc);</div>
<div class="line">                    <span class="keywordflow">if</span> (ret) {</div>
<div class="line">                        <span class="keywordflow">if</span>(returnOrigin)</div>
<div class="line">                            *returnOrigin = <a class="code" href="otz__tee__client__api_8h.html#a7cec7a0d1fa340adc3d3186b6eeb63fca8f66dc5e481382d361fd654fb9e42ed1">TEEC_ORIGIN_API</a>;</div>
<div class="line">                        session-&gt;<a class="code" href="structTEEC__Session.html#ad23a0825971ef9d621f36eb05035c7da">s_errno</a> = <a class="code" href="sw__filelib_8h.html#ad65a8842cc674e3ddf69355898c0ecbf">errno</a>;</div>
<div class="line">                        perror(</div>
<div class="line">                            <span class="stringliteral">&quot;TEEC_InvokeCommand: encoding value data failed\n&quot;</span>);</div>
<div class="line">                        <span class="keywordflow">break</span>;</div>
<div class="line">                    }</div>
<div class="line">                    <span class="keywordflow">if</span>(inout == 2) {</div>
<div class="line">                        enc.param_type = <a class="code" href="otz__common_8h.html#a792f9d4615b444fce1b56b3c7b6e8052a53a3f6b1183de5cf3cf9c9d564b164bc">OTZC_PARAM_OUT</a>; </div>
<div class="line">                        ret = ioctl(session-&gt;<a class="code" href="structTEEC__Session.html#ab72c9ecca6e5cb3d7b10ff75754549bb">device</a>-&gt;<a class="code" href="structTEEC__Context.html#a33f0bc3b43f53a2daf1dbafc82e3a804">fd</a>, </div>
<div class="line">                                    <a class="code" href="otz__client_8h.html#ac6a8a73b9377df5e63f60dfbf9163fbb">OTZ_CLIENT_IOCTL_ENC_UINT32</a>, &amp;enc);</div>
<div class="line">                        <span class="keywordflow">if</span> (ret) {</div>
<div class="line">                            <span class="keywordflow">if</span>(returnOrigin)</div>
<div class="line">                                *returnOrigin = <a class="code" href="otz__tee__client__api_8h.html#a7cec7a0d1fa340adc3d3186b6eeb63fca8f66dc5e481382d361fd654fb9e42ed1">TEEC_ORIGIN_API</a>;</div>
<div class="line">                            session-&gt;<a class="code" href="structTEEC__Session.html#ad23a0825971ef9d621f36eb05035c7da">s_errno</a> = <a class="code" href="sw__filelib_8h.html#ad65a8842cc674e3ddf69355898c0ecbf">errno</a>;</div>
<div class="line">                            perror(<span class="stringliteral">&quot;TEEC_InvokeCommand: \</span></div>
<div class="line"><span class="stringliteral">encoding value data failed\n&quot;</span>);</div>
<div class="line"></div>
<div class="line">                            <span class="keywordflow">break</span>;</div>
<div class="line">                        }</div>
<div class="line">                    }</div>
<div class="line">                }</div>
<div class="line">            } <span class="comment">/* end if for TEEC_VALUE check */</span></div>
<div class="line">            <span class="keywordflow">else</span> <span class="keywordflow">if</span>( (param_types[param_count] == <a class="code" href="otz__tee__client__api_8h.html#a844239ef6fbb152b5e83b296be117fa9a0fde2e095c933376a0360788e2dd7f90">TEEC_MEMREF_WHOLE</a>) ||</div>
<div class="line">                (param_types[param_count] == <a class="code" href="otz__tee__client__api_8h.html#a844239ef6fbb152b5e83b296be117fa9a83a852a82f09a38ddd6358bf83084dda">TEEC_MEMREF_PARTIAL_INPUT</a>) ||</div>
<div class="line">                (param_types[param_count] == <a class="code" href="otz__tee__client__api_8h.html#a844239ef6fbb152b5e83b296be117fa9a530eefe7668b93a6e6a5e02d70233cd3">TEEC_MEMREF_PARTIAL_INOUT</a>) ||</div>
<div class="line">                (param_types[param_count] == <a class="code" href="otz__tee__client__api_8h.html#a844239ef6fbb152b5e83b296be117fa9a3b0c66b1008718e5108fe84da60fafe0">TEEC_MEMREF_PARTIAL_OUTPUT</a>)) {</div>
<div class="line"></div>
<div class="line">                <span class="keywordflow">if</span>(!operation-&gt;<a class="code" href="structTEEC__Operation.html#a7c40ba20ef6ab4bcbd5a75e2c577e011">params</a>[param_count].<a class="code" href="unionTEEC__Parameter.html#a341d29a495da6914bb99b0af853c4fd1">memref</a>.<a class="code" href="structTEEC__RegisteredMemoryReference.html#a5246c33b96861a607d173c5b9a6cf5f8">parent</a>) {</div>
<div class="line">                    <span class="keywordflow">if</span>(returnOrigin)</div>
<div class="line">                        *returnOrigin = <a class="code" href="otz__tee__client__api_8h.html#a7cec7a0d1fa340adc3d3186b6eeb63fca8f66dc5e481382d361fd654fb9e42ed1">TEEC_ORIGIN_API</a>;</div>
<div class="line">                    ret = <a class="code" href="otz__tee__api_8h.html#a586a43c1886aa09dc9541fb66e6d8d7fa8f1a521bf548e65263e0a9984414682f">TEEC_ERROR_NO_DATA</a>;</div>
<div class="line">                    printf(<span class="stringliteral">&quot;TEEC_InvokeCommand: \</span></div>
<div class="line"><span class="stringliteral">memory reference parent is NULL\n&quot;</span>);</div>
<div class="line"></div>
<div class="line">                    <span class="keywordflow">break</span>; </div>
<div class="line">                }</div>
<div class="line"></div>
<div class="line">                <span class="keywordflow">if</span>(!operation-&gt;<a class="code" href="structTEEC__Operation.html#a7c40ba20ef6ab4bcbd5a75e2c577e011">params</a>[param_count].<a class="code" href="unionTEEC__Parameter.html#a341d29a495da6914bb99b0af853c4fd1">memref</a>.<a class="code" href="structTEEC__RegisteredMemoryReference.html#a5246c33b96861a607d173c5b9a6cf5f8">parent</a>-&gt;<a class="code" href="structTEEC__SharedMemory.html#a7ced755c88a53bfadc0354fe1e33e0f9">buffer</a>) {</div>
<div class="line">                    <span class="keywordflow">if</span>(returnOrigin)</div>
<div class="line">                        *returnOrigin = <a class="code" href="otz__tee__client__api_8h.html#a7cec7a0d1fa340adc3d3186b6eeb63fca8f66dc5e481382d361fd654fb9e42ed1">TEEC_ORIGIN_API</a>;</div>
<div class="line">                    ret = <a class="code" href="otz__tee__api_8h.html#a586a43c1886aa09dc9541fb66e6d8d7fa8f1a521bf548e65263e0a9984414682f">TEEC_ERROR_NO_DATA</a>;</div>
<div class="line">                    printf(<span class="stringliteral">&quot;TEEC_InvokeCommand: \</span></div>
<div class="line"><span class="stringliteral">memory reference parent data is NULL\n&quot;</span>);</div>
<div class="line">                    <span class="keywordflow">break</span>; </div>
<div class="line">                }</div>
<div class="line"></div>
<div class="line">                <span class="keywordflow">if</span>(param_types[param_count] == <a class="code" href="otz__tee__client__api_8h.html#a844239ef6fbb152b5e83b296be117fa9a83a852a82f09a38ddd6358bf83084dda">TEEC_MEMREF_PARTIAL_INPUT</a>) {</div>
<div class="line">                    <span class="keywordflow">if</span>(!(operation-&gt;<a class="code" href="structTEEC__Operation.html#a7c40ba20ef6ab4bcbd5a75e2c577e011">params</a>[param_count].<a class="code" href="unionTEEC__Parameter.html#a341d29a495da6914bb99b0af853c4fd1">memref</a>.<a class="code" href="structTEEC__RegisteredMemoryReference.html#a5246c33b96861a607d173c5b9a6cf5f8">parent</a>-&gt;<a class="code" href="structTEEC__SharedMemory.html#a952af666858535b863b162a8b9e53e0c">flags</a> </div>
<div class="line">                                        &amp; <a class="code" href="otz__tee__client__api_8h.html#ad2ca265b0a012cb196691e4037b558dca8407d60bc4211cd205bdf111c3ce512c">TEEC_MEM_INPUT</a>)) {</div>
<div class="line">                        <span class="keywordflow">if</span>(returnOrigin)</div>
<div class="line">                            *returnOrigin = <a class="code" href="otz__tee__client__api_8h.html#a7cec7a0d1fa340adc3d3186b6eeb63fca8f66dc5e481382d361fd654fb9e42ed1">TEEC_ORIGIN_API</a>;</div>
<div class="line">                        ret = <a class="code" href="otz__tee__api_8h.html#a586a43c1886aa09dc9541fb66e6d8d7fad73f0656c5965302e08498f884d5d915">TEEC_ERROR_BAD_FORMAT</a>;</div>
<div class="line">                    printf(<span class="stringliteral">&quot;TEEC_InvokeCommand: \</span></div>
<div class="line"><span class="stringliteral">memory reference direction is invalid\n&quot;</span>);</div>
<div class="line">                        <span class="keywordflow">break</span>;</div>
<div class="line">                    }</div>
<div class="line">                }</div>
<div class="line">                <span class="keywordflow">if</span>(param_types[param_count] == <a class="code" href="otz__tee__client__api_8h.html#a844239ef6fbb152b5e83b296be117fa9a3b0c66b1008718e5108fe84da60fafe0">TEEC_MEMREF_PARTIAL_OUTPUT</a>) {</div>
<div class="line">                    <span class="keywordflow">if</span>(!(operation-&gt;<a class="code" href="structTEEC__Operation.html#a7c40ba20ef6ab4bcbd5a75e2c577e011">params</a>[param_count].<a class="code" href="unionTEEC__Parameter.html#a341d29a495da6914bb99b0af853c4fd1">memref</a>.<a class="code" href="structTEEC__RegisteredMemoryReference.html#a5246c33b96861a607d173c5b9a6cf5f8">parent</a>-&gt;<a class="code" href="structTEEC__SharedMemory.html#a952af666858535b863b162a8b9e53e0c">flags</a> </div>
<div class="line">                                        &amp; <a class="code" href="otz__tee__client__api_8h.html#ad2ca265b0a012cb196691e4037b558dca4d822f60ca1969d1513b14b2805b234e">TEEC_MEM_OUTPUT</a>)) {</div>
<div class="line">                        <span class="keywordflow">if</span>(returnOrigin)</div>
<div class="line">                            *returnOrigin = <a class="code" href="otz__tee__client__api_8h.html#a7cec7a0d1fa340adc3d3186b6eeb63fca8f66dc5e481382d361fd654fb9e42ed1">TEEC_ORIGIN_API</a>;</div>
<div class="line">                        ret = <a class="code" href="otz__tee__api_8h.html#a586a43c1886aa09dc9541fb66e6d8d7fad73f0656c5965302e08498f884d5d915">TEEC_ERROR_BAD_FORMAT</a>;</div>
<div class="line">                    printf(<span class="stringliteral">&quot;TEEC_InvokeCommand: \</span></div>
<div class="line"><span class="stringliteral">memory reference direction is invalid\n&quot;</span>);</div>
<div class="line">                        <span class="keywordflow">break</span>;</div>
<div class="line">                    }</div>
<div class="line">                }</div>
<div class="line"></div>
<div class="line">                <span class="keywordflow">if</span>(param_types[param_count] == <a class="code" href="otz__tee__client__api_8h.html#a844239ef6fbb152b5e83b296be117fa9a530eefe7668b93a6e6a5e02d70233cd3">TEEC_MEMREF_PARTIAL_INOUT</a>) {</div>
<div class="line">                    <span class="keywordflow">if</span>(!(operation-&gt;<a class="code" href="structTEEC__Operation.html#a7c40ba20ef6ab4bcbd5a75e2c577e011">params</a>[param_count].<a class="code" href="unionTEEC__Parameter.html#a341d29a495da6914bb99b0af853c4fd1">memref</a>.<a class="code" href="structTEEC__RegisteredMemoryReference.html#a5246c33b96861a607d173c5b9a6cf5f8">parent</a>-&gt;<a class="code" href="structTEEC__SharedMemory.html#a952af666858535b863b162a8b9e53e0c">flags</a> </div>
<div class="line">                                        &amp; TEEC_MEM_INPUT)) {</div>
<div class="line">                        <span class="keywordflow">if</span>(returnOrigin)</div>
<div class="line">                            *returnOrigin = <a class="code" href="otz__tee__client__api_8h.html#a7cec7a0d1fa340adc3d3186b6eeb63fca8f66dc5e481382d361fd654fb9e42ed1">TEEC_ORIGIN_API</a>;</div>
<div class="line">                        ret = <a class="code" href="otz__tee__api_8h.html#a586a43c1886aa09dc9541fb66e6d8d7fad73f0656c5965302e08498f884d5d915">TEEC_ERROR_BAD_FORMAT</a>;</div>
<div class="line">                    printf(<span class="stringliteral">&quot;TEEC_InvokeCommand: \</span></div>
<div class="line"><span class="stringliteral">memory reference direction is invalid\n&quot;</span>);</div>
<div class="line">                        <span class="keywordflow">break</span>;</div>
<div class="line">                    }</div>
<div class="line">                    <span class="keywordflow">if</span>(!(operation-&gt;<a class="code" href="structTEEC__Operation.html#a7c40ba20ef6ab4bcbd5a75e2c577e011">params</a>[param_count].<a class="code" href="unionTEEC__Parameter.html#a341d29a495da6914bb99b0af853c4fd1">memref</a>.<a class="code" href="structTEEC__RegisteredMemoryReference.html#a5246c33b96861a607d173c5b9a6cf5f8">parent</a>-&gt;<a class="code" href="structTEEC__SharedMemory.html#a952af666858535b863b162a8b9e53e0c">flags</a> </div>
<div class="line">                                        &amp; TEEC_MEM_OUTPUT)) {</div>
<div class="line">                        <span class="keywordflow">if</span>(returnOrigin)</div>
<div class="line">                            *returnOrigin = <a class="code" href="otz__tee__client__api_8h.html#a7cec7a0d1fa340adc3d3186b6eeb63fca8f66dc5e481382d361fd654fb9e42ed1">TEEC_ORIGIN_API</a>;</div>
<div class="line">                        ret = <a class="code" href="otz__tee__api_8h.html#a586a43c1886aa09dc9541fb66e6d8d7fad73f0656c5965302e08498f884d5d915">TEEC_ERROR_BAD_FORMAT</a>;</div>
<div class="line">                    printf(<span class="stringliteral">&quot;TEEC_InvokeCommand: \</span></div>
<div class="line"><span class="stringliteral">memory reference direction is invalid\n&quot;</span>);</div>
<div class="line">                        <span class="keywordflow">break</span>;</div>
<div class="line">                    }</div>
<div class="line">                }</div>
<div class="line"></div>
<div class="line">                <span class="keywordflow">if</span>((param_types[param_count] == <a class="code" href="otz__tee__client__api_8h.html#a844239ef6fbb152b5e83b296be117fa9a83a852a82f09a38ddd6358bf83084dda">TEEC_MEMREF_PARTIAL_INPUT</a>) || </div>
<div class="line">                (param_types[param_count] == <a class="code" href="otz__tee__client__api_8h.html#a844239ef6fbb152b5e83b296be117fa9a530eefe7668b93a6e6a5e02d70233cd3">TEEC_MEMREF_PARTIAL_INOUT</a>) ||</div>
<div class="line">                (param_types[param_count] == <a class="code" href="otz__tee__client__api_8h.html#a844239ef6fbb152b5e83b296be117fa9a3b0c66b1008718e5108fe84da60fafe0">TEEC_MEMREF_PARTIAL_OUTPUT</a>)) {</div>
<div class="line">                    <span class="keywordflow">if</span>((operation-&gt;<a class="code" href="structTEEC__Operation.html#a7c40ba20ef6ab4bcbd5a75e2c577e011">params</a>[param_count].<a class="code" href="unionTEEC__Parameter.html#a341d29a495da6914bb99b0af853c4fd1">memref</a>.<a class="code" href="structTEEC__RegisteredMemoryReference.html#a8951871c92918826408dfedc4156ee20">offset</a> + </div>
<div class="line">                            operation-&gt;<a class="code" href="structTEEC__Operation.html#a7c40ba20ef6ab4bcbd5a75e2c577e011">params</a>[param_count].<a class="code" href="unionTEEC__Parameter.html#a341d29a495da6914bb99b0af853c4fd1">memref</a>.<a class="code" href="structTEEC__RegisteredMemoryReference.html#a2d86e5093bb7930fcc70730ad73ab103">size</a> &gt; </div>
<div class="line">                                operation-&gt;</div>
<div class="line">                                    params[param_count].memref.parent-&gt;size) ) {</div>
<div class="line">                        <span class="keywordflow">if</span>(returnOrigin)</div>
<div class="line">                            *returnOrigin = <a class="code" href="otz__tee__client__api_8h.html#a7cec7a0d1fa340adc3d3186b6eeb63fca8f66dc5e481382d361fd654fb9e42ed1">TEEC_ORIGIN_API</a>;</div>
<div class="line">                        ret = <a class="code" href="otz__tee__api_8h.html#a586a43c1886aa09dc9541fb66e6d8d7fa4065d670c507f8631394171af3ffe090">TEEC_ERROR_EXCESS_DATA</a>;</div>
<div class="line">                    printf(<span class="stringliteral">&quot;TEEC_InvokeCommand: \</span></div>
<div class="line"><span class="stringliteral">memory reference offset + size is greater than the actual memory size\n&quot;</span>);</div>
<div class="line">                        <span class="keywordflow">break</span>;</div>
<div class="line">                    }                </div>
<div class="line">                }</div>
<div class="line"></div>
<div class="line">                <span class="keywordflow">if</span>(param_types[param_count] == <a class="code" href="otz__tee__client__api_8h.html#a844239ef6fbb152b5e83b296be117fa9a83a852a82f09a38ddd6358bf83084dda">TEEC_MEMREF_PARTIAL_INPUT</a>) {</div>
<div class="line">                    inout = 0;</div>
<div class="line">                }</div>
<div class="line">                <span class="keywordflow">else</span> <span class="keywordflow">if</span>(param_types[param_count] </div>
<div class="line">                            == <a class="code" href="otz__tee__client__api_8h.html#a844239ef6fbb152b5e83b296be117fa9a3b0c66b1008718e5108fe84da60fafe0">TEEC_MEMREF_PARTIAL_OUTPUT</a>) {</div>
<div class="line">                    inout = 1;</div>
<div class="line">                }</div>
<div class="line">                <span class="keywordflow">else</span> <span class="keywordflow">if</span>(param_types[param_count] </div>
<div class="line">                            == <a class="code" href="otz__tee__client__api_8h.html#a844239ef6fbb152b5e83b296be117fa9a530eefe7668b93a6e6a5e02d70233cd3">TEEC_MEMREF_PARTIAL_INOUT</a>) {</div>
<div class="line">                    inout = 2;</div>
<div class="line">                }</div>
<div class="line">                <span class="keywordflow">else</span> <span class="keywordflow">if</span>(param_types[param_count] == <a class="code" href="otz__tee__client__api_8h.html#a844239ef6fbb152b5e83b296be117fa9a0fde2e095c933376a0360788e2dd7f90">TEEC_MEMREF_WHOLE</a>) {</div>
<div class="line"></div>
<div class="line">                    <span class="keywordflow">if</span>(operation-&gt;</div>
<div class="line">                            params[param_count].memref.parent-&gt;flags == </div>
<div class="line">                            (TEEC_MEM_INPUT | TEEC_MEM_OUTPUT))</div>
<div class="line">                        inout = 2;</div>
<div class="line">                    <span class="keywordflow">else</span> <span class="keywordflow">if</span>(operation-&gt;</div>
<div class="line">                            params[param_count].memref.parent-&gt;flags == </div>
<div class="line">                            TEEC_MEM_INPUT)</div>
<div class="line">                        inout = 0;</div>
<div class="line">                    <span class="keywordflow">else</span> <span class="keywordflow">if</span>(operation-&gt;</div>
<div class="line">                            params[param_count].memref.parent-&gt;flags == </div>
<div class="line">                            TEEC_MEM_OUTPUT)</div>
<div class="line">                        inout = 1;</div>
<div class="line">                }</div>
<div class="line"></div>
<div class="line">                <span class="keywordflow">if</span>(param_types[param_count] == <a class="code" href="otz__tee__client__api_8h.html#a844239ef6fbb152b5e83b296be117fa9a0fde2e095c933376a0360788e2dd7f90">TEEC_MEMREF_WHOLE</a>) {</div>
<div class="line">                    enc.len = operation-&gt;</div>
<div class="line">                                params[param_count].memref.parent-&gt;size;</div>
<div class="line">                    enc.offset = 0;</div>
<div class="line">                }</div>
<div class="line">                <span class="keywordflow">else</span> {</div>
<div class="line">                    enc.len  = operation-&gt;<a class="code" href="structTEEC__Operation.html#a7c40ba20ef6ab4bcbd5a75e2c577e011">params</a>[param_count].<a class="code" href="unionTEEC__Parameter.html#a341d29a495da6914bb99b0af853c4fd1">memref</a>.<a class="code" href="structTEEC__RegisteredMemoryReference.html#a2d86e5093bb7930fcc70730ad73ab103">size</a>;</div>
<div class="line">                    enc.offset = operation-&gt;<a class="code" href="structTEEC__Operation.html#a7c40ba20ef6ab4bcbd5a75e2c577e011">params</a>[param_count].<a class="code" href="unionTEEC__Parameter.html#a341d29a495da6914bb99b0af853c4fd1">memref</a>.<a class="code" href="structTEEC__RegisteredMemoryReference.html#a8951871c92918826408dfedc4156ee20">offset</a>;</div>
<div class="line">                }</div>
<div class="line"></div>
<div class="line">                <span class="keywordflow">if</span>(inout == 0) {</div>
<div class="line">                    enc.flags = <a class="code" href="otz__api_8h.html#a0726f9cc52e17d8e6cd7dd085cc62527a7aa74f7037354b0cd675442b600060c0">OTZ_MEM_SERVICE_RO</a>;</div>
<div class="line">                    enc.param_type = <a class="code" href="otz__common_8h.html#a792f9d4615b444fce1b56b3c7b6e8052af60016bf7987a1ce074d83f028f07614">OTZC_PARAM_IN</a>; </div>
<div class="line">                }</div>
<div class="line">                <span class="keywordflow">else</span> <span class="keywordflow">if</span>(inout == 1) {</div>
<div class="line">                    enc.flags = <a class="code" href="otz__api_8h.html#a0726f9cc52e17d8e6cd7dd085cc62527a8035deccf29fcd9fe345e3f3e0e4accb">OTZ_MEM_SERVICE_WO</a>;</div>
<div class="line">                    enc.param_type = <a class="code" href="otz__common_8h.html#a792f9d4615b444fce1b56b3c7b6e8052a53a3f6b1183de5cf3cf9c9d564b164bc">OTZC_PARAM_OUT</a>;</div>
<div class="line">                }</div>
<div class="line">                <span class="keywordflow">else</span> <span class="keywordflow">if</span>(inout == 2) {</div>
<div class="line">                    enc.flags = <a class="code" href="otz__api_8h.html#a0726f9cc52e17d8e6cd7dd085cc62527a7aa74f7037354b0cd675442b600060c0">OTZ_MEM_SERVICE_RO</a>;</div>
<div class="line">                    enc.param_type = <a class="code" href="otz__common_8h.html#a792f9d4615b444fce1b56b3c7b6e8052af60016bf7987a1ce074d83f028f07614">OTZC_PARAM_IN</a>; </div>
<div class="line">                }</div>
<div class="line"></div>
<div class="line">                <span class="keywordflow">if</span>(operation-&gt;<a class="code" href="structTEEC__Operation.html#a7c40ba20ef6ab4bcbd5a75e2c577e011">params</a>[param_count].<a class="code" href="unionTEEC__Parameter.html#a341d29a495da6914bb99b0af853c4fd1">memref</a>.<a class="code" href="structTEEC__RegisteredMemoryReference.html#a5246c33b96861a607d173c5b9a6cf5f8">parent</a>-&gt;<a class="code" href="structTEEC__SharedMemory.html#af662eccaf65008ef806549dda52368f1">allocated</a>) {</div>
<div class="line">                    enc.data = </div>
<div class="line">                        operation-&gt;<a class="code" href="structTEEC__Operation.html#a7c40ba20ef6ab4bcbd5a75e2c577e011">params</a>[param_count].<a class="code" href="unionTEEC__Parameter.html#a341d29a495da6914bb99b0af853c4fd1">memref</a>.<a class="code" href="structTEEC__RegisteredMemoryReference.html#a5246c33b96861a607d173c5b9a6cf5f8">parent</a>-&gt;<a class="code" href="structTEEC__SharedMemory.html#a7ced755c88a53bfadc0354fe1e33e0f9">buffer</a>;</div>
<div class="line"></div>
<div class="line">                    ret = ioctl(session-&gt;<a class="code" href="structTEEC__Session.html#ab72c9ecca6e5cb3d7b10ff75754549bb">device</a>-&gt;<a class="code" href="structTEEC__Context.html#a33f0bc3b43f53a2daf1dbafc82e3a804">fd</a>, </div>
<div class="line">                                <a class="code" href="otz__client_8h.html#a1e9c448543d21734707fff1c2ca516c7">OTZ_CLIENT_IOCTL_ENC_MEM_REF</a>, &amp;enc);</div>
<div class="line">                }</div>
<div class="line">                <span class="keywordflow">else</span> {</div>
<div class="line">                    enc.data = </div>
<div class="line">                        (<span class="keywordtype">void</span>*) ((<a class="code" href="otz__api_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a>)operation-&gt;<a class="code" href="structTEEC__Operation.html#a7c40ba20ef6ab4bcbd5a75e2c577e011">params</a>[param_count].</div>
<div class="line">                                memref.parent-&gt;buffer + </div>
<div class="line">                                enc.offset);</div>
<div class="line">                    enc.offset = 0;</div>
<div class="line">                    ret = ioctl(session-&gt;<a class="code" href="structTEEC__Session.html#ab72c9ecca6e5cb3d7b10ff75754549bb">device</a>-&gt;<a class="code" href="structTEEC__Context.html#a33f0bc3b43f53a2daf1dbafc82e3a804">fd</a>, </div>
<div class="line">                                <a class="code" href="otz__client_8h.html#a5191da7defc442a4fd60f2db6127313a">OTZ_CLIENT_IOCTL_ENC_ARRAY</a>, &amp;enc);</div>
<div class="line">                }</div>
<div class="line">                <span class="keywordflow">if</span> (ret){</div>
<div class="line">                    <span class="keywordflow">if</span>(returnOrigin)</div>
<div class="line">                        *returnOrigin = <a class="code" href="otz__tee__client__api_8h.html#a7cec7a0d1fa340adc3d3186b6eeb63fca8f66dc5e481382d361fd654fb9e42ed1">TEEC_ORIGIN_API</a>;</div>
<div class="line">                    session-&gt;<a class="code" href="structTEEC__Session.html#ad23a0825971ef9d621f36eb05035c7da">s_errno</a> = <a class="code" href="sw__filelib_8h.html#ad65a8842cc674e3ddf69355898c0ecbf">errno</a>;</div>
<div class="line">                    perror(<span class="stringliteral">&quot;TEEC_InvokeCommand: \</span></div>
<div class="line"><span class="stringliteral">encoding data in client driver failed\n&quot;</span>);</div>
<div class="line">                    <span class="keywordflow">break</span>;</div>
<div class="line">                }</div>
<div class="line">                <span class="keywordflow">else</span> {</div>
<div class="line"><span class="comment">/*                     operation-&gt;</span></div>
<div class="line"><span class="comment">                        params[param_count].memref.parent-&gt;operation_count++; */</span></div>
<div class="line">                }</div>
<div class="line">                <span class="keywordflow">if</span>(inout == 2) {</div>
<div class="line">                    enc.flags = <a class="code" href="otz__api_8h.html#a0726f9cc52e17d8e6cd7dd085cc62527a8035deccf29fcd9fe345e3f3e0e4accb">OTZ_MEM_SERVICE_WO</a>;</div>
<div class="line">                    enc.param_type = <a class="code" href="otz__common_8h.html#a792f9d4615b444fce1b56b3c7b6e8052a53a3f6b1183de5cf3cf9c9d564b164bc">OTZC_PARAM_OUT</a>; </div>
<div class="line"></div>
<div class="line">                    <span class="keywordflow">if</span>(operation-&gt;</div>
<div class="line">                        params[param_count].memref.parent-&gt;allocated) {</div>
<div class="line">                        ret = ioctl(session-&gt;<a class="code" href="structTEEC__Session.html#ab72c9ecca6e5cb3d7b10ff75754549bb">device</a>-&gt;<a class="code" href="structTEEC__Context.html#a33f0bc3b43f53a2daf1dbafc82e3a804">fd</a>, </div>
<div class="line">                                    <a class="code" href="otz__client_8h.html#a1e9c448543d21734707fff1c2ca516c7">OTZ_CLIENT_IOCTL_ENC_MEM_REF</a>, &amp;enc);</div>
<div class="line">                    }</div>
<div class="line">                    <span class="keywordflow">else</span> {</div>
<div class="line">                        ret = ioctl(session-&gt;<a class="code" href="structTEEC__Session.html#ab72c9ecca6e5cb3d7b10ff75754549bb">device</a>-&gt;<a class="code" href="structTEEC__Context.html#a33f0bc3b43f53a2daf1dbafc82e3a804">fd</a>, </div>
<div class="line">                                    <a class="code" href="otz__client_8h.html#a5191da7defc442a4fd60f2db6127313a">OTZ_CLIENT_IOCTL_ENC_ARRAY</a>, &amp;enc);</div>
<div class="line">                    }</div>
<div class="line"></div>
<div class="line">                    <span class="keywordflow">if</span> (ret){</div>
<div class="line">                        <span class="keywordflow">if</span>(returnOrigin)</div>
<div class="line">                            *returnOrigin = <a class="code" href="otz__tee__client__api_8h.html#a7cec7a0d1fa340adc3d3186b6eeb63fca8f66dc5e481382d361fd654fb9e42ed1">TEEC_ORIGIN_API</a>;</div>
<div class="line">                        session-&gt;<a class="code" href="structTEEC__Session.html#ad23a0825971ef9d621f36eb05035c7da">s_errno</a> = <a class="code" href="sw__filelib_8h.html#ad65a8842cc674e3ddf69355898c0ecbf">errno</a>;</div>
<div class="line">                    perror(<span class="stringliteral">&quot;TEEC_InvokeCommand: \</span></div>
<div class="line"><span class="stringliteral">encoding data in client driver failed\n&quot;</span>);</div>
<div class="line">                        <span class="keywordflow">break</span>;</div>
<div class="line">                    }</div>
<div class="line">                }</div>
<div class="line">            } <span class="comment">/* end if for TEEC_MEM_REF check */</span></div>
<div class="line">            <span class="keywordflow">else</span> <span class="keywordflow">if</span>((param_types[param_count] == <a class="code" href="otz__tee__client__api_8h.html#a844239ef6fbb152b5e83b296be117fa9a08f93f6ac7c6615ff26838e8fa4e441d">TEEC_MEMREF_TEMP_INPUT</a>) ||</div>
<div class="line">               (param_types[param_count] == <a class="code" href="otz__tee__client__api_8h.html#a844239ef6fbb152b5e83b296be117fa9a40a27415d0c255d58f1fad5287879785">TEEC_MEMREF_TEMP_OUTPUT</a>) ||</div>
<div class="line">               (param_types[param_count] == <a class="code" href="otz__tee__client__api_8h.html#a844239ef6fbb152b5e83b296be117fa9a61b21cbecaf1827ddca58f49b2176748">TEEC_MEMREF_TEMP_INOUT</a>)) {</div>
<div class="line"></div>
<div class="line">                <span class="keywordflow">if</span>(!operation-&gt;<a class="code" href="structTEEC__Operation.html#a7c40ba20ef6ab4bcbd5a75e2c577e011">params</a>[param_count].<a class="code" href="unionTEEC__Parameter.html#abb1df8a9d3c54299a3de780e49f2fe92">tmpref</a>.<a class="code" href="structTEEC__TempMemoryReference.html#a814ab10dfaa7eca1fe81f572342ae325">buffer</a>) {</div>
<div class="line">                    <span class="keywordflow">if</span>(returnOrigin)</div>
<div class="line">                        *returnOrigin = <a class="code" href="otz__tee__client__api_8h.html#a7cec7a0d1fa340adc3d3186b6eeb63fca8f66dc5e481382d361fd654fb9e42ed1">TEEC_ORIGIN_API</a>;</div>
<div class="line">                    ret = <a class="code" href="otz__tee__api_8h.html#a586a43c1886aa09dc9541fb66e6d8d7fa8f1a521bf548e65263e0a9984414682f">TEEC_ERROR_NO_DATA</a>;</div>
<div class="line">                    printf(<span class="stringliteral">&quot;TEEC_InvokeCommand: \</span></div>
<div class="line"><span class="stringliteral">temporary memory reference buffer is NULL\n&quot;</span>);</div>
<div class="line">                    <span class="keywordflow">break</span>; </div>
<div class="line">                }</div>
<div class="line">                <span class="comment">/* This is a variation of API spec. */</span></div>
<div class="line">                <span class="keywordflow">if</span>(operation-&gt;<a class="code" href="structTEEC__Operation.html#a7c40ba20ef6ab4bcbd5a75e2c577e011">params</a>[param_count].<a class="code" href="unionTEEC__Parameter.html#abb1df8a9d3c54299a3de780e49f2fe92">tmpref</a>.<a class="code" href="structTEEC__TempMemoryReference.html#ae6076f1360d7b8bbdf79e7b22f45fc29">size</a> == 0) {</div>
<div class="line">                    <span class="keywordflow">if</span>(returnOrigin)</div>
<div class="line">                        *returnOrigin = <a class="code" href="otz__tee__client__api_8h.html#a7cec7a0d1fa340adc3d3186b6eeb63fca8f66dc5e481382d361fd654fb9e42ed1">TEEC_ORIGIN_API</a>;</div>
<div class="line">                    ret = <a class="code" href="otz__tee__api_8h.html#a586a43c1886aa09dc9541fb66e6d8d7fa8f1a521bf548e65263e0a9984414682f">TEEC_ERROR_NO_DATA</a>;</div>
<div class="line">                    printf(<span class="stringliteral">&quot;TEEC_InvokeCommand: \</span></div>
<div class="line"><span class="stringliteral">temporary memory reference size zero is not supported\n&quot;</span>);</div>
<div class="line">                    <span class="keywordflow">break</span>; </div>
<div class="line">                }</div>
<div class="line"></div>
<div class="line">                <span class="keywordflow">if</span>(param_types[param_count] == <a class="code" href="otz__tee__client__api_8h.html#a844239ef6fbb152b5e83b296be117fa9a08f93f6ac7c6615ff26838e8fa4e441d">TEEC_MEMREF_TEMP_INPUT</a>) {</div>
<div class="line">                    inout = 0;</div>
<div class="line">                }</div>
<div class="line">                <span class="keywordflow">else</span> <span class="keywordflow">if</span>(param_types[param_count] </div>
<div class="line">                            == <a class="code" href="otz__tee__client__api_8h.html#a844239ef6fbb152b5e83b296be117fa9a40a27415d0c255d58f1fad5287879785">TEEC_MEMREF_TEMP_OUTPUT</a>) {</div>
<div class="line">                    inout = 1;</div>
<div class="line">                }</div>
<div class="line">                <span class="keywordflow">else</span> <span class="keywordflow">if</span>(param_types[param_count] </div>
<div class="line">                            == <a class="code" href="otz__tee__client__api_8h.html#a844239ef6fbb152b5e83b296be117fa9a61b21cbecaf1827ddca58f49b2176748">TEEC_MEMREF_TEMP_INOUT</a>) {</div>
<div class="line">                    inout = 2;</div>
<div class="line">                }  </div>
<div class="line">                enc.len  = operation-&gt;<a class="code" href="structTEEC__Operation.html#a7c40ba20ef6ab4bcbd5a75e2c577e011">params</a>[param_count].<a class="code" href="unionTEEC__Parameter.html#abb1df8a9d3c54299a3de780e49f2fe92">tmpref</a>.<a class="code" href="structTEEC__TempMemoryReference.html#ae6076f1360d7b8bbdf79e7b22f45fc29">size</a>;</div>
<div class="line"></div>
<div class="line">                <span class="keywordflow">if</span>(inout == 0) {</div>
<div class="line">                    enc.flags = <a class="code" href="otz__api_8h.html#a0726f9cc52e17d8e6cd7dd085cc62527a7aa74f7037354b0cd675442b600060c0">OTZ_MEM_SERVICE_RO</a>;</div>
<div class="line">                    enc.param_type = <a class="code" href="otz__common_8h.html#a792f9d4615b444fce1b56b3c7b6e8052af60016bf7987a1ce074d83f028f07614">OTZC_PARAM_IN</a>; </div>
<div class="line">                }</div>
<div class="line">                <span class="keywordflow">else</span> <span class="keywordflow">if</span>(inout == 1) {</div>
<div class="line">                    enc.flags = <a class="code" href="otz__api_8h.html#a0726f9cc52e17d8e6cd7dd085cc62527a8035deccf29fcd9fe345e3f3e0e4accb">OTZ_MEM_SERVICE_WO</a>;</div>
<div class="line">                    enc.param_type = <a class="code" href="otz__common_8h.html#a792f9d4615b444fce1b56b3c7b6e8052a53a3f6b1183de5cf3cf9c9d564b164bc">OTZC_PARAM_OUT</a>;</div>
<div class="line">                }</div>
<div class="line">                <span class="keywordflow">else</span> <span class="keywordflow">if</span>(inout == 2) {</div>
<div class="line">                    enc.flags = <a class="code" href="otz__api_8h.html#a0726f9cc52e17d8e6cd7dd085cc62527a7aa74f7037354b0cd675442b600060c0">OTZ_MEM_SERVICE_RO</a>;</div>
<div class="line">                    enc.param_type = <a class="code" href="otz__common_8h.html#a792f9d4615b444fce1b56b3c7b6e8052af60016bf7987a1ce074d83f028f07614">OTZC_PARAM_IN</a>; </div>
<div class="line">                }</div>
<div class="line"></div>
<div class="line">                enc.data = </div>
<div class="line">                    operation-&gt;<a class="code" href="structTEEC__Operation.html#a7c40ba20ef6ab4bcbd5a75e2c577e011">params</a>[param_count].<a class="code" href="unionTEEC__Parameter.html#abb1df8a9d3c54299a3de780e49f2fe92">tmpref</a>.<a class="code" href="structTEEC__TempMemoryReference.html#a814ab10dfaa7eca1fe81f572342ae325">buffer</a>;</div>
<div class="line">                ret = ioctl(session-&gt;<a class="code" href="structTEEC__Session.html#ab72c9ecca6e5cb3d7b10ff75754549bb">device</a>-&gt;<a class="code" href="structTEEC__Context.html#a33f0bc3b43f53a2daf1dbafc82e3a804">fd</a>, </div>
<div class="line">                            <a class="code" href="otz__client_8h.html#a5191da7defc442a4fd60f2db6127313a">OTZ_CLIENT_IOCTL_ENC_ARRAY</a>, &amp;enc);</div>
<div class="line"></div>
<div class="line">                <span class="keywordflow">if</span> (ret){</div>
<div class="line">                    <span class="keywordflow">if</span>(returnOrigin)</div>
<div class="line">                        *returnOrigin = <a class="code" href="otz__tee__client__api_8h.html#a7cec7a0d1fa340adc3d3186b6eeb63fca8f66dc5e481382d361fd654fb9e42ed1">TEEC_ORIGIN_API</a>;</div>
<div class="line">                    session-&gt;<a class="code" href="structTEEC__Session.html#ad23a0825971ef9d621f36eb05035c7da">s_errno</a> = <a class="code" href="sw__filelib_8h.html#ad65a8842cc674e3ddf69355898c0ecbf">errno</a>;</div>
<div class="line">                    perror(<span class="stringliteral">&quot;TEEC_InvokeCommand: \</span></div>
<div class="line"><span class="stringliteral">encoding data in client driver failed\n&quot;</span>);</div>
<div class="line">                    <span class="keywordflow">break</span>;</div>
<div class="line">                }</div>
<div class="line"></div>
<div class="line">                <span class="keywordflow">if</span>(inout == 2) {</div>
<div class="line">                    enc.flags = <a class="code" href="otz__api_8h.html#a0726f9cc52e17d8e6cd7dd085cc62527a8035deccf29fcd9fe345e3f3e0e4accb">OTZ_MEM_SERVICE_WO</a>;</div>
<div class="line">                    enc.param_type = <a class="code" href="otz__common_8h.html#a792f9d4615b444fce1b56b3c7b6e8052a53a3f6b1183de5cf3cf9c9d564b164bc">OTZC_PARAM_OUT</a>; </div>
<div class="line"></div>
<div class="line">                    ret = ioctl(session-&gt;<a class="code" href="structTEEC__Session.html#ab72c9ecca6e5cb3d7b10ff75754549bb">device</a>-&gt;<a class="code" href="structTEEC__Context.html#a33f0bc3b43f53a2daf1dbafc82e3a804">fd</a>, </div>
<div class="line">                                <a class="code" href="otz__client_8h.html#a5191da7defc442a4fd60f2db6127313a">OTZ_CLIENT_IOCTL_ENC_ARRAY</a>, &amp;enc);</div>
<div class="line">                    <span class="keywordflow">if</span> (ret){</div>
<div class="line">                        <span class="keywordflow">if</span>(returnOrigin)</div>
<div class="line">                            *returnOrigin = <a class="code" href="otz__tee__client__api_8h.html#a7cec7a0d1fa340adc3d3186b6eeb63fca8f66dc5e481382d361fd654fb9e42ed1">TEEC_ORIGIN_API</a>;</div>
<div class="line">                        session-&gt;<a class="code" href="structTEEC__Session.html#ad23a0825971ef9d621f36eb05035c7da">s_errno</a> = <a class="code" href="sw__filelib_8h.html#ad65a8842cc674e3ddf69355898c0ecbf">errno</a>;</div>
<div class="line">                    perror(<span class="stringliteral">&quot;TEEC_InvokeCommand: \</span></div>
<div class="line"><span class="stringliteral">encoding data in client driver failed\n&quot;</span>);</div>
<div class="line">                        <span class="keywordflow">break</span>;</div>
<div class="line">                    }</div>
<div class="line">                }</div>
<div class="line">            } <span class="comment">/* end if for temp reference */</span></div>
<div class="line">        }<span class="comment">/* end for */</span></div>
<div class="line">    } <span class="comment">/* end paramtype */</span></div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">if</span>(ret) {</div>
<div class="line">        printf(<span class="stringliteral">&quot;error in encoding the data\n&quot;</span>);</div>
<div class="line">        <span class="keywordflow">goto</span> operation_release;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <span class="comment">/* Invoke the command */</span></div>
<div class="line">    ret = ioctl(session-&gt;<a class="code" href="structTEEC__Session.html#ab72c9ecca6e5cb3d7b10ff75754549bb">device</a>-&gt;<a class="code" href="structTEEC__Context.html#a33f0bc3b43f53a2daf1dbafc82e3a804">fd</a>,</div>
<div class="line">                    <a class="code" href="otz__client_8h.html#a74d70f914f878eeceecf69ee64912a9b">OTZ_CLIENT_IOCTL_SEND_CMD_REQ</a>, &amp;enc);</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">if</span>(ret &lt; 0){</div>
<div class="line">        <span class="keywordflow">if</span>(returnOrigin)</div>
<div class="line">            *returnOrigin = <a class="code" href="otz__tee__client__api_8h.html#a7cec7a0d1fa340adc3d3186b6eeb63fca8f66dc5e481382d361fd654fb9e42ed1">TEEC_ORIGIN_API</a>;</div>
<div class="line"></div>
<div class="line">        session-&gt;<a class="code" href="structTEEC__Session.html#ad23a0825971ef9d621f36eb05035c7da">s_errno</a> = <a class="code" href="sw__filelib_8h.html#ad65a8842cc674e3ddf69355898c0ecbf">errno</a>;</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span>(ret == -EFAULT)</div>
<div class="line">         ret = <a class="code" href="otz__tee__api_8h.html#a586a43c1886aa09dc9541fb66e6d8d7fad409d8880e3ce9fc7f4828a87257d955">TEEC_ERROR_ACCESS_DENIED</a>;</div>
<div class="line">        <span class="keywordflow">if</span>(ret == -EINVAL)</div>
<div class="line">         ret = <a class="code" href="otz__tee__api_8h.html#a586a43c1886aa09dc9541fb66e6d8d7fa4b7583ef234ccb0ef6f7492ee6e8200d">TEEC_ERROR_BAD_PARAMETERS</a>;</div>
<div class="line"></div>
<div class="line">        perror(<span class="stringliteral">&quot;TEEC_InvokeCommand: \</span></div>
<div class="line"><span class="stringliteral">command submission in client driver failed\n&quot;</span>);</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">else</span> <span class="keywordflow">if</span>(ret &gt; 0) {</div>
<div class="line">        <span class="keywordflow">if</span>(returnOrigin)</div>
<div class="line">            *returnOrigin = <a class="code" href="otz__tee__client__api_8h.html#a7cec7a0d1fa340adc3d3186b6eeb63fcac1e440c31589196e83b79353fcf5ebce">TEEC_ORIGIN_TRUSTED_APP</a>;</div>
<div class="line"></div>
<div class="line">        <span class="comment">/* check the service error code match with global platform </span></div>
<div class="line"><span class="comment">            error constants */</span></div>
<div class="line">        printf(<span class="stringliteral">&quot;TEEC_InvokeCommand: \</span></div>
<div class="line"><span class="stringliteral">command submission failed in trusted application - %s\n&quot;</span>, </div>
<div class="line">        <a class="code" href="otz__tee__client__api_8h.html#a015f78683598134139320994260db34c" title="Returns error string.">TEEC_GetError</a>(ret, <a class="code" href="otz__tee__client__api_8h.html#a7cec7a0d1fa340adc3d3186b6eeb63fcac1e440c31589196e83b79353fcf5ebce">TEEC_ORIGIN_TRUSTED_APP</a>));</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">if</span>(ret != 0) {</div>
<div class="line">        <span class="keywordflow">goto</span> operation_release;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line"></div>
<div class="line"><span class="comment">/* Decode the data */</span> </div>
<div class="line">    <span class="keywordflow">if</span>(operation-&gt;<a class="code" href="structTEEC__Operation.html#afd2f1c406a61de0f0595824295bcb050">paramTypes</a> != 0) {</div>
<div class="line">        <span class="keywordflow">for</span>(param_count = 0; param_count &lt; 4; param_count++) {</div>
<div class="line"></div>
<div class="line">            <span class="keywordflow">if</span>((param_types[param_count] == <a class="code" href="otz__tee__client__api_8h.html#a844239ef6fbb152b5e83b296be117fa9a0d3155a759f5f3ea299be0a493ee4924">TEEC_VALUE_INOUT</a>) ||</div>
<div class="line">                (param_types[param_count] == <a class="code" href="otz__tee__client__api_8h.html#a844239ef6fbb152b5e83b296be117fa9ad8e807bd3166fb18b91917a42426323b">TEEC_VALUE_OUTPUT</a>)) {</div>
<div class="line">                enc.len  = <span class="keyword">sizeof</span>(<a class="code" href="otz__api_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a>);</div>
<div class="line"></div>
<div class="line">                ret = ioctl(session-&gt;<a class="code" href="structTEEC__Session.html#ab72c9ecca6e5cb3d7b10ff75754549bb">device</a>-&gt;<a class="code" href="structTEEC__Context.html#a33f0bc3b43f53a2daf1dbafc82e3a804">fd</a>, </div>
<div class="line">                            <a class="code" href="otz__client_8h.html#a3a906c6822ed16423cf394d12c4eee26">OTZ_CLIENT_IOCTL_DEC_UINT32</a>, &amp;enc);</div>
<div class="line">                <span class="keywordflow">if</span> (ret) {</div>
<div class="line">                    <span class="keywordflow">if</span>(returnOrigin)</div>
<div class="line">                        *returnOrigin = <a class="code" href="otz__tee__client__api_8h.html#a7cec7a0d1fa340adc3d3186b6eeb63fca8f66dc5e481382d361fd654fb9e42ed1">TEEC_ORIGIN_API</a>;</div>
<div class="line">                    session-&gt;<a class="code" href="structTEEC__Session.html#ad23a0825971ef9d621f36eb05035c7da">s_errno</a> = <a class="code" href="sw__filelib_8h.html#ad65a8842cc674e3ddf69355898c0ecbf">errno</a>;</div>
<div class="line">                    perror(<span class="stringliteral">&quot;TEEC_InvokeCommand: \</span></div>
<div class="line"><span class="stringliteral">decoding data in client driver failed\n&quot;</span>);</div>
<div class="line">                    <span class="keywordflow">break</span>;</div>
<div class="line">                }</div>
<div class="line"></div>
<div class="line">                operation-&gt;<a class="code" href="structTEEC__Operation.html#a7c40ba20ef6ab4bcbd5a75e2c577e011">params</a>[param_count].<a class="code" href="unionTEEC__Parameter.html#a819a08a56fe8d2cbbeb4a4409d60c975">value</a>.<a class="code" href="structTEEC__Value.html#a9092e5e087843ebfc5d7cfa40f04a1c2">a</a> = *((<a class="code" href="otz__api_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a>*)enc.data);</div>
<div class="line"></div>
<div class="line">                <span class="keywordflow">if</span>(<a class="code" href="otz__tee__client__api_8h.html#a8cee8c3207cf162f74fe0e6832640a72">TEEC_VALUE_UNDEF</a> != operation-&gt;<a class="code" href="structTEEC__Operation.html#a7c40ba20ef6ab4bcbd5a75e2c577e011">params</a>[param_count].<a class="code" href="unionTEEC__Parameter.html#a819a08a56fe8d2cbbeb4a4409d60c975">value</a>.<a class="code" href="structTEEC__Value.html#ad6cef620e07a83dabbc6220020ee47b5">b</a>) {</div>
<div class="line">                    enc.len  = <span class="keyword">sizeof</span>(<a class="code" href="otz__api_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a>);</div>
<div class="line">                    ret = ioctl(session-&gt;<a class="code" href="structTEEC__Session.html#ab72c9ecca6e5cb3d7b10ff75754549bb">device</a>-&gt;<a class="code" href="structTEEC__Context.html#a33f0bc3b43f53a2daf1dbafc82e3a804">fd</a>, </div>
<div class="line">                                <a class="code" href="otz__client_8h.html#a3a906c6822ed16423cf394d12c4eee26">OTZ_CLIENT_IOCTL_DEC_UINT32</a>, &amp;enc);</div>
<div class="line">                    <span class="keywordflow">if</span> (ret) {</div>
<div class="line">                        <span class="keywordflow">if</span>(returnOrigin)</div>
<div class="line">                            *returnOrigin = <a class="code" href="otz__tee__client__api_8h.html#a7cec7a0d1fa340adc3d3186b6eeb63fca8f66dc5e481382d361fd654fb9e42ed1">TEEC_ORIGIN_API</a>;</div>
<div class="line">                        session-&gt;<a class="code" href="structTEEC__Session.html#ad23a0825971ef9d621f36eb05035c7da">s_errno</a> = <a class="code" href="sw__filelib_8h.html#ad65a8842cc674e3ddf69355898c0ecbf">errno</a>;</div>
<div class="line">                    perror(<span class="stringliteral">&quot;TEEC_InvokeCommand: \</span></div>
<div class="line"><span class="stringliteral">decoding data in client driver failed\n&quot;</span>);</div>
<div class="line">                        <span class="keywordflow">break</span>;</div>
<div class="line">                    }</div>
<div class="line">                    operation-&gt;<a class="code" href="structTEEC__Operation.html#a7c40ba20ef6ab4bcbd5a75e2c577e011">params</a>[param_count].<a class="code" href="unionTEEC__Parameter.html#a819a08a56fe8d2cbbeb4a4409d60c975">value</a>.<a class="code" href="structTEEC__Value.html#ad6cef620e07a83dabbc6220020ee47b5">b</a> = </div>
<div class="line">                                                *((<a class="code" href="otz__api_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a>*)enc.data);</div>
<div class="line">                }</div>
<div class="line">            } <span class="comment">/* end if for TEEC_VALUE check */</span></div>
<div class="line">            <span class="keywordflow">else</span> <span class="keywordflow">if</span>( (param_types[param_count] == <a class="code" href="otz__tee__client__api_8h.html#a844239ef6fbb152b5e83b296be117fa9a0fde2e095c933376a0360788e2dd7f90">TEEC_MEMREF_WHOLE</a>) ||</div>
<div class="line">                (param_types[param_count] == <a class="code" href="otz__tee__client__api_8h.html#a844239ef6fbb152b5e83b296be117fa9a530eefe7668b93a6e6a5e02d70233cd3">TEEC_MEMREF_PARTIAL_INOUT</a>) ||</div>
<div class="line">                (param_types[param_count] == <a class="code" href="otz__tee__client__api_8h.html#a844239ef6fbb152b5e83b296be117fa9a3b0c66b1008718e5108fe84da60fafe0">TEEC_MEMREF_PARTIAL_OUTPUT</a>) ||</div>
<div class="line">                (param_types[param_count] == <a class="code" href="otz__tee__client__api_8h.html#a844239ef6fbb152b5e83b296be117fa9a61b21cbecaf1827ddca58f49b2176748">TEEC_MEMREF_TEMP_INOUT</a>) ||</div>
<div class="line">                (param_types[param_count] == <a class="code" href="otz__tee__client__api_8h.html#a844239ef6fbb152b5e83b296be117fa9a40a27415d0c255d58f1fad5287879785">TEEC_MEMREF_TEMP_OUTPUT</a>)) {</div>
<div class="line"></div>
<div class="line">                inout = 2;</div>
<div class="line"></div>
<div class="line">                <span class="keywordflow">if</span>(param_types[param_count] == <a class="code" href="otz__tee__client__api_8h.html#a844239ef6fbb152b5e83b296be117fa9a0fde2e095c933376a0360788e2dd7f90">TEEC_MEMREF_WHOLE</a>) {   </div>
<div class="line">                    <span class="keywordflow">if</span>(operation-&gt;</div>
<div class="line">                            params[param_count].memref.parent-&gt;flags == </div>
<div class="line">                            (TEEC_MEM_INPUT | TEEC_MEM_OUTPUT))</div>
<div class="line">                        inout = 2;</div>
<div class="line">                    <span class="keywordflow">else</span> <span class="keywordflow">if</span>(operation</div>
<div class="line">                            -&gt;params[param_count].memref.parent-&gt;flags == </div>
<div class="line">                            TEEC_MEM_INPUT)</div>
<div class="line">                        inout = 0;</div>
<div class="line">                    <span class="keywordflow">else</span> <span class="keywordflow">if</span>(operation</div>
<div class="line">                            -&gt;params[param_count].memref.parent-&gt;flags == </div>
<div class="line">                            TEEC_MEM_OUTPUT)</div>
<div class="line">                        inout = 1;</div>
<div class="line">                }</div>
<div class="line"></div>
<div class="line">                <span class="keywordflow">if</span>(inout == 0)</div>
<div class="line">                    <span class="keywordflow">continue</span>;</div>
<div class="line"></div>
<div class="line">                ret = ioctl(session-&gt;<a class="code" href="structTEEC__Session.html#ab72c9ecca6e5cb3d7b10ff75754549bb">device</a>-&gt;<a class="code" href="structTEEC__Context.html#a33f0bc3b43f53a2daf1dbafc82e3a804">fd</a>, </div>
<div class="line">                            <a class="code" href="otz__client_8h.html#a85758d78a3f7a7d60fd05b5561ca7e66">OTZ_CLIENT_IOCTL_DEC_ARRAY_SPACE</a>, &amp;enc);</div>
<div class="line">                <span class="keywordflow">if</span> (ret){</div>
<div class="line">                    <span class="keywordflow">if</span>(returnOrigin)</div>
<div class="line">                        *returnOrigin = <a class="code" href="otz__tee__client__api_8h.html#a7cec7a0d1fa340adc3d3186b6eeb63fca8f66dc5e481382d361fd654fb9e42ed1">TEEC_ORIGIN_API</a>;</div>
<div class="line">                    session-&gt;<a class="code" href="structTEEC__Session.html#ad23a0825971ef9d621f36eb05035c7da">s_errno</a> = <a class="code" href="sw__filelib_8h.html#ad65a8842cc674e3ddf69355898c0ecbf">errno</a>;</div>
<div class="line">                    perror(<span class="stringliteral">&quot;TEEC_InvokeCommand: \</span></div>
<div class="line"><span class="stringliteral">decoding data in client driver failed\n&quot;</span>);</div>
<div class="line">                    <span class="keywordflow">break</span>;</div>
<div class="line">                }</div>
<div class="line"></div>
<div class="line">                <span class="keywordflow">if</span>( (param_types[param_count] == <a class="code" href="otz__tee__client__api_8h.html#a844239ef6fbb152b5e83b296be117fa9a0fde2e095c933376a0360788e2dd7f90">TEEC_MEMREF_WHOLE</a>) ||</div>
<div class="line">                    (param_types[param_count] == <a class="code" href="otz__tee__client__api_8h.html#a844239ef6fbb152b5e83b296be117fa9a530eefe7668b93a6e6a5e02d70233cd3">TEEC_MEMREF_PARTIAL_INOUT</a>) ||</div>
<div class="line">                    (param_types[param_count] == <a class="code" href="otz__tee__client__api_8h.html#a844239ef6fbb152b5e83b296be117fa9a3b0c66b1008718e5108fe84da60fafe0">TEEC_MEMREF_PARTIAL_OUTPUT</a>)) {</div>
<div class="line">                    operation-&gt;<a class="code" href="structTEEC__Operation.html#a7c40ba20ef6ab4bcbd5a75e2c577e011">params</a>[param_count].<a class="code" href="unionTEEC__Parameter.html#a341d29a495da6914bb99b0af853c4fd1">memref</a>.<a class="code" href="structTEEC__RegisteredMemoryReference.html#a2d86e5093bb7930fcc70730ad73ab103">size</a> = enc.len;</div>
<div class="line">                }</div>
<div class="line">                <span class="keywordflow">else</span> {</div>
<div class="line">                    operation-&gt;<a class="code" href="structTEEC__Operation.html#a7c40ba20ef6ab4bcbd5a75e2c577e011">params</a>[param_count].<a class="code" href="unionTEEC__Parameter.html#abb1df8a9d3c54299a3de780e49f2fe92">tmpref</a>.<a class="code" href="structTEEC__TempMemoryReference.html#ae6076f1360d7b8bbdf79e7b22f45fc29">size</a> = enc.len;</div>
<div class="line">                }</div>
<div class="line">            } <span class="comment">/* end if for TEEC_MEM_REF check */</span></div>
<div class="line">        }<span class="comment">/* end for */</span></div>
<div class="line">    } <span class="comment">/* end paramtype */</span></div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">if</span>(ret != <a class="code" href="otz__tee__api_8h.html#a586a43c1886aa09dc9541fb66e6d8d7fa4d19c2c024e37edc5f04892bb6739dbe">TEEC_SUCCESS</a>) {</div>
<div class="line">        printf(<span class="stringliteral">&quot;error in decoding the data\n&quot;</span>);</div>
<div class="line">    }</div>
<div class="line">operation_release:</div>
<div class="line">    <span class="comment">/* release the operation */</span></div>
<div class="line">    rel_ret = ioctl(session-&gt;<a class="code" href="structTEEC__Session.html#ab72c9ecca6e5cb3d7b10ff75754549bb">device</a>-&gt;<a class="code" href="structTEEC__Context.html#a33f0bc3b43f53a2daf1dbafc82e3a804">fd</a>, </div>
<div class="line">                    <a class="code" href="otz__client_8h.html#a96a3275839a04f4d4380cfab6b977ea2">OTZ_CLIENT_IOCTL_OPERATION_RELEASE</a>, &amp;enc);</div>
<div class="line">    <span class="keywordflow">if</span> (rel_ret){</div>
<div class="line">        perror(<span class="stringliteral">&quot;Operation release failed\n&quot;</span>);</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    session-&gt;<a class="code" href="structTEEC__Session.html#ae21202e1d124456453722861aee399aa">operation_cnt</a>--;</div>
<div class="line">    <span class="keywordflow">return</span> ret;</div>
<div class="line">}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a2e057c67c5ec43b8052ad89809929e61"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="otz__tee__api_8h.html#a586a43c1886aa09dc9541fb66e6d8d7f">TEEC_Result</a> TEEC_OpenSession </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structTEEC__Context.html">TEEC_Context</a> *&#160;</td>
          <td class="paramname"><em>context</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structTEEC__Session.html">TEEC_Session</a> *&#160;</td>
          <td class="paramname"><em>session</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="otz__tee__client__api_8h.html#a361ded2dff83f4a00e85cdc7c8a04274">TEEC_UUID</a> *&#160;</td>
          <td class="paramname"><em>destination</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="otz__api_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a>&#160;</td>
          <td class="paramname"><em>connectionMethod</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const void *&#160;</td>
          <td class="paramname"><em>connectionData</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structTEEC__Operation.html">TEEC_Operation</a> *&#160;</td>
          <td class="paramname"><em>operation</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="otz__api_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> *&#160;</td>
          <td class="paramname"><em>returnOrigin</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Opens a new session between client and trusted application. </p>
<p>This function opens a new Session between the Client Application and the specified Trusted Application.</p>
<p>The Implementation MUST assume that all fields of this <em>session</em> structure are in an <em>undefined</em> state. When this function returns <em>TEEC_SUCCESS</em> the Implementation MUST have populated this structure with any information necessary for subsequent operations within the Session.</p>
<p>The target Trusted Application is identified by a UUID passed in the parameter destination.</p>
<p>The Session MAY be opened using a specific connection method that can carry additional connection data, such as data about the user or user-group running the Client Application, or about the Client Application itself. This allows the Trusted Application to implement access control methods which separate functionality or data accesses for different actors in the rich environment outside of the TEE. The additional data associated with each connection method is passed in via the pointer <em>connectionData</em>. For the core login types the following connection data is required:</p>
<p><em>TEEC_LOGIN_PUBLIC</em> - <em>connectionData</em> SHOULD be <em>NULL</em>.<br/>
 <em>TEEC_LOGIN_USER</em> - <em>connectionData</em> SHOULD be <em>NULL</em>.<br/>
 <em>TEEC_LOGIN_GROUP</em> - <em>connectionData</em> MUST point to a uint32_t which contains the group which this Client Application wants to connect as. The Implementation is responsible for securely ensuring that the Client Application instance is actually a member of this group.<br/>
 <em>TEEC_LOGIN_APPLICATION</em> - <em>connectionData</em> SHOULD be <em>NULL</em>.<br/>
 <em>TEEC_LOGIN_USER_APPLICATION</em> - <em>connectionData</em> SHOULD be <em>NULL</em>.<br/>
 <em>TEEC_LOGIN_GROUP_APPLICATION</em> - <em>connectionData</em> MUST point to a uint32_t which contains the group which this Client Application wants to connect as. The Implementation is responsible for securely ensuring that the Client Application instance is actually a member of this group.<br/>
</p>
<p>An open-session operation MAY optionally carry an Operation Payload, and MAY also be cancellable. When the payload is present the parameter <em>operation</em> MUST point to a <em><a class="el" href="structTEEC__Operation.html" title="The TEEC_Operation structure is used to contain control information related to an operation that is t...">TEEC_Operation</a></em> structure populated by the Client Application. If <em>operation</em> is NULL then no data buffers are exchanged with the Trusted Application, and the operation cannot be cancelled by the Client Application.</p>
<p>The result of this function is returned both in the function <em>TEEC_Result</em> return code and the return origin, stored in the variable pointed to by <em>returnOrigin:</em> <br/>
 If the return origin is different from <em>TEEC_ORIGIN_TRUSTED_APP</em>, then the return code MUST be one of the defined error codes . If the return code is <em>TEEC_ERROR_CANCEL</em> then it means that the operation was cancelled before it reached the Trusted Application.<br/>
 If the return origin is <em>TEEC_ORIGIN_TRUSTED_APP</em>, the meaning of the return code depends on the protocol between the Client Application and the Trusted Application. However, if <em>TEEC_SUCCESS</em> is returned, it always means that the session was successfully opened and if the function returns a code different from <em>TEEC_SUCCESS</em>, it means that the session opening failed.</p>
<p><b>Programmer</b> <b>Error</b> <br/>
 The following usage of the API is a programmer error:<br/>
 Calling with a <em>context</em> which is not yet initialized. <br/>
 Calling with a connectionData set to NULL if connection data is required by the specified connection method. <br/>
 Calling with an operation containing an invalid paramTypes field, i.e., containing a reserved parameter type or where a parameter type that conflicts with the parent Shared Memory. <br/>
 Encoding Registered Memory References which refer to Shared Memory blocks allocated within the scope of a different TEE Context. <br/>
 Attempting to open a Session using the same Session structure concurrently from multiple threads. Multi-threaded Client Applications must use platform-provided locking mechanisms, to ensure that this case does not occur.<br/>
 Using the same Operation structure for multiple concurrent operations. <br/>
</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">context,:</td><td>A pointer to an initialized TEE Context. </td></tr>
    <tr><td class="paramname">session,:</td><td>A pointer to a Session structure to open. </td></tr>
    <tr><td class="paramname">destination,:</td><td>A pointer to a structure containing the UUID of the destination Trusted Application </td></tr>
    <tr><td class="paramname">connectionMethod,:</td><td>The method of connection to use </td></tr>
    <tr><td class="paramname">connectionData,:</td><td>Any necessary data required to support the connection method chosen. </td></tr>
    <tr><td class="paramname">operation,:</td><td>A pointer to an Operation containing a set of Parameters to exchange with the Trusted Application, or <em>NULL</em> if no Parameters are to be exchanged or if the operation cannot be cancelled </td></tr>
    <tr><td class="paramname">returnOrigin,:</td><td>A pointer to a variable which will contain the return origin. This field may be <em>NULL</em> if the return origin is not needed.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>TEEC_Result: TEEC_SUCCESS: The session was successfully opened. <br/>
 TEEC_ERROR_*: An implementation-defined error code for any other error.</dd></dl>
<p>Opens a new session between client and trusted application.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">context,:</td><td>Pointer to the context </td></tr>
    <tr><td class="paramname">session,:</td><td>Pointer to the session </td></tr>
    <tr><td class="paramname">destination,:</td><td>Service UUID </td></tr>
    <tr><td class="paramname">connectionMethod,:</td><td>Connection method </td></tr>
    <tr><td class="paramname">connectionData,:</td><td>Connection data used for authentication </td></tr>
    <tr><td class="paramname">operation,:</td><td>Pointer to optional operation structure </td></tr>
    <tr><td class="paramname">returnOrigin,:</td><td>Pointer to the return origin</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>TEEC_Result: TEEC_SUCCESS: The session was successfully opened. <br/>
 TEEC_ERROR_*: An implementation-defined error code for any other error. </dd></dl>

<p>Definition at line <a class="el" href="otz__tee__api_8c_source.html#l00348">348</a> of file <a class="el" href="otz__tee__api_8c_source.html">otz_tee_api.c</a>.</p>
<div class="fragment"><div class="line">{</div>
<div class="line">    <span class="keywordtype">int</span> ret;</div>
<div class="line">    <span class="keyword">struct </span><a class="code" href="structser__ses__id.html" title="Session details structure.">ser_ses_id</a> ses_open;</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">if</span>((context == <a class="code" href="sw__types_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) || (session == <a class="code" href="sw__types_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) ||</div>
<div class="line">        (destination == <a class="code" href="sw__types_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)) {</div>
<div class="line">        printf(<span class="stringliteral">&quot;TEEC_OpenSession : Error Illegal argument\n&quot;</span>);</div>
<div class="line">        <span class="keywordflow">return</span> <a class="code" href="otz__tee__api_8h.html#a586a43c1886aa09dc9541fb66e6d8d7fa4b7583ef234ccb0ef6f7492ee6e8200d">TEEC_ERROR_BAD_PARAMETERS</a>;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">switch</span>(connectionMethod) {</div>
<div class="line">        <span class="keywordflow">case</span> <a class="code" href="otz__tee__client__api_8h.html#acea56784d3146198a50dca0fb5b2a7cda8bb5b8a7dfc0334f90ed7407dd4ddd9d">TEEC_LOGIN_PUBLIC</a>: {</div>
<div class="line">            <span class="keywordflow">if</span>(connectionData != <a class="code" href="sw__types_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) {</div>
<div class="line">                printf(<span class="stringliteral">&quot;TEEC_OpenSession : connection method requires \</span></div>
<div class="line"><span class="stringliteral">empty connection data\n&quot;</span>);</div>
<div class="line">                <span class="keywordflow">return</span> <a class="code" href="otz__tee__api_8h.html#a586a43c1886aa09dc9541fb66e6d8d7fa4b7583ef234ccb0ef6f7492ee6e8200d">TEEC_ERROR_BAD_PARAMETERS</a>;            </div>
<div class="line">            }</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">case</span> <a class="code" href="otz__tee__client__api_8h.html#acea56784d3146198a50dca0fb5b2a7cda8c6ad7380cec6f7fa09c852247f4abed">TEEC_LOGIN_USER</a>:</div>
<div class="line">        <span class="keywordflow">case</span> <a class="code" href="otz__tee__client__api_8h.html#acea56784d3146198a50dca0fb5b2a7cda3cc79d313bb7bcb1aa9d52614682d08a">TEEC_LOGIN_APPLICATION</a>:</div>
<div class="line">        <span class="keywordflow">case</span> <a class="code" href="otz__tee__client__api_8h.html#acea56784d3146198a50dca0fb5b2a7cda646983f0da4bbdd6f96d64681dd31e73">TEEC_LOGIN_USER_APPLICATION</a>: {</div>
<div class="line">            <span class="keywordflow">if</span>(connectionData != <a class="code" href="sw__types_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) {</div>
<div class="line">                printf(<span class="stringliteral">&quot;TEEC_OpenSession : connection method requires \</span></div>
<div class="line"><span class="stringliteral">empty connection data\n&quot;</span>);</div>
<div class="line">                <span class="keywordflow">return</span> <a class="code" href="otz__tee__api_8h.html#a586a43c1886aa09dc9541fb66e6d8d7fa4b7583ef234ccb0ef6f7492ee6e8200d">TEEC_ERROR_BAD_PARAMETERS</a>;            </div>
<div class="line">            }</div>
<div class="line">            printf(<span class="stringliteral">&quot;TEEC_OpenSession : connection method \</span></div>
<div class="line"><span class="stringliteral">is not implemented \n&quot;</span>);</div>
<div class="line">            <span class="keywordflow">return</span> <a class="code" href="otz__tee__api_8h.html#a586a43c1886aa09dc9541fb66e6d8d7fa4179635876af36d07712ab79da64afa7">TEEC_ERROR_NOT_IMPLEMENTED</a>;</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">case</span> <a class="code" href="otz__tee__client__api_8h.html#acea56784d3146198a50dca0fb5b2a7cdac1e52a37c3e8e6829c5e0c232756cc76">TEEC_LOGIN_GROUP</a>:</div>
<div class="line">        <span class="keywordflow">case</span> <a class="code" href="otz__tee__client__api_8h.html#acea56784d3146198a50dca0fb5b2a7cda53642939ec71bb330122acdabff4bc22">TEEC_LOGIN_GROUP_APPLICATION</a>: {</div>
<div class="line">            <span class="keywordflow">if</span>(connectionData == <a class="code" href="sw__types_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) {</div>
<div class="line">                printf(<span class="stringliteral">&quot;TEEC_OpenSession : connection method requires \</span></div>
<div class="line"><span class="stringliteral">valid connection data\n&quot;</span>);</div>
<div class="line">                <span class="keywordflow">return</span> <a class="code" href="otz__tee__api_8h.html#a586a43c1886aa09dc9541fb66e6d8d7fa4b7583ef234ccb0ef6f7492ee6e8200d">TEEC_ERROR_BAD_PARAMETERS</a>;            </div>
<div class="line">            }</div>
<div class="line">            <span class="keywordflow">return</span> <a class="code" href="otz__tee__api_8h.html#a586a43c1886aa09dc9541fb66e6d8d7fa4179635876af36d07712ab79da64afa7">TEEC_ERROR_NOT_IMPLEMENTED</a>;</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    ses_open.service_id = *destination;</div>
<div class="line"></div>
<div class="line">    ret = ioctl(context-&gt;<a class="code" href="structTEEC__Context.html#a33f0bc3b43f53a2daf1dbafc82e3a804">fd</a>,</div>
<div class="line">                <a class="code" href="otz__client_8h.html#a44cde702959998cc55975d32b57f5556">OTZ_CLIENT_IOCTL_SES_OPEN_REQ</a>, &amp;ses_open);    </div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">if</span>(ret &lt; 0){</div>
<div class="line">        <span class="keywordflow">if</span>(returnOrigin)</div>
<div class="line">            *returnOrigin = <a class="code" href="otz__tee__client__api_8h.html#a7cec7a0d1fa340adc3d3186b6eeb63fca8f66dc5e481382d361fd654fb9e42ed1">TEEC_ORIGIN_API</a>;</div>
<div class="line"></div>
<div class="line">        context-&gt;<a class="code" href="structTEEC__Context.html#a33bf223f26ee1b208b0cdc5ead6a7bcf">s_errno</a> = <a class="code" href="sw__filelib_8h.html#ad65a8842cc674e3ddf69355898c0ecbf">errno</a>;</div>
<div class="line">        </div>
<div class="line">        perror(<span class="stringliteral">&quot;TEEC_OpenSession: Session client open request failed\n&quot;</span>);</div>
<div class="line">        <span class="keywordflow">if</span>(ret == -<a class="code" href="sw__filelib_8h.html#a6a05c923dad0c1208043e9c20a58c8e5">ENOMEM</a>)</div>
<div class="line">            <span class="keywordflow">return</span> <a class="code" href="otz__tee__api_8h.html#a586a43c1886aa09dc9541fb66e6d8d7fac4927fa5eae4d0446bb2aa422f0d244f">TEEC_ERROR_OUT_OF_MEMORY</a>;</div>
<div class="line">        <span class="keywordflow">if</span>(ret == -EFAULT)</div>
<div class="line">         <span class="keywordflow">return</span>  <a class="code" href="otz__tee__api_8h.html#a586a43c1886aa09dc9541fb66e6d8d7fad409d8880e3ce9fc7f4828a87257d955">TEEC_ERROR_ACCESS_DENIED</a>;</div>
<div class="line">        <span class="keywordflow">if</span>(ret == -EINVAL)</div>
<div class="line">         <span class="keywordflow">return</span>  <a class="code" href="otz__tee__api_8h.html#a586a43c1886aa09dc9541fb66e6d8d7fa4b7583ef234ccb0ef6f7492ee6e8200d">TEEC_ERROR_BAD_PARAMETERS</a>;</div>
<div class="line">        </div>
<div class="line">        <span class="keywordflow">return</span> <a class="code" href="otz__tee__api_8h.html#a586a43c1886aa09dc9541fb66e6d8d7fae90c214f5f14bdcd9cfa2fffd5baa877">TEEC_ERROR_GENERIC</a>;</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">else</span> <span class="keywordflow">if</span>(ret &gt; 0) {</div>
<div class="line">        <span class="keywordflow">if</span>(returnOrigin)</div>
<div class="line">            *returnOrigin = <a class="code" href="otz__tee__client__api_8h.html#a7cec7a0d1fa340adc3d3186b6eeb63fcac1e440c31589196e83b79353fcf5ebce">TEEC_ORIGIN_TRUSTED_APP</a>;</div>
<div class="line"></div>
<div class="line">        printf(<span class="stringliteral">&quot;TEEC_OpenSession: service return error -  %s\n&quot;</span>,</div>
<div class="line">            <a class="code" href="otz__tee__client__api_8h.html#a015f78683598134139320994260db34c" title="Returns error string.">TEEC_GetError</a>(ret, <a class="code" href="otz__tee__client__api_8h.html#a7cec7a0d1fa340adc3d3186b6eeb63fcac1e440c31589196e83b79353fcf5ebce">TEEC_ORIGIN_TRUSTED_APP</a>) );</div>
<div class="line">        <span class="keywordflow">return</span> ret;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    context-&gt;<a class="code" href="structTEEC__Context.html#aab72b42cacee05486d681a2c7aa34fcd">session_count</a>++;</div>
<div class="line">    session-&gt;<a class="code" href="structTEEC__Session.html#ae21202e1d124456453722861aee399aa">operation_cnt</a> = 0;</div>
<div class="line">    session-&gt;<a class="code" href="structTEEC__Session.html#a00ba158c15263804225042278230d3b1">session_id</a> = ses_open.session_id;</div>
<div class="line">    session-&gt;<a class="code" href="structTEEC__Session.html#aa2fc5ceee64cdc8d7f3e3b83c82c1be3">service_id</a> = *destination;</div>
<div class="line">    session-&gt;<a class="code" href="structTEEC__Session.html#ab72c9ecca6e5cb3d7b10ff75754549bb">device</a> = context;</div>
<div class="line">    </div>
<div class="line">    <span class="keywordflow">return</span> <a class="code" href="otz__tee__api_8h.html#a586a43c1886aa09dc9541fb66e6d8d7fa4d19c2c024e37edc5f04892bb6739dbe">TEEC_SUCCESS</a>;</div>
<div class="line">}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ae95c1a0a68654f50a280d94581859d76"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="otz__tee__api_8h.html#a586a43c1886aa09dc9541fb66e6d8d7f">TEEC_Result</a> TEEC_RegisterSharedMemory </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structTEEC__Context.html">TEEC_Context</a> *&#160;</td>
          <td class="paramname"><em>context</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structTEEC__SharedMemory.html">TEEC_SharedMemory</a> *&#160;</td>
          <td class="paramname"><em>sharedMem</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Register a allocated shared memory block. </p>
<p>This function registers a block of existing Client Application memory as a block of Shared Memory within the scope of the specified TEE Context, in accordance with the parameters which have been set by the Client Application inside the <em>sharedMem</em> structure.</p>
<p>The parameter <em>context</em> MUST point to an initialized TEE Context.</p>
<p>The parameter <em>sharedMem</em> MUST point to the Shared Memory structure defining the memory region to register. The Client Application MUST have populated the following fields of the Shared Memory structure before calling this function: <br/>
 The <em>buffer</em> field MUST point to the memory region to be shared, and MUST not be NULL.<br/>
 The <em>size</em> field MUST contain the size of the buffer, in bytes. Zero is a valid length for a buffer. <br/>
 The <em>flags</em> field indicates the intended directions of data flow between the Client Application and the TEE. <br/>
 The Implementation MUST assume that all other fields in the Shared Memory structure have undefined content.</p>
<p>An Implementation MAY put a hard limit on the size of a single Shared Memory block, defined by the constant TEEC_CONFIG_SHAREDMEM_MAX_SIZE. However note that this function may fail to register a block smaller than this limit due to a low resource condition encountered at run-time.</p>
<p><b>Programmer</b> <b>Error</b> <br/>
 The following usage of the API is a programmer error:<br/>
 Calling with a <em>context</em> which is not initialized.<br/>
 Calling with a <em>sharedMem</em> which has not be correctly populated in accordance with the specification.<br/>
 Attempting to initialize the same Shared Memory structure concurrently from multiple threads.Multi-threaded Client Applications must use platform-provided locking mechanisms to ensure that this case does not occur.</p>
<p><b>Implementor's</b> <b>Notes</b> <br/>
 This design allows a non-NULL buffer with a size of 0 bytes to allow trivial integration with any implementations of the C library malloc, in which is valid to allocate a zero byte buffer and receive a non- NULL pointer which may not be de-referenced in return. Once successfully registered, the Shared Memory block can be used for efficient data transfers between the Client Application and the Trusted Application. The TEE Client API implementation and the underlying communications infrastructure SHOULD attempt to transfer data in to the TEE without using copies, if this is possible on the underlying implementation, but MUST fall back on data copies if zero-copy cannot be achieved. Client Application developers should be aware that, if the Implementation requires data copies, then Shared Memory registration may allocate a block of memory of the same size as the block being registered.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">context,:</td><td>A pointer to an initialized TEE Context </td></tr>
    <tr><td class="paramname">sharedMem,:</td><td>A pointer to a Shared Memory structure to register: <br/>
 the <em>buffer</em>, <em>size</em>, and <em>flags</em> fields of the sharedMem structure MUST be set in accordance with the specification described above</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>TEEC_Result: TEEC_SUCCESS: The device was successfully opened. <br/>
 TEEC_ERROR_*: An implementation-defined error code for any other error.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">context,:</td><td>Pointer to the context </td></tr>
    <tr><td class="paramname">sharedMem,:</td><td>Pointer to the shared memory</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>TEEC_Result: TEEC_SUCCESS: The device was successfully opened. <br/>
 TEEC_ERROR_*: An implementation-defined error code for any other error. </dd></dl>

<p>Definition at line <a class="el" href="otz__tee__api_8c_source.html#l00258">258</a> of file <a class="el" href="otz__tee__api_8c_source.html">otz_tee_api.c</a>.</p>
<div class="fragment"><div class="line">{</div>
<div class="line">    <span class="keywordflow">if</span>(context == <a class="code" href="sw__types_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a> || sharedMem == <a class="code" href="sw__types_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a> ) {</div>
<div class="line">        printf(<span class="stringliteral">&quot;TEEC_AllocateSharedMemory : Error Illegal argument\n&quot;</span>);</div>
<div class="line">        <span class="keywordflow">return</span> <a class="code" href="otz__tee__api_8h.html#a586a43c1886aa09dc9541fb66e6d8d7fa4b7583ef234ccb0ef6f7492ee6e8200d">TEEC_ERROR_BAD_PARAMETERS</a>;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">if</span>((sharedMem-&gt;<a class="code" href="structTEEC__SharedMemory.html#ade465778b424b13ee99e044c2a221af8">size</a> == 0) ||</div>
<div class="line">        ((sharedMem-&gt;<a class="code" href="structTEEC__SharedMemory.html#a952af666858535b863b162a8b9e53e0c">flags</a> != <a class="code" href="otz__tee__client__api_8h.html#ad2ca265b0a012cb196691e4037b558dca8407d60bc4211cd205bdf111c3ce512c">TEEC_MEM_INPUT</a>) &amp;&amp; </div>
<div class="line">         (sharedMem-&gt;<a class="code" href="structTEEC__SharedMemory.html#a952af666858535b863b162a8b9e53e0c">flags</a> != <a class="code" href="otz__tee__client__api_8h.html#ad2ca265b0a012cb196691e4037b558dca4d822f60ca1969d1513b14b2805b234e">TEEC_MEM_OUTPUT</a>) &amp;&amp; </div>
<div class="line">         (sharedMem-&gt;<a class="code" href="structTEEC__SharedMemory.html#a952af666858535b863b162a8b9e53e0c">flags</a> != (<a class="code" href="otz__tee__client__api_8h.html#ad2ca265b0a012cb196691e4037b558dca8407d60bc4211cd205bdf111c3ce512c">TEEC_MEM_INPUT</a> | <a class="code" href="otz__tee__client__api_8h.html#ad2ca265b0a012cb196691e4037b558dca4d822f60ca1969d1513b14b2805b234e">TEEC_MEM_OUTPUT</a>)))) {</div>
<div class="line">        printf(<span class="stringliteral">&quot;TEEC_AllocateSharedMemory : Error Illegal argument\n&quot;</span>);</div>
<div class="line">        <span class="keywordflow">return</span> <a class="code" href="otz__tee__api_8h.html#a586a43c1886aa09dc9541fb66e6d8d7fa4b7583ef234ccb0ef6f7492ee6e8200d">TEEC_ERROR_BAD_PARAMETERS</a>;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">if</span>(sharedMem-&gt;<a class="code" href="structTEEC__SharedMemory.html#a7ced755c88a53bfadc0354fe1e33e0f9">buffer</a> == <a class="code" href="sw__types_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) {</div>
<div class="line">        printf(<span class="stringliteral">&quot;TEEC_RegisterSharedMemory :shared memory buffer is NULL\n&quot;</span>);</div>
<div class="line">        <span class="keywordflow">return</span> <a class="code" href="otz__tee__api_8h.html#a586a43c1886aa09dc9541fb66e6d8d7fa4b7583ef234ccb0ef6f7492ee6e8200d">TEEC_ERROR_BAD_PARAMETERS</a>;</div>
<div class="line">    }</div>
<div class="line">    sharedMem-&gt;<a class="code" href="structTEEC__SharedMemory.html#af662eccaf65008ef806549dda52368f1">allocated</a> = 0;</div>
<div class="line">    sharedMem-&gt;<a class="code" href="structTEEC__SharedMemory.html#a7532915172f8700fd0687bd12df96980">context</a> = context;</div>
<div class="line">    sharedMem-&gt;<a class="code" href="structTEEC__SharedMemory.html#af5682d369305070e83514a18cc2a2260">operation_count</a> = 0;</div>
<div class="line"></div>
<div class="line">    <a class="code" href="sw__list_8h.html#a0ffe9d28c36d7b018a9cfae33bae45c0">INIT_LIST_HEAD</a>(&amp;sharedMem-&gt;<a class="code" href="structTEEC__SharedMemory.html#a04c50f42331105464d2eb3d66cc4e8eb">head_ref</a>);</div>
<div class="line">    list_add_tail(&amp;context-&gt;<a class="code" href="structTEEC__Context.html#aeb59522c8cdeefc9afcf4b458846a286">shared_mem_list</a>, &amp;sharedMem-&gt;<a class="code" href="structTEEC__SharedMemory.html#a04c50f42331105464d2eb3d66cc4e8eb">head_ref</a>);</div>
<div class="line">    context-&gt;<a class="code" href="structTEEC__Context.html#adceafa85960b8f7ee684a540e8aa932f">shared_mem_cnt</a>++;</div>
<div class="line">    <span class="keywordflow">return</span> <a class="code" href="otz__tee__api_8h.html#a586a43c1886aa09dc9541fb66e6d8d7fa4d19c2c024e37edc5f04892bb6739dbe">TEEC_SUCCESS</a>;</div>
<div class="line"></div>
<div class="line">}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a28ced54521d6576f50cbd8743dbfa1e9"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void TEEC_ReleaseSharedMemory </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structTEEC__SharedMemory.html">TEEC_SharedMemory</a> *&#160;</td>
          <td class="paramname"><em>sharedMem</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Release a shared memory block. </p>
<p>This function deregisters or deallocates a previously initialized block of Shared Memory. For a memory buffer allocated using <em>TEEC_AllocateSharedMemory</em> the Implementation MUST free the underlying memory and the Client Application MUST NOT access this region after this function has been called. In this case the Implementation MUST set the <em>buffer</em> and <em>size</em> fields of the <em>sharedMem</em> structure to NULL and 0 respectively before returning.</p>
<p>For memory registered using <em>TEEC_RegisterSharedMemory</em> the Implementation MUST deregister the underlying memory from the TEE, but the memory region will stay available to the Client Application for other purposes as the memory is owned by it.</p>
<p>The Implementation MUST do nothing if the <em>sharedMem</em> parameter is <em>NULL</em>.</p>
<p><b>Programmer</b> <b>Error</b> <br/>
 The following usage of the API is a programmer error:<br/>
 Attempting to release Shared Memory which is used by a pending operation. <br/>
 Attempting to release the same Shared Memory structure concurrently from multiple threads. Multi-threaded Client Applications must use platform-provided locking mechanisms to ensure that this case does not occur.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">sharedMem,:</td><td>A pointer to a valid Shared Memory structure <br/>
</td></tr>
    <tr><td class="paramname">sharedMem,:</td><td>Pointer to the shared memory </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="otz__tee__api_8c_source.html#l00295">295</a> of file <a class="el" href="otz__tee__api_8c_source.html">otz_tee_api.c</a>.</p>
<div class="fragment"><div class="line">{</div>
<div class="line">    <span class="keyword">struct </span><a class="code" href="structlist.html">list</a> *l;</div>
<div class="line">    <a class="code" href="structTEEC__SharedMemory.html" title="The TEEC_SharedMemory structure is used to contain control information related to a block of shared m...">TEEC_SharedMemory</a>* tempSharedMem;</div>
<div class="line">    <span class="keywordtype">int</span> found = 0;</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">if</span>(sharedMem == <a class="code" href="sw__types_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>){</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">if</span>(sharedMem-&gt;<a class="code" href="structTEEC__SharedMemory.html#af5682d369305070e83514a18cc2a2260">operation_count</a> != 0) {</div>
<div class="line">        printf(<span class="stringliteral">&quot;TEEC_ReleaseSharedMemory - pending operations count %d\n&quot;</span>, </div>
<div class="line">                sharedMem-&gt;<a class="code" href="structTEEC__SharedMemory.html#af5682d369305070e83514a18cc2a2260">operation_count</a>);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">if</span>(sharedMem-&gt;<a class="code" href="structTEEC__SharedMemory.html#af662eccaf65008ef806549dda52368f1">allocated</a>) {</div>
<div class="line">        munmap(sharedMem-&gt;<a class="code" href="structTEEC__SharedMemory.html#a7ced755c88a53bfadc0354fe1e33e0f9">buffer</a>, sharedMem-&gt;<a class="code" href="structTEEC__SharedMemory.html#ade465778b424b13ee99e044c2a221af8">size</a>);</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    sharedMem-&gt;<a class="code" href="structTEEC__SharedMemory.html#a7ced755c88a53bfadc0354fe1e33e0f9">buffer</a> = <a class="code" href="sw__types_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div>
<div class="line">    sharedMem-&gt;<a class="code" href="structTEEC__SharedMemory.html#ade465778b424b13ee99e044c2a221af8">size</a> = 0;</div>
<div class="line"></div>
<div class="line">    <a class="code" href="sw__list_8h.html#abeae4779f478cbb5e1d437e6853c77c5">list_for_each</a>(l, &amp;sharedMem-&gt;<a class="code" href="structTEEC__SharedMemory.html#a7532915172f8700fd0687bd12df96980">context</a>-&gt;<a class="code" href="structTEEC__Context.html#aeb59522c8cdeefc9afcf4b458846a286">shared_mem_list</a>) {</div>
<div class="line">        tempSharedMem = <a class="code" href="sw__list_8h.html#a26c976b7f654e70df318c1843e5094de">list_entry</a>(l, <a class="code" href="structTEEC__SharedMemory.html" title="The TEEC_SharedMemory structure is used to contain control information related to a block of shared m...">TEEC_SharedMemory</a>, head_ref);</div>
<div class="line">        <span class="keywordflow">if</span> (tempSharedMem == sharedMem) {</div>
<div class="line">            found = 1;</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">if</span>(found) {</div>
<div class="line">        list_del(&amp;sharedMem-&gt;<a class="code" href="structTEEC__SharedMemory.html#a04c50f42331105464d2eb3d66cc4e8eb">head_ref</a>);</div>
<div class="line">        sharedMem-&gt;<a class="code" href="structTEEC__SharedMemory.html#a7532915172f8700fd0687bd12df96980">context</a>-&gt;<a class="code" href="structTEEC__Context.html#adceafa85960b8f7ee684a540e8aa932f">shared_mem_cnt</a>--;</div>
<div class="line">    }</div>
<div class="line">    sharedMem-&gt;<a class="code" href="structTEEC__SharedMemory.html#a7532915172f8700fd0687bd12df96980">context</a> = <a class="code" href="sw__types_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div>
<div class="line">}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ab0f689a7da4d607e46fe9f8d7dba277c"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void TEEC_RequestCancellation </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structTEEC__Operation.html">TEEC_Operation</a> *&#160;</td>
          <td class="paramname"><em>operation</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Request cancellation of pending open session or command invocation. </p>
<p>This function requests the cancellation of a pending open Session operation or a Command invocation operation. As this is a synchronous API, this function must be called from a thread other than the one executing the <em>TEEC_OpenSession</em> or <em>TEEC_InvokeCommand</em> function.</p>
<p>This function just sends a cancellation signal to the TEE and returns immediately; the operation is not guaranteed to have been cancelled when this function returns. In addition, the cancellation request is just a hint; the TEE or the Trusted Application MAY ignore the cancellation request.</p>
<p>It is valid to call this function using a <em><a class="el" href="structTEEC__Operation.html" title="The TEEC_Operation structure is used to contain control information related to an operation that is t...">TEEC_Operation</a></em> structure any time after the Client Application has set the <em>started</em> field of an Operation structure to zero. In particular, an operation can be cancelled before it is actually invoked, during invocation, and after invocation. Note that the Client Application MUST reset the started field to zero each time an Operation structure is used or re-used to open a Session or invoke a Command if the new operation is to be cancellable.</p>
<p>Client Applications MUST NOT reuse the Operation structure for another Operation until the cancelled command has actually returned in the thread executing the <em>TEEC_OpenSession</em> or <em>TEEC_InvokeCommand</em> function.</p>
<p><b>Detecting</b> <b>cancellation</b> <br/>
 In many use cases it will be necessary for the Client Application to detect whether the operation was actually cancelled, or whether it completed normally. <br/>
 In some implementations it MAY be possible for part of the infrastructure to cancel the operation before it reaches the Trusted Application. In these cases the return origin returned by <em>TEEC_OpenSession</em> or <em>TEEC_InvokeCommand</em> MUST be either or <em>TEEC_ORIGIN_API</em>, <em>TEEC_ORIGIN_COMMS</em>, <em>TEEC_ORIGIN_TEE</em>, and the return code MUST be <em>TEEC_ERROR_CANCEL</em>. <br/>
 If the cancellation request is handled by the Trusted Application itself then the return origin returned by <em>TEEC_OpenSession</em> or <em>TEEC_InvokeCommand</em> MUST be <em>TEE_ORIGIN_TRUSTED_APP</em>, and the return code is defined by the Trusted Application‟s protocol. If possible, Trusted Applications SHOULD use <em>TEEC_ERROR_CANCEL</em> for their return code, but it is accepted that this is not always possible due to conflicts with existing return code definitions in other standards.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">operation,:</td><td>A pointer to a Client Application instantiated Operation structure.</td></tr>
  </table>
  </dd>
</dl>
<p>Request cancellation of pending open session or command invocation.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">operation,:</td><td>Pointer to TEEC operation structure </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="otz__tee__api_8c_source.html#l01018">1018</a> of file <a class="el" href="otz__tee__api_8c_source.html">otz_tee_api.c</a>.</p>
<div class="fragment"><div class="line">{</div>
<div class="line">    <span class="keywordflow">return</span>;</div>
<div class="line">}</div>
</div><!-- fragment -->
</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Thu Jan 3 2013 00:33:52 by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.2
</small></address>
</body>
</html>
